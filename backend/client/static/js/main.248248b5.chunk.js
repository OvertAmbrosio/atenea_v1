(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{219:function(e,t){},273:function(e,t,n){},465:function(e,t){},466:function(e,t){},479:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),c=n(39),o=n.n(c),i=n(34),s=n(77),u=n(51),l=n(15),d=(n(272),n(256)),j=(n(273),{TODO:[1,2,3,4,5,6,7,8],ADMINISTRADOR:1,JEFE_OPERACIONES:2,JEFE_LOGISTICA:3,LIDER_GESTION:4,ASISTENTE_LOGISTICA:5,JEFE_CONTRATA:6,GESTOR:7,ALMACENERO:8,AUDITOR:9,TECNICO:10}),b="/login",O="/dashboard/indicadores-gpon",f="/dashboard/indicadores-hfc",p="/lista-personal",h="/lista-contratas",m="/lista-rutas",x="/administrar-ordenes/averias-hfc",g="/administrar-ordenes/altas-hfc",v="/administrar-ordenes/basicas",w="/administrar-ordenes/speedy",E="/gestionar-ordenes/averias-hfc",I="/gestionar-ordenes/altas-hfc",y="/gestionar-ordenes/basicas",C="/gestionar-ordenes/speedy",S={todos:j.TODO,listaContratas:[j.ADMINISTRADOR,j.JEFE_OPERACIONES,j.JEFE_LOGISTICA,j.LIDER_GESTION],grupoOperativa:[j.ADMINISTRADOR,j.JEFE_OPERACIONES,j.JEFE_LOGISTICA,j.LIDER_GESTION,j.JEFE_CONTRATA,j.GESTOR],administrarOrdenes:[j.ADMINISTRADOR,j.JEFE_OPERACIONES,j.LIDER_GESTION],gestionarOrdenes:[j.ADMINISTRADOR,j.JEFE_OPERACIONES,j.LIDER_GESTION,j.GESTOR]};function T(){return Object(r.jsx)("div",{children:Object(r.jsx)("a",{href:b,children:"login"})})}var _=n(8),A=n.n(_),k=n(11),N=n(62),R=n.n(N),D=n(481),G=n(482),M=n(488),L=n(493),F=n(52),P=n(499),z=n(500),B=n(179),Y=n.n(B),V=n(53),H={urlApi:"http://192.168.100.90:5000/api",public:"http://192.168.100.90:5000/",TOKEN_STORAGE_KEY:"atenea.authToken",logoPath:"/icon.png",logoFull:"/iconL.png",version:"0.0.2",formatosAdmitidos:["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]},U=function(){var e=Object(k.a)(A.a.mark((function e(t){var n,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=V.a.loading("Iniciando sesi\xf3n...",{hideAfter:0,position:"top-right",role:"success"}),r=Y.a.create({baseURL:H.urlApi}),e.next=4,r(Object(i.a)({},t)).then((function(e){var t=e.data;if(n.hide(),t&&t.data)return V.a.success(t.message,{position:"top-right"}),{data:t.data,errors:!1};throw V.a.error("No se puede obtener la data",{position:"top-right"}),Error("No se puede obtener la data")})).catch((function(e){if(n.hide(),e.response){console.log(e.response);var t=e.response.data,r=void 0!==t[Object.keys(t)[0]]?t[Object.keys(t)[0]]:"Error en la solicitud.";return V.a.warn(r,{position:"top-right"}),{data:!1,errors:t}}throw e.request?(console.log(e.request),V.a.warn("Se realiz\xf3 la solicitud, pero no se recibi\xf3 respuesta.",{position:"top-right"}),e):(V.a.error("Algo sucedi\xf3 al configurar la solicitud que provoc\xf3 un error.",{position:"top-right"}),e)}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(k.a)(A.a.mark((function e(t,n){var r,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n&&(r=V.a.loading("Cargando...",{hideAfter:0,position:"top-right",role:"success"})),a=Y.a.create({baseURL:H.urlApi,headers:{Authorization:"Bearer "+R.a.get(H.TOKEN_STORAGE_KEY)}}),e.next=4,a(Object(i.a)({},t)).then((function(e){var t=e.data;return n&&(r.hide(),V.a[t.status?t.status:"error"](t.message,{position:"top-right"})),t})).catch((function(e){if(n&&r.hide(),e.response){var t=e.response.data;return"401"===String(e.response.status)?(V.a.error("Token Invalido, cerrando sesi\xf3n.",{position:"top-right"}),R.a.remove(H.TOKEN_STORAGE_KEY),document.location.href="/login"):V.a.warn(void 0!==t.message?t.message:"Error en la solicitud.",{position:"top-right"}),{data:null,errors:t}}throw e.request?(console.log(e.request),V.a.warn("Se realiz\xf3 la solicitud, pero no se recibi\xf3 respuesta.",{position:"top-right"}),e):(V.a.error("Algo sucedi\xf3 al configurar la solicitud que provoc\xf3 un error.",{position:"top-right"}),e)}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),q=function(){var e=Object(k.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U({url:"private/auth/login",method:"POST",data:t}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(k.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",K({url:"private/auth/session",method:"GET"},t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(k.a)(A.a.mark((function e(){var t,n=arguments;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(n.length>0&&void 0!==n[0])||n[0],e.abrupt("return",K({url:"private/auth/logout",method:"GET"},t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=n(136),Z=n(137),X=n(220),$=function(){function e(t){Object(Q.a)(this,e),this.decodedToken={nombre:null,id:null,cargo:null,imagen:null,gestor:null,exp:0};try{t&&(this.decodedToken=Object(X.a)(t))}catch(n){console.log("Error"),console.log(n)}}return Object(Z.a)(e,[{key:"isValid",get:function(){return!this.isExpired}},{key:"expiresAt",get:function(){return new Date(1e3*this.decodedToken.exp)}},{key:"isExpired",get:function(){return new Date>this.expiresAt}},{key:"authorizationString",get:function(){return"Bearer ".concat(this.token)}}]),e}();function ee(){var e=Object(u.f)();function t(){return(t=Object(k.a)(A.a.mark((function t(n){return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,q(n).then((function(t){t.data&&!t.errors&&(R.a.set(H.TOKEN_STORAGE_KEY,t.data),e.push(O))})).catch((function(e){console.log("error"),console.log(e)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(a.useEffect)((function(){new $(R.a.get(H.TOKEN_STORAGE_KEY)).isValid&&e.push(O)}),[e]),Object(r.jsx)("div",{children:Object(r.jsx)(D.a,{type:"flex",justify:"space-around",align:"middle",style:{backgroundColor:"rgb(242, 242, 247)",height:"100vh"},children:Object(r.jsx)(G.a,{xs:20,sm:12,md:8,lg:6,xl:5,children:Object(r.jsx)("div",{className:"contenedor-padre",children:Object(r.jsxs)(M.a,{name:"normal_login",className:"login-form",initialValues:{remember:!0},onFinish:function(e){return t.apply(this,arguments)},children:[Object(r.jsx)("div",{className:"logoForm"}),Object(r.jsx)(M.a.Item,{name:"username",hasFeedback:!0,rules:[{required:!0,message:"\xa1Se necesita una correo!"},{type:"email",message:"\xa1Ingresa un email v\xe1lido!"}],children:Object(r.jsx)(L.a,{autoComplete:"current-email",type:"email",prefix:Object(r.jsx)(P.a,{className:"site-form-item-icon"}),placeholder:"Correo"})}),Object(r.jsx)(M.a.Item,{name:"password",hasFeedback:!0,rules:[{required:!0,message:"\xa1Se necesita una contrase\xf1a v\xe1lida!"},{min:6,message:"\xa1La contrase\xf1a debe tener mas de 6 car\xe1cteres!"}],children:Object(r.jsx)(L.a.Password,{autoComplete:"current-password",prefix:Object(r.jsx)(z.a,{className:"site-form-item-icon"}),type:"password",placeholder:"Contrase\xf1a"})}),Object(r.jsx)(M.a.Item,{children:Object(r.jsx)(F.a,{type:"primary",htmlType:"submit",className:"login-form-button",children:"Acceder"})})]})})})})})}var te=n(9),ne=n(3),re=n.n(ne),ae=n(154),ce=n(483),oe=n(67),ie=n(501),se=n(502),ue=n(503),le=n(504),de=n(505),je=n(506),be=n(82),Oe=be.a.SubMenu,fe=be.a.Item,pe=be.a.Divider,he=be.a.ItemGroup,me=function(){return String(window.location.pathname).substring(1)},xe=[{permisos:[].concat(Object(oe.a)(S.todos),[9]),titulo:"Panel de Control",children:[{grupo:!0,key:"sub100",icon:ie.a,titulo:"Dashboard",permisos:S.todos,children:[{ruta:O,icon:ie.a,titulo:"Indicadores GPON"},{ruta:f,icon:ie.a,titulo:"Indicadores HFC"}]}]},{permisos:S.todos,titulo:"Usuarios y Contratas",children:[{grupo:!1,ruta:p,icon:se.a,permisos:S.todos,titulo:"Lista de Personal"},{grupo:!1,ruta:h,icon:ue.a,permisos:S.listaContratas,titulo:"Lista de Contratas"}]},{permisos:S.grupoOperativa,titulo:"Operativa",children:[{grupo:!1,ruta:m,icon:le.a,permisos:S.administrarOrdenes,titulo:"Lista Rutas"},{grupo:!0,key:"sub98",icon:de.a,titulo:"Administrar ordenes",permisos:S.administrarOrdenes,children:[{ruta:x,icon:de.a,titulo:"Averias Hfc"},{ruta:g,icon:de.a,titulo:"Altas Hfc"},{ruta:v,icon:de.a,titulo:"Basicas"},{ruta:w,icon:de.a,titulo:"Speedy"}]},{grupo:!0,key:"sub97",icon:je.a,titulo:"Gestionar ordenes",permisos:S.gestionarOrdenes,children:[{ruta:E,icon:je.a,titulo:"Averias Hfc"},{ruta:I,icon:je.a,titulo:"Altas Hfc"},{ruta:y,icon:je.a,titulo:"Basicas"},{ruta:C,icon:je.a,titulo:"Speedy"}]}]}];var ge=function(e){var t=e.cargo;return t?Object(r.jsx)(be.a,{theme:"light",mode:"inline",defaultSelectedKeys:me(),children:xe.map((function(e,n){return e.permisos.includes(t)?Object(r.jsxs)(he,{title:e.titulo,children:[Object(r.jsx)(pe,{}),e.children.map((function(e){return!e.grupo&&e.permisos.includes(t)?Object(r.jsx)(fe,{children:Object(r.jsxs)(s.b,{to:e.ruta,children:[Object(r.jsx)(e.icon,{}),Object(r.jsx)("span",{children:e.titulo})]})},String(e.ruta).substring(1)):e.grupo&&e.permisos.includes(t)?Object(r.jsx)(Oe,{title:Object(r.jsxs)("span",{children:[Object(r.jsx)(e.icon,{}),Object(r.jsx)("span",{children:e.titulo})]}),children:e.children.map((function(e){return Object(r.jsx)(fe,{children:Object(r.jsxs)(s.b,{to:e.ruta,children:[Object(r.jsx)(e.icon,{}),Object(r.jsx)("span",{children:e.titulo})]})},String(e.ruta).substring(1))}))},e.key):null}))]},n):null}))}):Object(r.jsx)(be.a,{theme:"light",mode:"inline",defaultSelectedKeys:me(),children:Object(r.jsxs)(he,{title:"Panel de Control",children:[Object(r.jsx)(pe,{}),Object(r.jsx)(fe,{children:Object(r.jsxs)(s.b,{to:O,children:[Object(r.jsx)(ie.a,{}),Object(r.jsx)("span",{children:"Dashboard"})]})},"dashboard")]})})},ve=ce.a.Sider,we=function(e){var t=e.collapsed,n=e.cargo;return Object(r.jsxs)(ve,{width:256,theme:"light",breakpoint:"lg",trigger:null,collapsible:!0,collapsed:t,className:"sider",children:[Object(r.jsx)("div",{className:"brand",children:t?Object(r.jsx)("div",{className:"logo",children:Object(r.jsx)("img",{alt:"logo",src:H.logoPath})}):Object(r.jsx)("div",{className:"full-logo",children:Object(r.jsx)("img",{alt:"full-logo",src:H.logoFull})})}),Object(r.jsx)("div",{className:"menu-container",children:Object(r.jsx)(ge,{cargo:n})})]})},Ee=n(511),Ie=n(512),ye=n(262),Ce=n(497),Se=n(494),Te=n(507),_e=n(508),Ae=[{title:"Hola",icon:"success"},{title:"Hola",icon:"error"},{title:"Hola",icon:"warning"}],ke=function(){var e=Object(a.useState)(!1),t=Object(te.a)(e,2),n=t[0],c=t[1];return Object(r.jsx)(ye.a,{trigger:"click",placement:"bottomRight",overlayClassName:"notification-popover",visible:n,onVisibleChange:function(e){return c(e)},content:Object(r.jsxs)("div",{className:"caja-notificaciones",style:{minWidth:"20rem"},children:[Object(r.jsx)(Ce.b,{itemLayout:"horizontal",dataSource:Ae,locale:{emptyText:Object(r.jsx)("span",{children:"You have viewed all notifications."})},renderItem:function(e){return Object(r.jsxs)(Ce.b.Item,{className:"item-notificaciones",children:[Object(r.jsx)(Ce.b.Item.Meta,{className:"datos-notificaciones",title:Object(r.jsx)("span",{lines:1,children:"Orden Actualizada"}),description:"hola k tal como te va"}),Object(r.jsx)(Te.a,{className:"flecha-notificaciones"})]})}}),Ae.length?Object(r.jsx)("div",{className:"clear-button",children:Object(r.jsx)("span",{children:"Limpiar Notificaciones"})}):null]}),children:Object(r.jsx)(Se.a,{count:0,dot:!0,offset:[-10,10],className:"icon-button",children:Object(r.jsx)(_e.a,{className:"icon-font"})})})},Ne=n(258),Re=n(490),De=n(509),Ge=n(510);function Me(){var e=Object(a.useState)(null),t=Object(te.a)(e,2),n=t[0],c=t[1],o=Object(u.f)();Object(a.useEffect)((function(){var e=new $(R.a.get(H.TOKEN_STORAGE_KEY));e&&c(e.decodedToken)}),[]);var i=function(){var e=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W().then(function(){var e=Object(k.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"error"!==t.status&&(R.a.remove(H.TOKEN_STORAGE_KEY),o.push("/login"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e),console.log("Error cerrando sesi\xf3n.")}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsx)(be.a,{mode:"horizontal",children:Object(r.jsxs)(be.a.SubMenu,{title:Object(r.jsxs)(a.Fragment,{children:[Object(r.jsx)("span",{style:{color:"#999",marginRight:4},children:Object(r.jsx)("span",{children:"Hola,"})}),Object(r.jsx)("span",{children:n&&n.nombre}),Object(r.jsx)(Ne.a,{style:{marginLeft:8},src:n&&n.imagen})]}),children:[Object(r.jsx)(be.a.Item,{children:Object(r.jsx)(Re.a.Text,{type:"sucess",children:Object(r.jsxs)(s.b,{to:"/atenea-system/perfil-usuario",children:[Object(r.jsx)(De.a,{}),"Configuraciones"]})})},"Configuraciones"),Object(r.jsx)(be.a.Item,{onClick:i,children:Object(r.jsxs)(Re.a.Text,{type:"danger",children:[Object(r.jsx)(Ge.a,{}),"Desconectar"]})},"SignOut")]})},"user")}var Le=n(265),Fe=n(257);var Pe,ze=(Pe=function(e){var t=e.children,n=e.spinLoading,c=e.cargo,o=Object(a.useState)(!1),i=Object(te.a)(o,2),s=i[0],u=i[1],l={backgroundColor:"white",width:"100%",margin:"0px",padding:"16px 16px 24px 10px",transition:"margin .2s",clear:"both",left:s?"80px":"256px",bottom:0,right:0};return Object(r.jsx)(ae.a,{spinning:n,tip:"Cargando Interfaz...",size:"large",className:"spin-container",children:Object(r.jsxs)(ce.a,{children:[Object(r.jsx)(we,{collapsed:s,cargo:c}),Object(r.jsxs)(ce.a,{className:"site-layout",children:[Object(r.jsxs)(ce.a.Header,{style:{minWidth:s&&"calc(100vw - 95px)"},className:re()("header",{collapsed:s}),id:"layoutHeader",children:[Object(r.jsx)("div",{className:"button",onClick:function(){return u(!s)},children:s?Object(r.jsx)(Ee.a,{className:"text-primary"}):Object(r.jsx)(Ie.a,{})}),Object(r.jsxs)("div",{className:"right-container",children:[Object(r.jsx)(ke,{}),Object(r.jsx)(Me,{})]})]}),Object(r.jsx)(ce.a.Content,{className:"site-layout-background",style:{minHeight:"calc(100vh - 94px - 3rem)",marginTop:".5rem",transition:"margin .2s"},children:t}),Object(r.jsxs)(ce.a.Footer,{style:l,children:["Atenea System v",H.version," - 2020\xa9"]})]})]})})},function(e){Object(Le.a)(n,e);var t=Object(Fe.a)(n);function n(e){var r;return Object(Q.a)(this,n),(r=t.call(this,e)).state={spin:!0,cargo:null},r}return Object(Z.a)(n,[{key:"componentDidMount",value:function(){var e=Object(k.a)(A.a.mark((function e(){var t,n,r=this;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=R.a.get(H.TOKEN_STORAGE_KEY)){e.next=5;break}document.location.href=b,e.next=8;break;case 5:return n=new $(t),e.next=8,J(!0).then((function(e){"error"===e.status?(R.a.remove(H.TOKEN_STORAGE_KEY),document.location.href=b):r.setState({spin:!1,cargo:n.decodedToken.cargo})})).catch((function(e){r.setState({spin:!1}),console.log(e),console.log("error de sesion en (PrivateRoutes)")}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(r.jsx)(Pe,Object(i.a)(Object(i.a)({},this.props),{},{spinLoading:this.state.spin,cargo:this.state.cargo}))}}]),n}(a.Component)),Be=n(492),Ye=function(e){var t=e.titulo,n=[{breadcrumbName:e.subtitulo}];return Object(r.jsx)(Be.a,{className:"site-page-header",title:t,breadcrumb:{routes:n}})};function Ve(e){var t=e.children;return Object(r.jsx)(D.a,{style:{margin:"0 24px 1rem",borderRadius:".3rem"},children:Object(r.jsx)(G.a,{span:24,style:{borderRadius:".3rem",padding:"0 1rem",backgroundColor:"#fff",WebkitBoxShadow:"0px 0px 10px 0px rgba(0,0,0,0.03)",MozBoxShadow:"0px 0px 10px 0px rgba(0,0,0,0.03)",boxShadow:"0px 0px 10px 0px rgba(0,0,0,0.03)"},children:t})})}var He=n(489),Ue=n(32),Ke=n.n(Ue),qe=n(237),Je=n(61),We={success:"#52c41a",error:"#EB2F2F",warning:"#F8C82E"};function Qe(e){var t=e.data;return e.loading?Object(r.jsx)("div",{style:{width:"100%",height:300,display:"flex",alignItems:"center",justifyContent:"center"},children:Object(r.jsx)(ae.a,{spinning:!0,tip:"Cargando...",size:"large"})}):Object(r.jsxs)(Je.Chart,{height:300,padding:[30,20,60,40],data:t,autoFit:!0,filter:[["ordenes",function(e){return null!=e}]],children:[Object(r.jsx)(Je.Interval,{adjust:[{type:"dodge",marginRatio:0}],color:{fields:["estado"],callback:function(e){return"Pendiente"===(t=e)?We.warning:"Completado"===t?We.success:"Iniciado"===t?"#1890ff":"Suspendido"===t?We.error:"Cancelado"===t?"#940000":"No Realizada"===t?"#A5A5A5":void 0;var t}},position:"bucket*ordenes",label:{fields:["ordenes","estado"],callback:function(e,t){return"Completado"===t&&e>0?{content:e,style:{fill:"red",fontSize:15,fontWeight:"bold"}}:{content:e}}}}),Object(r.jsx)(Je.Tooltip,{shared:!0}),Object(r.jsx)(Je.Interaction,{type:"active-region"})]})}var Ze=["Reparaci\xf3n GPON","Reparaci\xf3n Gpon Movistar Uno","Reparacion Movistar Total Gpon","Instalaci\xf3n Rutina VA Gpon","Rutina MT GPON MT","Rutina MT GPON MT","Rutina VA GPON MT","Traslado GPON","Instalaci\xf3n rutina MT Gpon","Instalaci\xf3n rutina Bucle Gpon","Traslado GPON Movistar Total","Instalaci\xf3n Movistar uno Gpon","Instalaci\xf3n Gpon Movistar Tot","Instalaci\xf3n Migraci\xf3n Gpon","Instalaci\xf3n Migraci\xf3n Gpon MT","Instalaci\xf3n Migraci\xf3n Gpon MT","Instalaci\xf3n Gpon New","Instalaci\xf3n Movistar uno Gpon","Instalaci\xf3n Gpon Movistar Tot","Instalaci\xf3n Migraci\xf3n HFC a Gpon","Instalaci\xf3n Migraci\xf3n HFC a Gpon CC","Instalaci\xf3n Migraci\xf3n HFC a Gpon CC","Instalaci\xf3n Migraci\xf3n HFC a Gpon"],Xe={bucket:"Bucket",requerimiento:"Requerimiento",estado:"Estado",fecha_cita:"Fecha Cita",motivo_no_realizado:"Motivo No Realizado",subtipo_actividad:"Subtipo Actividad",carnet:"Carnet",tecnico:"Tecnico",gestor:"Gestor",auditor:"auditor",contrata:"Contrata",tipo_agenda:"Time Slot",sla_inicio:"SLA_INICIO",sla_fin:"SLA_FIN"};function $e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];if(e&&0!==e.length){var n=[],r=[];return e.forEach((function(e){return t.includes(e.bucket)?null:t.push(e.bucket)})),e.forEach((function(e){return n.includes(e.estado)?null:n.push(e.estado)})),t.forEach((function(t){n.forEach((function(n){var a=e.filter((function(e){return e.bucket===t&&e.estado===n})).length;r.push({bucket:String(t).substring(6),estado:n,ordenes:a})}))})),{ordenes:r,buckets:t}}return{ordenes:[],buckets:t}}function et(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];if(e&&0!==e.length){var n=[],r=[];return e.forEach((function(e){e.tecnico&&"-"!==e.tecnico&&e.tecnico.gestor&&e.tecnico.gestor.nombre?t.includes(e.tecnico.gestor.nombre)||t.push(e.tecnico.gestor.nombre):t.includes("-")||t.push("-")})),e.forEach((function(e){return n.includes(e.estado)?null:n.push(e.estado)})),t.forEach((function(t){n.forEach((function(n){var a=e.filter((function(e){return"-"===e.tecnico?e.tecnico===t&&e.estado===n:!!(e.tecnico&&e.tecnico.gestor&&e.tecnico.gestor.nombre)&&(e.tecnico.gestor.nombre===t&&e.estado===n)})).length;r.push({gestor:t,estado:n,ordenes:a})}))})),{ordenes:r,gestores:t}}return{ordenes:[],gestores:t}}function tt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];if(e&&0!==e.length){var n=[],r=[];return e.forEach((function(e){e.tecnico&&"-"!==e.tecnico&&e.tecnico.gestor&&e.tecnico.gestor.nombre?t.includes(e.tecnico.gestor.nombre)||t.push(e.tecnico.gestor.nombre):t.includes("-")||t.push("-")})),e.forEach((function(e){return n.includes(e.motivo_no_realizado)?null:n.push(e.motivo_no_realizado)})),t.forEach((function(t){n.forEach((function(n){var a=e.filter((function(e){return"-"===e.tecnico?e.tecnico===t&&e.motivo_no_realizado===n:!!(e.tecnico&&e.tecnico.gestor&&e.tecnico.gestor.nombre)&&(e.tecnico.gestor.nombre===t&&e.motivo_no_realizado===n)})).length;r.push({gestor:t,motivo:n,ordenes:a})}))})),{ordenes:r,gestores:t}}return{ordenes:[],gestores:t}}var nt=Re.a.Title;var rt=function(e){var t=e.data,n=e.titulo,c=e.tipo,o=Object(a.useState)([]),s=Object(te.a)(o,2),u=s[0],l=s[1],d=Object(a.useState)([]),j=Object(te.a)(d,2),b=j[0],O=j[1],f=Object(a.useState)(!1),p=Object(te.a)(f,2),h=p[0],m=p[1],x=Object(a.useState)([]),g=Object(te.a)(x,2),v=g[0],w=g[1],E=Object(a.useState)(null),I=Object(te.a)(E,2),y=I[0],C=I[1],S=Object(qe.useJsonToCsv)().saveAsCsv;function T(){return(T=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.abrupt("return",new Promise((function(e,n){try{if(t.length>0){var r=t.filter((function(e){return Ze.includes(e.subtipo_actividad)}));return l(r),e(r)}return n([])}catch(a){return n(a)}})).then((function(e){return $e(e)})).then((function(e){var t=e.ordenes,n=e.buckets;w(n),O(t)})).catch((function(e){return console.log(e)})).finally((function(){C(Ke()(new Date).format("HH:mm:ss")),m(!1)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){t&&t.length>0&&function(){T.apply(this,arguments)}()}),[t]),Object(r.jsxs)("div",{children:[Object(r.jsxs)(nt,{level:2,style:{marginTop:"1rem"},children:[n," / Actualizado: ",y||"-"]}),Object(r.jsxs)(D.a,{style:{marginTop:"2rem",marginBottom:".5rem"},children:[Object(r.jsx)(G.a,{sm:16,children:Object(r.jsx)(Qe,{data:b,loading:h})}),Object(r.jsxs)(G.a,{sm:8,children:[Object(r.jsx)(D.a,{children:v&&v.length>0?v.map((function(e,t){return Object(r.jsx)(G.a,{style:{margin:"1rem"},children:Object(r.jsx)(He.a,{title:e,value:u.length>0?u.filter((function(t){return t.bucket===e})).length:0,suffix:"/ ".concat(u.length," total")})},t)})):null}),Object(r.jsx)(D.a,{children:Object(r.jsx)(F.a,{onClick:function(){return S({data:u.map((function(e){return Object(i.a)(Object(i.a)({},e),{},{tecnico:e.tecnico&&e.tecnico.nombre?e.tecnico.nombre+" "+e.tecnico.apellidos:"-",gestor:e.tecnico&&e.tecnico.gestor?e.tecnico.gestor.nombre+" "+e.tecnico.gestor.apellidos:"-",auditor:e.tecnico&&e.tecnico.auditor?e.tecnico.auditor.nombre+" "+e.tecnico.auditor.apellidos:"-",contrata:e.tecnico&&e.tecnico.contrata?e.tecnico.contrata.nombre:"-"})})),fields:Xe,filename:"data_".concat(c,"_gpon_").concat(Ke()().format("DD_MM_YY_HH_mm"))})},children:"Exportar"})})]})]})]})};function at(e){var t=e.data;return e.loading?Object(r.jsx)("div",{style:{width:"100%",height:400,display:"flex",alignItems:"center",justifyContent:"center"},children:Object(r.jsx)(ae.a,{spinning:!0,tip:"Cargando...",size:"large"})}):Object(r.jsxs)(Je.Chart,{height:400,padding:[30,20,140,40],data:t.filter((function(e){return"-"!==e.gestor})),autoFit:!0,filter:[["ordenes",function(e){return null!=e}]],children:[Object(r.jsx)(Je.Interval,{adjust:[{type:"dodge",marginRatio:0}],color:{fields:["estado"],callback:function(e){return"Pendiente"===(t=e)?We.warning:"Completado"===t?We.success:"Iniciado"===t?"#1890ff":"Suspendido"===t?We.error:"Cancelado"===t?"#940000":"No Realizada"===t?"#A5A5A5":void 0;var t}},position:"gestor*ordenes",label:{fields:["ordenes","estado"],callback:function(e,t){return"Completado"===t&&e>0?{content:e,style:{fill:"red",fontSize:15,fontWeight:"bold"}}:{content:e}}}}),Object(r.jsx)(Je.Tooltip,{shared:!0}),Object(r.jsx)(Je.Interaction,{type:"active-region"})]})}var ct=Re.a.Title;var ot=function(e){var t=e.data,n=e.titulo,c=Object(a.useState)([]),o=Object(te.a)(c,2),i=o[0],s=o[1],u=Object(a.useState)([]),l=Object(te.a)(u,2),d=l[0],j=l[1],b=Object(a.useState)(!1),O=Object(te.a)(b,2),f=O[0],p=O[1],h=Object(a.useState)([]),m=Object(te.a)(h,2),x=m[0],g=m[1],v=Object(a.useState)(null),w=Object(te.a)(v,2),E=w[0],I=w[1];function y(){return(y=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.abrupt("return",new Promise((function(e,n){try{if(t.length>0){var r=t.filter((function(e){return Ze.includes(e.subtipo_actividad)}));return s(r.filter((function(e){return e.tecnico&&e.tecnico.gestor}))),e(r)}return n([])}catch(a){return n(a)}})).then((function(e){return et(e)})).then((function(e){var t=e.ordenes,n=e.gestores;g(n),j(t)})).catch((function(e){return console.log(e)})).finally((function(){I(Ke()(new Date).format("HH:mm:ss")),p(!1)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){t&&t.length>0&&function(){y.apply(this,arguments)}()}),[t]),Object(r.jsxs)("div",{children:[Object(r.jsxs)(ct,{level:2,style:{marginTop:"1rem"},children:[n," / Actualizado: ",E||"-"]}),Object(r.jsx)(D.a,{style:{marginTop:"2rem",marginBottom:"1rem"},children:Object(r.jsx)(G.a,{sm:24,children:Object(r.jsx)(at,{data:d,loading:f})})}),Object(r.jsx)(D.a,{children:Object(r.jsx)(G.a,{sm:24,children:Object(r.jsx)(D.a,{children:x&&x.length>0?x.filter((function(e){return"-"!==e})).map((function(e,t){return Object(r.jsx)(G.a,{style:{margin:"1rem"},children:Object(r.jsx)(He.a,{title:e,value:i.length>0?i.filter((function(t){return t.tecnico.gestor.nombre===e})).length:0,suffix:"/ ".concat(i.length," total")})},t)})):null})})})]})};function it(e){var t=e.data;return e.loading?Object(r.jsx)("div",{style:{width:"100%",height:400,display:"flex",alignItems:"center",justifyContent:"center"},children:Object(r.jsx)(ae.a,{spinning:!0,tip:"Cargando...",size:"large"})}):Object(r.jsxs)(Je.Chart,{height:400,padding:[30,20,140,40],data:t.filter((function(e){return"-"!==e.gestor})),autoFit:!0,filter:[["ordenes",function(e){return null!=e}]],children:[Object(r.jsx)(Je.Interval,{adjust:[{type:"dodge",marginRatio:0}],color:{fields:["motivo"]},position:"gestor*ordenes",label:{fields:["ordenes","motivo"]}}),Object(r.jsx)(Je.Tooltip,{shared:!0}),Object(r.jsx)(Je.Interaction,{type:"active-region"})]})}var st=Re.a.Title,ut=["Cancelado","No Realizada"];var lt=function(e){var t=e.data,n=Object(a.useState)([]),c=Object(te.a)(n,2),o=c[0],i=c[1],s=Object(a.useState)([]),u=Object(te.a)(s,2),l=u[0],d=u[1],j=Object(a.useState)(!1),b=Object(te.a)(j,2),O=b[0],f=b[1],p=Object(a.useState)([]),h=Object(te.a)(p,2),m=h[0],x=h[1],g=Object(a.useState)(null),v=Object(te.a)(g,2),w=v[0],E=v[1];function I(){return(I=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.abrupt("return",new Promise((function(e,n){try{if(t.length>0){var r=t.filter((function(e){return Ze.includes(e.subtipo_actividad)&&ut.includes(e.estado)}));return i(r.filter((function(e){return e.tecnico&&e.tecnico.gestor}))),e(r)}return n([])}catch(a){return n(a)}})).then((function(e){return tt(e)})).then((function(e){var t=e.ordenes,n=e.gestores;x(n),d(t)})).catch((function(e){return console.log(e)})).finally((function(){E(Ke()(new Date).format("HH:mm:ss")),f(!1)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){t&&t.length>0&&function(){I.apply(this,arguments)}()}),[t]),Object(r.jsxs)("div",{children:[Object(r.jsxs)(st,{level:2,style:{marginTop:"1rem"},children:["Indicador Devoluciones Gpon / Actualizado: ",w||"-"]}),Object(r.jsx)(D.a,{style:{marginTop:"2rem",marginBottom:"1rem"},children:Object(r.jsx)(G.a,{sm:24,children:Object(r.jsx)(it,{data:l,loading:O})})}),Object(r.jsx)(D.a,{children:Object(r.jsx)(G.a,{sm:24,children:Object(r.jsx)(D.a,{children:m&&m.length>0?m.filter((function(e){return"-"!==e})).map((function(e,t){return Object(r.jsx)(G.a,{style:{margin:"1rem"},children:Object(r.jsx)(He.a,{title:e,value:o.length>0?o.filter((function(t){return t.tecnico.gestor.nombre===e})).length:0,suffix:"/ ".concat(o.length," total")})},t)})):null})})})]})};var dt=n(263),jt=n(484),bt=n(513),Ot=n(514),ft=n(515),pt=function(){var e=Object(k.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",K({url:"contratas",method:"GET",params:{metodo:n}},t));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ht=function(){var e=Object(k.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",K({url:"contratas",method:"POST",data:t},!0));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),mt=function(){var e=Object(k.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",K({url:"contratas/"+t,method:"PUT",data:n},!0));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),xt=function(){var e=Object(k.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",K({url:"contratas/"+t,method:"PATCH",data:n},!0));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),gt="listaTodo",vt="listaTecnicosGlobal",wt="listaGestores",Et="listaAuditores",It="resetPassword",yt="cerrarSesion",Ct="actualizarPermisos",St="activarCuenta",Tt="editarEstadoEmpresa",_t="actualizarGestor",At="actualizarAuditor",kt="listaTodo",Nt="listaNombres",Rt="subirData",Dt="cruzarData",Gt="ordenesHoy",Mt="listarTodo",Lt=n(491),Ft=n(485);var Pt=function(e){var t=e.visible,n=e.setVisible,c=e.accion,o=e.guardar,i=e.contrata,s=void 0===i?{}:i,u=Object(a.useState)(null),l=Object(te.a)(u,2),d=l[0],j=l[1],b=Object(a.useState)(null),O=Object(te.a)(b,2),f=O[0],p=O[1],h=Object(a.useState)(null),m=Object(te.a)(h,2),x=m[0],g=m[1],v=Object(a.useState)(null),w=Object(te.a)(v,2),E=w[0],I=w[1];Object(a.useEffect)((function(){s.nombre&&(j(s.nombre),p(s.ruc),g(s.fecha_incorporacion),I(s.observacion))}),[s]);var y=function(){var e=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j(null),p(null),g(null),I(null),n(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o({nombre:d,ruc:f,fecha_incorporacion:x&&x,observacion:E&&E},s.id);case 2:y();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(Lt.a,{width:270,cancelText:"Cancelar",okText:"Guardar",title:"crear"===c?"Crear Contrata":"Editar Contrata",visible:t,onOk:C,onCancel:y,destroyOnClose:!0,centered:!0,children:[Object(r.jsx)("p",{children:"Nombre de Contrata:"}),Object(r.jsx)(L.a,{placeholder:"Nombre de Contrata",defaultValue:d,onChange:function(e){return j(e.target.value)}}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("p",{children:"RUC:"}),Object(r.jsx)(L.a,{placeholder:"RUC",defaultValue:f,onChange:function(e){return p(e.target.value)}}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("p",{children:"Fecha de Incorporaci\xf3n:"}),Object(r.jsx)(Ft.a,{defaultValue:x&&Ke.a.utc(x),onChange:function(e,t){return g(t)}}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("p",{children:"Observacion:"}),Object(r.jsx)(L.a,{placeholder:"Observacion",defaultValue:E,onChange:function(e){return I(e.target.value)}}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{})]})},zt=n(498),Bt=n(163);var Yt=function(e){var t=e.visible,n=e.setVisible,c=e.guardar,o=e.contrata,i=void 0===o?{}:o,s=Object(a.useState)(!0),u=Object(te.a)(s,2),l=u[0],d=u[1],j=Object(a.useState)(null),b=Object(te.a)(j,2),O=b[0],f=b[1];function p(){return(p=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i._id){e.next=6;break}return e.next=3,c(i._id,{activo:l,fecha_baja:O});case 3:h(),e.next=7;break;case 6:console.log("objeto contrata vacio.");case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var h=function(){d(!0),f(null),n(!1)};return Object(r.jsx)(Lt.a,{width:250,cancelText:"Cancelar",okText:"Guardar",title:"Desactivar Contrata",visible:t,onOk:function(){return p.apply(this,arguments)},onCancel:h,destroyOnClose:!0,centered:!0,children:Object(r.jsxs)(zt.b,{direction:"vertical",children:[Object(r.jsx)("p",{style:{fontSize:"13px",color:"rgba(0,0,0,.55)"},children:"*La contrata no se eliminar\xe1 de la base de datos, pero si dejar\xe1 de aparecer en las listas del sistema."}),"Seleccionar estado:",Object(r.jsxs)(Bt.a.Group,{onChange:function(e){return d(e.target.value)},value:l,children:[Object(r.jsx)(Bt.a,{value:!0,children:"Activo"}),Object(r.jsx)(Bt.a,{value:!1,children:"Inactivo"})]}),"Seleccionar fecha de baja:",Object(r.jsx)(Ft.a,{onChange:function(e,t){return f(t)}})]})})};function Vt(){var e=Object(a.useState)(!1),t=Object(te.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)([]),i=Object(te.a)(o,2),s=i[0],u=i[1],l=Object(a.useState)(!1),d=Object(te.a)(l,2),j=d[0],b=d[1],O=Object(a.useState)(!1),f=Object(te.a)(O,2),p=f[0],h=f[1],m=Object(a.useState)(!1),x=Object(te.a)(m,2),g=x[0],v=x[1],w=Object(a.useState)({}),E=Object(te.a)(w,2),I=E[0],y=E[1];function C(){return S.apply(this,arguments)}function S(){return(S=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.next=3,pt(!0,kt).then((function(e){var t=e.data;c(!1),u(t&&t)})).catch((function(e){c(!1),console.log(e)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){return(T=Object(k.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht(t).then(Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){console.log(e),R()}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){return(_=Object(k.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!I._id){e.next=3;break}return e.next=3,mt(I._id,t).then(Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){console.log(e),D()}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=Object(k.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xt(t,n).then(Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){console.log(e),G()}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){C()}),[]);var R=function(){return b(!j)},D=function(){return h(!p)},G=function(){return v(!g)},M=[{title:"#",width:50,render:function(e,t,n){return n+1}},{title:"Nombre",dataIndex:"nombre",width:250},{title:"Estado",dataIndex:"activo",width:150,render:function(e){return e?Object(r.jsx)(dt.a,{color:"success",children:"Activo"}):Object(r.jsx)(dt.a,{color:"error",children:"Inactivo"})}},{title:"Fecha Inicio",dataIndex:"fecha_incorporacion",width:150,render:function(e){return e?Ke()(e).format("DD-MM-YYYY"):"-"}},{title:"Fecha Baja",dataIndex:"fecha_baja",width:150,render:function(e){return e?Ke()(e).format("DD-MM-YYYY"):"-"}},{title:"Observaci\xf3n",dataIndex:"observacion"},{title:"Acciones",dataIndex:"_id",align:"center",width:100,render:function(e,t){return Object(r.jsxs)("span",{children:[Object(r.jsx)(bt.a,{title:"Editar",twoToneColor:We.warning,style:{paddingRight:"8px",fontSize:"1.5rem"},onClick:function(){D(),y(t)}}),Object(r.jsx)(Ot.a,{title:"Configuraciones",twoToneColor:We.error,style:{paddingRight:"8px",fontSize:"1.5rem"},onClick:function(){G(),y(t)}})]})}}];return Object(r.jsxs)(Ve,{children:[Object(r.jsx)(jt.a,{rowKey:"_id",style:{marginBottom:"1rem"},className:"tabla-personal",title:function(){return Object(r.jsx)(F.a,{icon:Object(r.jsx)(ft.a,{}),onClick:R,children:"Agregar"})},columns:M,dataSource:s,loading:n,size:"small",scroll:{y:"65vh"},pagination:!1}),Object(r.jsx)(Pt,{visible:j,setVisible:b,guardar:function(e){return T.apply(this,arguments)},accion:"crear"}),Object(r.jsx)(Pt,{visible:p,setVisible:h,guardar:function(e){return _.apply(this,arguments)},contrata:I,accion:"editar"}),Object(r.jsx)(Yt,{visible:g,setVisible:v,guardar:function(e,t){return N.apply(this,arguments)},contrata:I})]})}function Ht(){return Object(r.jsxs)("div",{children:[Object(r.jsx)(Ye,{titulo:"Lista de Contratas",subtitulo:"Usuarios y Personal"}),Object(r.jsx)(Vt,{})]})}var Ut=[{path:O,exact:!0,component:function(){var e=Object(a.useState)([]),t=Object(te.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)([]),i=Object(te.a)(o,2),s=i[0],u=i[1],l=window.io(H.public),d=Object(a.useRef)(null),j=Object(a.useRef)(null),b=Object(a.useRef)(null),O=Object(a.useRef)(null),f=Object(a.useRef)(null);Object(a.useEffect)((function(){return h(),l.on("connect",(function(e){l.on("ordenesGpon",(function(e){var t=e.averias,n=e.altas,r=new Array(JSON.parse(t)),a=new Array(JSON.parse(n));r&&r[0].length>0&&c(r[0]),a&&a[0].length>0&&u(a[0])})),l.emit("obtenerOrdenes")})),function(){return l.close()}}),[]);var p=function(e){var t=[d,j,b,O,f];t[e].current&&t[e].current.scrollIntoView({block:"center",behavior:"smooth"})},h=function(){var e=0;setInterval((function(){p(e),4===e?e=0:e+=1}),15e3)};return Object(r.jsxs)("div",{children:[Object(r.jsx)(Ye,{titulo:"Indicadores GPON",subtitulo:"Dashboard"}),Object(r.jsxs)(Ve,{children:[Object(r.jsx)("div",{ref:d,children:Object(r.jsx)(rt,{data:n,titulo:"Indicador Averias GPON",tipo:"averias"})}),Object(r.jsx)("div",{ref:j,children:Object(r.jsx)(rt,{data:s,titulo:"Indicador Altas GPON",tipo:"altas"})}),Object(r.jsx)("div",{ref:b,children:Object(r.jsx)(ot,{data:n,titulo:"Indicador Gestores Gpon (Averias)"})}),Object(r.jsx)("div",{ref:O,children:Object(r.jsx)(ot,{data:s,titulo:"Indicador Gestores Gpon (Altas)"})}),Object(r.jsx)("div",{ref:f,children:Object(r.jsx)(lt,{data:s})}),Object(r.jsx)("button",{onClick:p,children:"prueba"})]})]})},nivel:S.todos},{path:f,exact:!0,component:Ht,nivel:S.listaContratas}],Kt=n(65),qt=function(){var e=Object(k.a)(A.a.mark((function e(t,n){var r,a,c,o;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.metodo,a=n.page,c=n.limit,o=n.idFiltro,e.abrupt("return",K({url:"empleados",method:"GET",params:{metodo:r,page:a,limit:c,idFiltro:o}},t));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Jt=function(){var e=Object(k.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",K({url:"empleados/buscar",method:"GET",params:{value:t,field:n}},!0));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Wt=function(){var e=Object(k.a)(A.a.mark((function e(t,n){var r,a,c,o,i,s,u,l;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.id,a=n.metodo,c=n.cargo,o=n.fecha_baja,i=n.estado_empresa,s=n.gestor,u=n.auditor,l=n.tecnicos,e.abrupt("return",K({url:"empleados",method:"PATCH",data:{id:r,metodo:a,cargo:c,fecha_baja:o,estado_empresa:i,gestor:s,auditor:u,tecnicos:l}},t));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Qt=function(){var e=Object(k.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",K({url:"empleados",method:"POST",data:t},!0));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Zt=function(){var e=Object(k.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",K({url:"empleados/"+t,method:"PUT",data:n},!0));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Xt=L.a.Search;var $t=n(516),en=n(517),tn=n(518);function nn(e){switch(e.cargo){case j.ADMINISTRADOR:return Object(r.jsx)(dt.a,{color:"geekblue",children:"Administrador"});case j.JEFE_OPERACIONES:return Object(r.jsx)(dt.a,{color:"blue",children:"Jefe de Operaciones"});case j.JEFE_LOGISTICA:return Object(r.jsx)(dt.a,{color:"cyan",children:"Jefe de Logistica"});case j.LIDER_GESTION:return Object(r.jsx)(dt.a,{color:"purple",children:"Lider de Gestion"});case j.ASISTENTE_LOGISTICA:return Object(r.jsx)(dt.a,{color:"green",children:"Asistente de Logistica"});case j.JEFE_CONTRATA:return Object(r.jsx)(dt.a,{color:"orange",children:"Jefe de Contrata"});case j.GESTOR:return Object(r.jsx)(dt.a,{color:"magenta",children:"Gestor"});case j.ALMACENERO:return Object(r.jsx)(dt.a,{color:"red",children:"Almacenero"});case j.AUDITOR:return Object(r.jsx)(dt.a,{color:"gold",children:"Auditor"});case j.TECNICO:return Object(r.jsx)(dt.a,{color:"volcano",children:"Tecnico"});default:return Object(r.jsx)(dt.a,{children:"Sin cargo"})}}function rn(e){var t=e.estado;switch(t){case"Activo":return Object(r.jsx)(dt.a,{icon:Object(r.jsx)($t.a,{}),color:We.success,children:t});case"Suspendido":return Object(r.jsx)(dt.a,{icon:Object(r.jsx)(en.a,{}),color:We.warning,children:t});case"Inactivo":return Object(r.jsx)(dt.a,{icon:Object(r.jsx)(tn.a,{}),color:We.error,children:t});default:return Object(r.jsx)(dt.a,{children:"Desconocido"})}}var an=n(520),cn=n(128),on=cn.a.Option;var sn=function(e){var t=e.accion,n=e.visible,c=e.setVisible,o=e.empleado,s=void 0===o?{}:o,u=e.contratas,l=void 0===u?[]:u,d=e.guardar,b=Object(a.useState)({numero_documento:Number(Date.now())}),O=Object(te.a)(b,2),f=O[0],p=O[1],h=M.a.useForm(),m=Object(te.a)(h,1)[0];return Object(a.useEffect)((function(){s._id&&p(Object(i.a)(Object(i.a)({},s),{},{email:s.usuario.email,cargo:s.usuario.cargo,contrata:s.contrata&&s.contrata._id}))}),[s]),Object(r.jsx)(Lt.a,{width:300,cancelText:"Cancelar",okText:"Guardar",title:"crear"===t?"Crear Empleado":"Editar Empleado",visible:n,onOk:function(){m.validateFields().then(function(){var e=Object(k.a)(A.a.mark((function e(t){var n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p({numero_documento:Date.now()}),m.resetFields(),n=Object(i.a)(Object(i.a)({},t),{},{usuario:{email:t.email,cargo:t.cargo}}),e.next=5,d(n);case 5:c(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("Validate Failed:",e)}))},onCancel:function(){c(!1)},destroyOnClose:!0,centered:!0,children:Object(r.jsxs)(M.a,{name:"form_empleado",layout:"vertical",size:"small",form:m,initialValues:f,onValuesChange:function(e){return p(Object(i.a)(Object(i.a)({},f),e))},children:[Object(r.jsx)(M.a.Item,{name:"nombre",label:"Nombre",rules:[{required:!0}],children:Object(r.jsx)(L.a,{})}),Object(r.jsx)(M.a.Item,{name:"apellidos",label:"Apellidos",rules:[{required:!0}],children:Object(r.jsx)(L.a,{})}),Object(r.jsx)(M.a.Item,{name:"email",label:"Correo",rules:[{required:!0,type:"email"}],children:Object(r.jsx)(L.a,{})}),Object(r.jsx)(M.a.Item,{name:"cargo",label:"Cargo",rules:[{required:!0,type:"number"}],children:Object(r.jsxs)(cn.a,{placeholder:"Seleccionar cargo",onChange:function(e){return p(Object(i.a)(Object(i.a)({},f),{},{cargo:e}))},allowClear:!0,children:[Object(r.jsx)(on,{value:j.ASISTENTE_LOGISTICA,children:"Asistente de Logistica"}),Object(r.jsx)(on,{value:j.JEFE_CONTRATA,children:"Jefe de Contrata"}),Object(r.jsx)(on,{value:j.GESTOR,children:"Gestor"}),Object(r.jsx)(on,{value:j.ALMACENERO,children:"Almacenero"}),Object(r.jsx)(on,{value:j.AUDITOR,children:"Auditor"}),Object(r.jsx)(on,{value:j.TECNICO,children:"Tecnico"})]})}),f.cargo&&(f.cargo===j.TECNICO||f.cargo===j.AUDITOR)?Object(r.jsx)(M.a.Item,{name:"carnet",label:"Carnet",rules:[{required:!0}],children:Object(r.jsx)(L.a,{})}):null,l&&l.length>0?Object(r.jsx)(M.a.Item,{name:"contrata",label:"Contrata",rules:[{required:!0}],children:Object(r.jsx)(cn.a,{placeholder:"Seleccionar contrata",onChange:function(e){return p(Object(i.a)(Object(i.a)({},f),{},{contrata:e}))},allowClear:!0,children:l.map((function(e,t){return Object(r.jsx)(on,{value:e._id,children:e.nombre},t)}))})}):null,Object(r.jsx)(M.a.Item,{name:"tipo_documento",label:"Tipo de Documento",children:Object(r.jsxs)(cn.a,{placeholder:"Seleccionar tipo",onChange:function(e){return p(Object(i.a)(Object(i.a)({},f),{},{tipo_documento:e}))},allowClear:!0,children:[Object(r.jsx)(on,{value:"DNI",children:"DNI"}),Object(r.jsx)(on,{value:"Otro",children:"Otro"})]})}),Object(r.jsx)(M.a.Item,{name:"numero_documento",label:"Numero de Documento",rules:[{required:!1,type:"string"}],children:Object(r.jsx)(L.a,{})})]})})},un=n(519),ln=cn.a.Option;var dn=function(e){var t=e.visible,n=e.setVisible,c=(e.listarEmpleados,e.id),o=Object(a.useState)(4),i=Object(te.a)(o,2),s=i[0],u=i[1];function l(){return(l=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wt(!0,{id:c,metodo:Ct,cargo:s}).then((function(){return n(!t)})).catch((function(e){n(!1),console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.jsxs)(Lt.a,{title:"Actualizar Cargo",visible:t,width:300,onOk:function(){return l.apply(this,arguments)},onCancel:function(){return n(!1)},centered:!0,children:[Object(r.jsx)("p",{style:{fontSize:"13px",color:"rgba(0,0,0,.55)"},children:"*Recuerda que no es posible otorgar un cargo superior al tuyo y que todo cambio quedar\xe1 registrado en el sistema."}),Object(r.jsx)("p",{children:"Seleccionar Cargo:"}),Object(r.jsxs)(cn.a,{defaultValue:s,onChange:function(e){return u(e)},style:{width:180},children:[Object(r.jsx)(ln,{value:j.LIDER_GESTION,children:"Lider de Gestion"}),Object(r.jsx)(ln,{value:j.ASISTENTE_LOGISTICA,children:"Asistente de Logistica"}),Object(r.jsx)(ln,{value:j.JEFE_CONTRATA,children:"Jefe de contrata"}),Object(r.jsx)(ln,{value:j.GESTOR,children:"Gestor"}),Object(r.jsx)(ln,{value:j.ALMACENERO,children:"Almacenero"}),Object(r.jsx)(ln,{value:j.AUDITOR,children:"Auditor"}),Object(r.jsx)(ln,{value:j.TECNICO,children:"Tecnico"})]})]})},jn=cn.a.Option;var bn=function(e){var t=e.visible,n=e.setVisible,c=e.listarEmpleados,o=e.id,i=Object(a.useState)(1),s=Object(te.a)(i,2),u=s[0],l=s[1],d=Object(a.useState)(""),j=Object(te.a)(d,2),b=j[0],O=j[1];function f(){return(f=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wt(!0,{id:o,metodo:Tt,fecha_baja:b,estado_empresa:u}).then(Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(!1),e.next=3,c();case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.jsxs)(Lt.a,{title:"Estado Empresa",visible:t,width:300,onOk:function(){return f.apply(this,arguments)},onCancel:function(){return n(!1)},centered:!0,children:[Object(r.jsx)("p",{style:{fontSize:"13px",color:"rgba(0,0,0,.55)"},children:'*Un usuario "Activo" tiene la cuenta habilitada y aparece en las listas del personal (ordenes, inventario, etc.)'}),Object(r.jsx)("p",{style:{fontSize:"13px",color:"rgba(0,0,0,.55)"},children:'*Un usuario "Suspendido" no podr\xe1 iniciar sesi\xf3n en el sistema, pero seguir\xe1 apareciendo en las listas del personal (ordenes, inventario, etc.)'}),Object(r.jsx)("p",{style:{fontSize:"13px",color:"rgba(0,0,0,.55)"},children:'*Un usuario "Inactivo" no podr\xe1 iniciar sesi\xf3n en el sistema y desaparecer\xe1 por completo de las listas del sistema (usuario de baja)'}),Object(r.jsxs)(zt.b,{direction:"vertical",children:["Seleccionar:",Object(r.jsxs)(cn.a,{defaultValue:u,onChange:function(e){return l(e)},style:{width:150},children:[Object(r.jsx)(jn,{value:1,children:"Activo"}),Object(r.jsx)(jn,{value:2,children:"Suspendido"}),Object(r.jsx)(jn,{value:3,children:"Inactivo"})]}),"Fecha de suspensi\xf3n / baja:",Object(r.jsx)(Ft.a,{onChange:function(e,t){return O(t)}})]})]})};var On=function(e){var t=e.visible,n=e.setVisible,c=e.id,o=e.listarEmpleados,i=Object(a.useState)(!1),s=Object(te.a)(i,2),u=s[0],l=s[1],d=Object(a.useState)(!1),j=Object(te.a)(d,2),b=j[0],O=j[1];function f(e){return p.apply(this,arguments)}function p(){return(p=Object(k.a)(A.a.mark((function e(r){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wt(!0,{id:c,metodo:r}).then((function(){o(),n(!t)})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var h=function(){var e=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:n(!1);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(Lt.a,{title:"Configuraciones",visible:t,width:250,onOk:h,onCancel:function(){return n(!1)},centered:!0,children:[Object(r.jsx)(F.a,{block:!0,icon:Object(r.jsx)(z.a,{}),style:{marginBottom:".5rem"},onClick:function(){return f(It)},children:"Reiniciar Contrase\xf1a"}),Object(r.jsx)(F.a,{block:!0,icon:Object(r.jsx)(tn.a,{}),style:{marginBottom:".5rem"},onClick:function(){return f(yt)},children:"Cerrar Sessi\xf3n"}),Object(r.jsx)(F.a,{block:!0,icon:Object(r.jsx)(un.a,{}),style:{marginBottom:".5rem"},onClick:function(){return l(!u)},children:"Permisos"}),Object(r.jsx)(F.a,{block:!0,icon:Object(r.jsx)(P.a,{}),style:{marginBottom:".5rem"},onClick:function(){return f(St)},children:"Activar Cuenta"}),Object(r.jsx)(F.a,{block:!0,danger:!0,icon:Object(r.jsx)(en.a,{}),style:{marginBottom:".5rem"},onClick:function(){return O(!b)},children:"Cambiar Estado"}),Object(r.jsx)(dn,{visible:u,setVisible:l,listarEmpleados:o,id:c}),Object(r.jsx)(bn,{visible:b,setVisible:O,listarEmpleados:o,id:c})]})};function fn(e){var t=e.id,n=e.empleado,c=e.listarEmpleados,o=e.listaContratas,i=Object(a.useState)(!1),s=Object(te.a)(i,2),u=s[0],l=s[1],d=Object(a.useState)(!1),j=Object(te.a)(d,2),b=j[0],O=j[1];function f(){return(f=Object(k.a)(A.a.mark((function e(n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Zt(t,n).then(Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.jsxs)("span",{children:[Object(r.jsx)(bt.a,{title:"Editar",twoToneColor:We.warning,style:{paddingRight:"8px",fontSize:"1.5rem"},onClick:function(){return l(!0)}}),Object(r.jsx)(an.a,{title:"Configuraciones",style:{paddingRight:"8px",fontSize:"1.5rem"},onClick:function(){return O(!0)}}),Object(r.jsx)(sn,{accion:"editar",empleado:n,contratas:o,visible:u,setVisible:l,guardar:function(e){return f.apply(this,arguments)}}),Object(r.jsx)(On,{visible:b,setVisible:O,listarEmpleados:c,id:t})]})}var pn=n(495),hn=Re.a.Text;var mn=function(e){var t=e.visible,n=e.abrirModal,a=e.empleado,c=void 0===a?{}:a;return Object(r.jsx)(Lt.a,{width:450,cancelText:"Cancelar",okText:"Aceptar",title:"Detalle del Usuario",visible:t,onOk:n,onCancel:n,destroyOnClose:!0,centered:!0,children:Object(r.jsxs)(pn.a,{layout:"vertical",bordered:!0,size:"small",column:2,children:[c.gestor&&Object(r.jsx)(pn.a.Item,{label:"Gestor:",children:c.gestor.nombre&&c.gestor.nombre}),Object(r.jsx)(pn.a.Item,{label:"Tipo de Doc.:",children:c.tipo_documento}),Object(r.jsx)(pn.a.Item,{label:"Numero de Doc.:",children:Object(r.jsx)(hn,{copyable:!0,children:c.numero_documento})}),Object(r.jsx)(pn.a.Item,{label:"Fecha de Nacimiento:",children:c.fecha_nacimiento&&Ke()(c.fecha_nacimiento).format("DD-MM-YYYY")}),c.fecha_ingreso&&Object(r.jsx)(pn.a.Item,{label:"Fecha de Ingreso",children:Ke()(c.fecha_ingreso).format("DD-MM-YYYY")}),c.fecha_baja&&Object(r.jsx)(pn.a.Item,{label:"Fecha de Baja",children:Ke()(c.fecha_baja).format("DD-MM-YYYY")}),Object(r.jsx)(pn.a.Item,{label:"Nacionalidad",children:c.nacionalidad?c.nacionalidad:"-"}),Object(r.jsx)(pn.a.Item,{label:"Observaci\xf3n",span:2,children:c.observacion})]})})},xn=Re.a.Text;function gn(){var e=Object(a.useState)(1),t=Object(te.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(20),i=Object(te.a)(o,2),s=i[0],u=i[1],l=Object(a.useState)(1),d=Object(te.a)(l,2),j=d[0],b=d[1],O=Object(a.useState)([]),f=Object(te.a)(O,2),p=f[0],h=f[1],m=Object(a.useState)(!1),x=Object(te.a)(m,2),g=x[0],v=x[1],w=Object(a.useState)(!1),E=Object(te.a)(w,2),I=E[0],y=E[1],C=Object(a.useState)({}),S=Object(te.a)(C,2),T=S[0],_=S[1],N=Object(a.useState)([]),R=Object(te.a)(N,2),D=R[0],G=R[1],M=Object(a.useState)(!1),L=Object(te.a)(M,2),P=L[0],z=L[1];function B(){return Y.apply(this,arguments)}function Y(){return(Y=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return z(!0),e.next=3,qt(!0,{metodo:gt,page:n,limit:s}).then((function(e){var t=e.data;h(t.docs),b(t.totalDocs),z(!1)})).catch((function(e){z(!1),console.log(e)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){return(V=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pt(!1,Nt).then((function(e){var t=e.data;return G(t)})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(){return(H=Object(k.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qt(t).then(Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){B(),function(){V.apply(this,arguments)}()}),[n,s]);var U=function(){return v(!g)},K=function(){return y(!I)},q=[{title:"#",width:50,render:function(e,t,n){return n+1}},{title:"Nombre",dataIndex:"nombre",width:150},{title:"Apellidos",dataIndex:"apellidos",width:150,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsx)(Kt.a,{placement:"topLeft",title:e,children:e})}},{title:"Email",dataIndex:"usuario",width:200,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsx)(Kt.a,{placement:"topLeft",title:e&&e.email,children:e&&e.email})}},{title:"Cargo",dataIndex:"usuario",width:150,render:function(e){return Object(r.jsx)(nn,{cargo:e.cargo})}},{title:"Contrata",dataIndex:"contrata",width:200,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsx)(Kt.a,{placement:"topLeft",title:e&&e.nombre,children:e&&e.nombre})}},{title:"Carnet",dataIndex:"carnet",width:150,render:function(e){return e?Object(r.jsx)(xn,{copyable:!0,children:e}):null}},{title:"Estado",dataIndex:"estado_empresa",width:150,render:function(e){return Object(r.jsx)(rn,{estado:e})}},{title:"Acciones",dataIndex:"_id",align:"center",width:100,render:function(e,t){return Object(r.jsx)(fn,{id:e,empleado:t,listarEmpleados:B,listaContratas:D})}}];return Object(r.jsxs)(Ve,{children:[Object(r.jsx)(jt.a,{rowKey:"_id",onRow:function(e){return{onDoubleClick:function(){return _(e),void K()}}},className:"tabla-personal",title:function(){return function(e,t,n,c,o){var i=Object(a.useState)("nombre"),s=Object(te.a)(i,2),u=s[0],l=s[1];function d(){return(d=Object(k.a)(A.a.mark((function e(r){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>1)){e.next=5;break}return e.next=3,Jt(r,u).then((function(e){var t=e.data;t.length>0&&(n(t),c(1),o(t.length))})).catch((function(e){return console.log(e)}));case 3:e.next=7;break;case 5:return e.next=7,t();case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.jsxs)("div",{className:"header-tabla",children:[Object(r.jsxs)("div",{className:"busqueda",children:[Object(r.jsxs)(Bt.a.Group,{onChange:function(e){return l(e.target.value)},value:u,style:{paddingTop:".22rem"},children:[Object(r.jsx)(Bt.a,{value:"nombre",children:"Nombre"}),Object(r.jsx)(Bt.a,{value:"numero_documento",children:"Documento"}),Object(r.jsx)(Bt.a,{value:"carnet",children:"Carnet"})]}),Object(r.jsx)(Xt,{placeholder:"Buscar personal",allowClear:!0,enterButton:!1,onSearch:function(e){return d.apply(this,arguments)},style:{width:200,margin:0}})]}),Object(r.jsx)("div",{className:"boton-agregar",children:Object(r.jsx)(F.a,{icon:Object(r.jsx)(ft.a,{}),onClick:e,children:"Agregar"})})]})}(U,B,h,c,b)},columns:q,dataSource:p,loading:P,size:"small",scroll:{x:"1250px",y:"65vh"},pagination:{current:n,total:j,defaultPageSize:s,pageSizeOptions:[10,20,50,100],onChange:function(e){return c(e)},onShowSizeChange:function(e,t){return u(t)}}}),Object(r.jsx)(sn,{accion:"crear",contratas:D,visible:g,setVisible:v,guardar:function(e){return H.apply(this,arguments)}}),Object(r.jsx)(mn,{visible:I,abrirModal:K,empleado:T})]})}var vn=[{path:p,exact:!0,component:function(){return Object(r.jsxs)("div",{children:[Object(r.jsx)(Ye,{titulo:"Lista de Personal",subtitulo:"Usuarios y Personal"}),Object(r.jsx)(gn,{})]})},nivel:S.todos},{path:h,exact:!0,component:Ht,nivel:S.listaContratas}],wn=n(487),En=n(523),In=n(524),yn=n(521);function Cn(){return Sn.apply(this,arguments)}function Sn(){return(Sn=Object(k.a)(A.a.mark((function e(){var t,n,r,a=arguments;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:[],n=a.length>1?a[1]:void 0,r=a.length>2&&void 0!==a[2]&&a[2],e.abrupt("return",new Promise((function(e,a){if(0===t.length)return e([]);var c=[],o=!1;try{return t.forEach((function(e){void 0!==e[n]&&null!==e[n]&&e[n]._id&&null!==e[n]._id?-1===c.findIndex((function(t){return t.value===e[n]._id}))&&c.push({text:r?e[n].nombre+" "+e[n].apellidos:e[n].nombre,value:e[n]._id}):o=!0})),e(o?[].concat(c,[{text:"-",value:"-"}]):c)}catch(i){return a(i)}})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tn(){return _n.apply(this,arguments)}function _n(){return(_n=Object(k.a)(A.a.mark((function e(){var t,n,r=arguments;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:[],n=r.length>1?r[1]:void 0,e.abrupt("return",new Promise((function(e,r){if(0===t.length)return e([]);var a=[];try{return t.forEach((function(e){void 0!==e[n]&&null!==e[n]&&(-1===a.findIndex((function(t){return t.value===e[n]}))&&a.push({text:e[n],value:e[n]}))})),e(a)}catch(c){return r(c)}})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var An=cn.a.Option;var kn=function(e){var t=e.gestores,n=void 0===t?[]:t,c=e.loadingGestores,o=e.auditores,i=void 0===o?[]:o,s=e.loadingAuditores,u=Object(a.useState)([]),l=Object(te.a)(u,2),d=l[0],j=l[1],b=Object(a.useState)(!1),O=Object(te.a)(b,2),f=O[0],p=O[1],h=Object(a.useState)(!1),m=Object(te.a)(h,2),x=m[0],g=m[1],v=Object(a.useState)(!1),w=Object(te.a)(v,2),E=w[0],I=w[1],y=Object(a.useState)([]),C=Object(te.a)(y,2),S=C[0],T=C[1],_=Object(a.useState)(null),N=Object(te.a)(_,2),R=N[0],D=N[1],G=Object(a.useState)(null),M=Object(te.a)(G,2),L=M[0],P=M[1],z=Object(a.useState)([]),B=Object(te.a)(z,2),Y=B[0],V=B[1],H=Object(a.useState)([]),U=Object(te.a)(H,2),K=U[0],q=U[1],J=Object(a.useState)([]),W=Object(te.a)(J,2),Q=W[0],Z=W[1];function X(){return $.apply(this,arguments)}function $(){return($=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.next=3,qt(!0,{metodo:vt}).then(function(){var e=Object(k.a)(A.a.mark((function e(t){var n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=t.data)&&(Cn(n,"contrata").then((function(e){return V(e)})),Cn(n,"gestor",!0).then((function(e){return q(e)})),Cn(n,"auditor",!0).then((function(e){return Z(e)})),j(n));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log(e)})).finally((function(){return p(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(){return ne.apply(this,arguments)}function ne(){return(ne=Object(k.a)(A.a.mark((function e(){var t=arguments;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!(t.length>0&&void 0!==t[0])||t[0])){e.next=12;break}if(!(S.length>0)){e.next=8;break}return g(!0),e.next=6,Wt(!0,{metodo:_t,gestor:R,tecnicos:S}).then(Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T([]),e.next=3,X();case 3:case"end":return e.stop()}}),e)})))).catch((function(e){T([]),console.log(e)})).finally((function(){return g(!1)}));case 6:e.next=9;break;case 8:console.log("no hay tecnicos seleccionado");case 9:e.next=19;break;case 12:if(!(L&&S.length>0)){e.next=18;break}return I(!0),e.next=16,Wt(!0,{metodo:At,auditor:L,tecnicos:S}).then(Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T([]),e.next=3,X();case 3:case"end":return e.stop()}}),e)})))).catch((function(e){T([]),console.log(e)})).finally((function(){return I(!1)}));case 16:e.next=19;break;case 18:console.log("no hay tecnicos o auditor seleccionado");case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){X()}),[]);var re=[{title:"#",width:50,align:"center",render:function(e,t,n){return n+1}},{title:"Nombre",width:150,dataIndex:"nombre"},{title:"Apellidos",width:150,dataIndex:"apellidos"},{title:"Carnet",width:100,dataIndex:"carnet"},{title:"Contrata",width:150,dataIndex:"contrata",filters:Y,onFilter:function(e,t){return"-"===e?!t.contrata:void 0!==t.contrata&&0===t.contrata._id.indexOf(e)},render:function(e){return e.nombre&&e.nombre}},{title:"Gestor",width:150,dataIndex:"gestor",filters:K,onFilter:function(e,t){return"-"===e?!t.gestor:void 0!==t.gestor&&null!==t.gestor&&0===t.gestor._id.indexOf(e)},render:function(e){return e&&e.nombre&&e.apellidos?e.nombre+" "+e.apellidos:"-"}},{title:"Auditor",width:150,dataIndex:"auditor",filters:Q,onFilter:function(e,t){return"-"===e?!t.auditor:void 0!==t.auditor&&0===t.auditor._id.indexOf(e)},render:function(e){return e&&e.nombre&&e.apellidos?e.nombre+" "+e.apellidos:"-"}}];return Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:"Asignar Gestor:"}),Object(r.jsx)(cn.a,{showSearch:!0,placeholder:"Buscar por nombre",loading:c,defaultValue:R,onChange:function(e){return D(e)},style:{width:300,marginBottom:".5rem",marginRight:".5rem"},filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},children:n.length>0?n.map((function(e,t){return Object(r.jsx)(An,{value:e._id,children:"".concat(e.nombre," ").concat(e.apellidos)},t)})):Object(r.jsx)(An,{children:"Sin data"})}),Object(r.jsx)(F.a,{icon:x?Object(r.jsx)(yn.a,{spin:!0}):Object(r.jsx)($t.a,{}),onClick:ee,children:"Asignar"}),Object(r.jsx)("p",{children:"Asignar Auditor:"}),Object(r.jsx)(cn.a,{showSearch:!0,placeholder:"Buscar por nombre",loading:s,defaultValue:L,onChange:function(e){return P(e)},style:{width:300,marginBottom:".5rem",marginRight:".5rem"},filterOption:function(e,t){return console.log(e,t),t.children.toLowerCase().indexOf(e.toLowerCase())>=0},children:i.length>0?i.map((function(e,t){return Object(r.jsx)(An,{value:e._id,children:"".concat(e.nombre," ").concat(e.apellidos)},t)})):Object(r.jsx)(An,{children:"Sin data"})}),Object(r.jsx)(F.a,{icon:E?Object(r.jsx)(yn.a,{spin:!0}):Object(r.jsx)($t.a,{}),onClick:function(){return ee(!1)},children:"Asignar"}),Object(r.jsx)(jt.a,{rowKey:"_id",size:"small",dataSource:d,loading:f,columns:re,rowSelection:{columnWidth:30,selectedRowKeys:S,onChange:function(e){return T(e)}},pagination:{defaultPageSize:20,pageSizeOptions:[20,50,100]},scroll:{y:"60vh"}})]})},Nn=n(522),Rn=function(){var e=Object(k.a)(A.a.mark((function e(t){var n,r,a,c,o;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.metodo,r=t.page,a=t.limit,c=t.fecha_inicio,o=t.fecha_fin,e.abrupt("return",K({url:"asistencia",method:"GET",params:{metodo:n,page:r,limit:a,fecha_inicio:c,fecha_fin:o}},!0));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Dn=n(115);function Gn(){return Mn.apply(this,arguments)}function Mn(){return(Mn=Object(k.a)(A.a.mark((function e(){var t,n=arguments;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:[],e.abrupt("return",new Promise((function(e,n){try{var r=[];return 0===t.length||t.forEach((function(e){if(r.length>0){var t=r.findIndex((function(t){return t.nombre===e.tecnico.nombre&&t.apellidos===e.tecnico.apellidos}));if(-1!==t&&e.createdAt){var n=r[t],a=Ke()(e.createdAt).format("DD-MM");r[t]=Object(i.a)(Object(i.a)({},n),{},Object(Dn.a)({},a,{estado:e.estado,observacion:e.observacion,iniciado:e.iniciado,fecha_iniciado:e.fecha_iniciado}))}else{var c=Ke()(e.createdAt).format("DD-MM"),o=Object(Dn.a)({_id:e._id,nombre:e.tecnico.nombre,apellidos:e.tecnico.apellidos,gestor:{nombre:void 0!==e.tecnico.gestor&&null!==e.tecnico.gestor?e.tecnico.gestor.nombre+" "+e.tecnico.gestor.apellidos:"-",_id:void 0!==e.tecnico.gestor&&null!==e.tecnico.gestor?e.tecnico.gestor._id:"-"},auditor:{nombre:void 0!==e.tecnico.auditor?e.tecnico.auditor.nombre+" "+e.tecnico.auditor.apellidos:"-",_id:void 0!==e.tecnico.auditor?e.tecnico.auditor._id:"-"},observacion:e.observacion},c,{estado:e.estado,observacion:e.observacion,iniciado:e.iniciado,fecha_iniciado:e.fecha_iniciado});r.push(o)}}else{var s=Ke()(e.createdAt).format("DD-MM");r=[Object(Dn.a)({_id:e._id,nombre:e.tecnico.nombre,apellidos:e.tecnico.apellidos,gestor:{nombre:void 0!==e.tecnico.gestor?e.tecnico.gestor.nombre+" "+e.tecnico.gestor.apellidos:"-",_id:void 0!==e.tecnico.gestor?e.tecnico.gestor._id:"-"},auditor:{nombre:void 0!==e.tecnico.auditor?e.tecnico.auditor.nombre+" "+e.tecnico.auditor.apellidos:"-",_id:void 0!==e.tecnico.auditor?e.tecnico.auditor._id:"-"},observacion:e.observacion},s,{estado:e.estado,observacion:e.observacion,iniciado:e.iniciado,fecha_iniciado:e.fecha_iniciado})]}})),e(r)}catch(a){return n(a)}})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ln={FALTA:"F",ASISTIO:"A",DESCANSO:"D",PERMISO:"P",SUSPENDIDO:"S",DESCANSO_MEDICO:"DM",EXAMEN_MEDICO:"EM"};var Fn=function(e){var t=e.estado;switch(t){case Ln.FALTA:return Object(r.jsx)(dt.a,{color:"error",children:t});case Ln.ASISTIO:return Object(r.jsx)(dt.a,{color:"success",children:t});case Ln.DESCANSO:return Object(r.jsx)(dt.a,{color:"gold",children:t});case Ln.PERMISO:return Object(r.jsx)(dt.a,{color:"blue",children:t});case Ln.SUSPENDIDO:return Object(r.jsx)(dt.a,{color:"warning",children:t});case Ln.DESCANSO_MEDICO:return Object(r.jsx)(dt.a,{color:"geekblue",children:t});case Ln.EXAMEN_MEDICO:return Object(r.jsx)(dt.a,{color:"purple",children:t});default:return Object(r.jsx)(dt.a,{children:"-"})}},Pn=[{title:"#",width:50,align:"center",render:function(e,t,n){return n+1}},{title:"Tecnico",width:200},{title:"Gestor",width:200},{title:"Fecha",width:100}];function zn(){var e=Object(a.useState)(null),t=Object(te.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(null),i=Object(te.a)(o,2),s=i[0],u=i[1],l=Object(a.useState)([]),d=Object(te.a)(l,2),j=d[0],b=d[1],O=Object(a.useState)(Pn),f=Object(te.a)(O,2),p=f[0],h=f[1],m=Object(a.useState)([]),x=Object(te.a)(m,2),g=x[0],v=x[1],w=Object(a.useState)(!1),E=Object(te.a)(w,2),I=E[0],y=E[1],C=Object(a.useState)([]),S=Object(te.a)(C,2),T=S[0],_=S[1],N=Object(a.useState)([]),R=Object(te.a)(N,2),M=R[0],L=R[1],P=Object(a.useState)({total:0,activas:0}),z=Object(te.a)(P,2),B=z[0],Y=z[1];function V(){return(V=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n||!s){e.next=4;break}return y(!0),e.next=4,Rn({metodo:Mt,page:1,limit:20,fecha_inicio:n,fecha_fin:s}).then(function(){var e=Object(k.a)(A.a.mark((function e(t){var n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,e.next=3,Gn(n.filter((function(e){return null!==e.tecnico})));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){v(e),Cn(e,"gestor",!0).then((function(e){return _(e)})),Cn(e,"auditor",!0).then((function(e){return L(e)})),H(e)})).catch((function(e){return console.log(e)})).finally((function(){return y(!1)}));case 4:case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e){var t=0,n=0,r=Ke()().format("DD-MM");e.length>0&&e.forEach((function(e){e[r]&&e[r].estado&&(t+=1,e[r].iniciado&&(n+=1))})),Y({total:t,activas:n})}return Object(a.useEffect)((function(){!function(){var e=Ke()().format("DD-MM");if(j.length>0){var t=[{title:"#",width:50,align:"center",render:function(e,t,n){return n+1}},{title:"Tecnico",dataIndex:"nombre",width:300,render:function(e,t){return t.nombre+" "+t.apellidos}},{title:"Gestor",dataIndex:"gestor",filters:T,onFilter:function(e,t){return!(!t.gestor||!e)&&0===t.gestor._id.indexOf(e)},width:250,render:function(e){return e.nombre?e.nombre:"-"}},{title:"Auditor",dataIndex:"auditor",filters:M,onFilter:function(e,t){return!(!t.auditor||!e)&&0===t.auditor._id.indexOf(e)},width:250,render:function(e){return e.nombre?e.nombre:"-"}},{title:"En Ruta",dataIndex:e,width:150,align:"center",filters:[{text:"Ok",value:!0},{text:"No",value:!1}],onFilter:function(t,n){return!!n[e]&&(!n[e].iniciado&&!t||n[e].iniciado===t)},render:function(e){return e?e.iniciado?Object(r.jsx)(ye.a,{content:e.fecha_iniciado?Ke()(e.fecha_iniciado).format("HH:mm"):"-",title:"Observaciones",trigger:"click",children:Object(r.jsx)("button",{className:"boton-none",children:Object(r.jsx)(dt.a,{color:We.success,children:Object(r.jsx)($t.a,{})})})}):Object(r.jsx)(dt.a,{color:We.error,children:Object(r.jsx)(tn.a,{})}):Object(r.jsx)(dt.a,{color:We.error,children:"No"})}}],n=j.map((function(e){return{title:e,width:100,align:"center",dataIndex:e,render:function(e){return e&&e.estado&&e.observacion&&"-"!==e.observacion?Object(r.jsx)(ye.a,{content:e.observacion,title:"Observaciones",trigger:"click",children:Object(r.jsx)("button",{className:"boton-none",children:Object(r.jsx)(Fn,{estado:e.estado})})}):Object(r.jsx)(Fn,{estado:e&&e.estado?e.estado:"-"})}}}));h([].concat(t,Object(oe.a)(n)))}else h([])}()}),[j,T]),Object(r.jsxs)("div",{children:[Object(r.jsxs)(D.a,{children:[Object(r.jsxs)(G.a,{sm:24,style:{marginBottom:".5rem"},children:[Object(r.jsx)("p",{style:{color:"rgba(0,0,0,0.45)"},children:"Seleccionar Fecha:"}),Object(r.jsx)(Ft.a,{onChange:function(e){if(e){var t=e.clone().startOf("week"),n=e.clone().endOf("week");c(Ke()(t).format("YYYY-MM-DD")),u(Ke()(n).format("YYYY-MM-DD"));for(var r=[],a=0;a<=6;a++)r.push(Ke()(t).add(a,"days").format("DD-MM"));b(r)}else c(null),u(null)},picker:"week",style:{marginRight:".5rem"}}),Object(r.jsx)(F.a,{disabled:I,icon:I?Object(r.jsx)(yn.a,{spin:!0}):Object(r.jsx)(Nn.a,{}),onClick:function(){return V.apply(this,arguments)},children:"Actualizar"})]}),Object(r.jsx)(G.a,{sm:6,style:{marginBottom:"1rem",marginRight:".5rem"},children:Object(r.jsx)(He.a,{title:"Semana selecionada",value:n&&s?"".concat(Ke()(n).format("DD-MM")," / ").concat(Ke()(s).format("DD-MM")):"-"})}),Object(r.jsx)(G.a,{children:Object(r.jsx)(He.a,{title:"Rutas Activas (Hoy)",value:B.activas,suffix:"/ ".concat(B.total)})})]}),Object(r.jsx)(jt.a,{rowKey:"_id",size:"small",loading:I,columns:p,dataSource:g,pagination:{defaultPageSize:20}})]})}var Bn=wn.a.TabPane;var Yn=[{path:m,exact:!0,component:function(){var e=Object(a.useState)([]),t=Object(te.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(!1),i=Object(te.a)(o,2),s=i[0],u=i[1],l=Object(a.useState)([]),d=Object(te.a)(l,2),j=d[0],b=d[1],O=Object(a.useState)(!1),f=Object(te.a)(O,2),p=f[0],h=f[1];function m(){return(m=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.next=3,qt(!1,{metodo:wt}).then((function(e){var t=e.data;t&&c([].concat(Object(oe.a)(t),[{_id:null,nombre:"-",apellidos:""}]))})).catch((function(e){return console.log(e)})).finally((function(){return u(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return(x=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.next=3,qt(!1,{metodo:Et}).then((function(e){var t=e.data;t&&b(t)})).catch((function(e){return console.log(e)})).finally((function(){return h(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){!function(){m.apply(this,arguments)}(),function(){x.apply(this,arguments)}()}),[]),Object(r.jsxs)("div",{children:[Object(r.jsx)(Ye,{titulo:"Lista de Rutas",subtitulo:"Operativa"}),Object(r.jsx)(Ve,{children:Object(r.jsxs)(wn.a,{style:{paddingLeft:"1rem"},animated:!1,children:[Object(r.jsx)(Bn,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(En.a,{}),"Asignar Rutas"]}),children:Object(r.jsx)(kn,{gestores:n,loadingGestores:s,auditores:j,loadingAuditores:p})},"1"),Object(r.jsx)(Bn,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(In.a,{}),"Asistencia"]}),children:Object(r.jsx)(zn,{})},"2")]})})]})},nivel:S.administrarOrdenes}],Vn=n(530),Hn={TIPO:"averiashfc",CODIGO_ZONAL:"codofcadm",CODIGO_REQUERIMIENTO:"codreq",CODIGO_CLIENTE:"codcli",NOMBRE_CLIENTE:"nomcli",CODIGO_CTR:"codctr",DESCRIPCION_CTR:"desnomctr",CODIGO_NODO:"codnod",CODIGO_TROBA:"nroplano",DISTRITO:"desdtt",destipvia:"destipvia",desnomvia:"desnomvia",numvia:"numvia",despis:"despis",desint:"desint",desmzn:"desmzn",deslot:"deslot",destipurb:"destipurb",desurb:"desurb",FECHA_REGISTRO:"fec_regist",CODIGO_MOTIVO:"codmotv",DETALLE_MOTIVO:"desmotv",TIPO_REQUERIMIENTO:"tipreqfin",DETALLE_TRABAJO:"desobsordtrab",TELEFONO_CONTACTO:"tel_cont_cc",TELEFONO_REFERENCIA:"tel_cont_ref_cc",NUMERO_REITERADA:"numaverei",TIPO_TECNOLOGIA:"tiptecnologia"},Un=n(486),Kn=n(525),qn=n(526),Jn=n(185);function Wn(){return(Wn=Object(k.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){try{var r=new FileReader,a=!!r.readAsBinaryString;r.onload=function(t){var n=t.target.result,r=Jn.read(n,{type:a?"binary":"array",bookVBA:!0}),c=r.SheetNames[0],o=r.Sheets[c],i=Jn.utils.sheet_to_json(o),s=[];return i.map((function(e){return s.push(Object.keys(e).reduce((function(t,n){return t[n.trim().toLowerCase()]=e[n],t}),{}))})),e(s)},a?r.readAsBinaryString(t):r.readAsArrayBuffer(t)}catch(c){return n(c)}})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qn(e,t){var n=new Date(86400*(e-25569)*1e3);return t?n:new Date(n.setHours(n.getHours()+5))}var Zn=n(186),Xn=n.n(Zn),$n=["470","476"];function er(){return tr.apply(this,arguments)}function tr(){return(tr=Object(k.a)(A.a.mark((function e(){var t,n,r=arguments;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:[],n=t.filter((function(e){return $n.includes(String(e[Hn.CODIGO_CTR]))})).map((function(e,t){var n=!0;return Xn()(e[Hn.TELEFONO])&&(n=!1),Xn()(String(e[Hn.DISTRITO]).trim())&&(n=!1),isNaN(e[Hn.CODIGO_REQUERIMIENTO])&&(n=!1),{key:t,verificado:n,tipo:Hn.TIPO,codigo_zonal:void 0!==e[Hn.CODIGO_ZONAL]&&e[Hn.CODIGO_ZONAL],codigo_requerimiento:void 0!==e[Hn.CODIGO_REQUERIMIENTO]&&e[Hn.CODIGO_REQUERIMIENTO],codigo_cliente:void 0!==e[Hn.CODIGO_CLIENTE]&&e[Hn.CODIGO_CLIENTE],nombre_cliente:void 0!==e[Hn.NOMBRE_CLIENTE]&&e[Hn.NOMBRE_CLIENTE],codigo_ctr:void 0!==e[Hn.CODIGO_CTR]&&e[Hn.CODIGO_CTR],descripcion_ctr:void 0!==e[Hn.DESCRIPCION_CTR]&&e[Hn.DESCRIPCION_CTR],codigo_nodo:void 0!==e[Hn.CODIGO_NODO]&&e[Hn.CODIGO_NODO],codigo_troba:void 0!==e[Hn.CODIGO_TROBA]&&e[Hn.CODIGO_TROBA],distrito:void 0!==e[Hn.DISTRITO]&&e[Hn.DISTRITO],direccion:(void 0!==e[Hn.destipvia]?e[Hn.destipvia]:"")+(void 0!==e[Hn.desnomvia]?" "+e[Hn.desnomvia]:"")+(void 0!==e[Hn.numvia]?" "+e[Hn.numvia]:"")+(void 0!==e[Hn.despis]?" "+e[Hn.despis]:"")+(void 0!==e[Hn.desint]?" Int. "+e[Hn.desint]:"")+(void 0!==e[Hn.desmzn]?" Mz. "+e[Hn.desmzn]:"")+(void 0!==e[Hn.deslot]?" Lt. "+e[Hn.deslot]:"")+(void 0!==e[Hn.destipurb]?" "+e[Hn.destipurb]:"")+(void 0!==e[Hn.desurb]?" "+e[Hn.desurb]:""),fecha_registro:!isNaN(Number(e[Hn.FECHA_REGISTRO]))&&Qn(e[Hn.FECHA_REGISTRO]),codigo_motivo:void 0!==e[Hn.CODIGO_MOTIVO]&&e[Hn.CODIGO_MOTIVO],detalle_motivo:void 0!==e[Hn.DETALLE_MOTIVO]&&e[Hn.DETALLE_MOTIVO].replace(/,/g,""),tipo_requerimiento:void 0!==e[Hn.TIPO_REQUERIMIENTO]&&e[Hn.TIPO_REQUERIMIENTO],detalle_trabajo:void 0!==e[Hn.DETALLE_TRABAJO]&&e[Hn.DETALLE_TRABAJO].replace(/,/g,""),telefono_contacto:void 0!==e[Hn.TELEFONO_CONTACTO]&&e[Hn.TELEFONO_CONTACTO],telefono_referencia:void 0!==e[Hn.TELEFONO_REFERENCIA]&&e[Hn.TELEFONO_REFERENCIA],numero_reiterada:void 0!==e[Hn.NUMERO_REITERADA]&&e[Hn.NUMERO_REITERADA],tipo_tecnologia:void 0!==e[Hn.TIPO_TECNOLOGIA]&&e[Hn.TIPO_TECNOLOGIA]}})),e.abrupt("return",Promise.all(n).catch((function(e){return console.log("Error en la promesa"),console.log(e),e})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function nr(e,t,n){return rr.apply(this,arguments)}function rr(){return(rr=Object(k.a)(A.a.mark((function e(t,n,r){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n,e.next=e.t0===Hn.TIPO?3:10;break;case 3:if(1!==r){e.next=9;break}return e.next=6,er(t);case 6:return e.abrupt("return",e.sent);case 9:return e.abrupt("return",!1);case 10:return e.abrupt("break",11);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ar=function(){var e=Object(k.a)(A.a.mark((function e(t,n){var r,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.metodo,a=n.tipo,e.abrupt("return",K({url:"ordenes",method:"GET",params:{metodo:r,tipo:a}},t));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),cr=function(){var e=Object(k.a)(A.a.mark((function e(t){var n,r,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.metodo,r=t.ordenes,a=t.orden,e.abrupt("return",K({url:"ordenes",method:"POST",data:{ordenes:r,metodo:n,orden:a}},!0));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var or=function(e){var t=e.tipoOrden,n=Object(a.useState)(1),c=Object(te.a)(n,2),o=c[0],i=c[1],s=Object(a.useState)("done"),u=Object(te.a)(s,2),l=u[0],d=u[1],j=Object(a.useState)(""),b=Object(te.a)(j,2),O=b[0],f=b[1],p=Object(a.useState)([]),h=Object(te.a)(p,2),m=h[0],x=h[1],g=Object(a.useState)(!1),v=Object(te.a)(g,2),w=v[0],E=v[1];function I(){return(I=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==m.length){e.next=4;break}V.a.warn("No hay ordenes para subir.",{position:"top-right"}),e.next=8;break;case 4:return E(!0),e.next=7,cr({metodo:Rt,ordenes:m}).then(Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return V.a.info("Sincronizando ordenes con TOA...",{position:"top-right"}),e.next=3,ar(!0,{metodo:Dt,tipo:t});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)}));case 7:E(!1);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){d("done"),f(""),x([])}),[o]),Object(r.jsx)("div",{children:Object(r.jsxs)(D.a,{children:[Object(r.jsxs)(G.a,{sm:10,md:10,lg:12,xl:12,spellCheck:!0,children:[Object(r.jsx)("p",{children:"Tipo de Archivo:"}),Object(r.jsxs)(Bt.a.Group,{onChange:function(e){return i(e.target.value)},value:o,children:[Object(r.jsx)(Bt.a,{value:1,children:"Pendientes"}),Object(r.jsx)(Bt.a,{value:2,children:"Liquidadas"})]}),Object(r.jsx)("div",{style:{width:"14rem",margin:"1rem 0"},children:Object(r.jsx)(Un.a,{accept:".xls,.xlsx",beforeUpload:function(e){return d("uploading"),f(e.name),H.formatosAdmitidos.includes(e.type)?(function(e){return Wn.apply(this,arguments)}(e).then(function(){var e=Object(k.a)(A.a.mark((function e(n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nr(n,t,o).then((function(e){d("done"),x(e),V.a.success("".concat(e.length," Ordenes encontradas."),{position:"top-right"})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){d("error"),V.a.error("Error convirtiendo el archivo",{position:"top-right"}),console.log(e)})),!1):(d("error"),V.a.warn("Formato Incorrecto.",{position:"top-right"}),!1)},onRemove:function(){f(""),d("done"),x([])},fileList:[{uid:"-1",name:O,status:l}],children:Object(r.jsxs)(F.a,{children:[Object(r.jsx)(Kn.a,{})," ","Subir Archivo"]})})})]}),Object(r.jsxs)(G.a,{sm:14,md:14,lg:12,xl:12,children:[Object(r.jsx)(He.a,{title:"Ordenes",value:m.length}),Object(r.jsx)(F.a,{style:{marginTop:".5rem"},type:"primary",icon:w?Object(r.jsx)(yn.a,{spin:!0}):Object(r.jsx)(qn.a,{}),onClick:function(){return I.apply(this,arguments)},children:"Guardar"})]})]})})},ir=n(527),sr=n(528),ur=n(529);function lr(e){return e.charAt(0).toUpperCase()+e.slice(1)}var dr=function(e){var t=e.estado;switch(t){case"cancelado":return Object(r.jsx)(dt.a,{children:lr(t)});case"completado":return Object(r.jsx)(dt.a,{color:"success",children:lr(t)});case"iniciado":return Object(r.jsx)(dt.a,{color:"geekblue",children:lr(t)});case"no realizada":return Object(r.jsx)(dt.a,{color:"magenta",children:lr(t)});case"pendiente":return Object(r.jsx)(dt.a,{color:"orange",children:lr(t)});case"suspendido":return Object(r.jsx)(dt.a,{color:"red",children:lr(t)});default:return Object(r.jsx)(dt.a,{children:"-"})}},jr=Re.a.Text;function br(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return[{title:"#",width:50,render:function(e,t,n){return n+1}},{title:"Requerimiento",dataIndex:"codigo_requerimiento",width:120,render:function(e){return Object(r.jsx)(jr,{copyable:!0,children:e})}},{title:"CTR",dataIndex:"codigo_ctr",width:60},{title:"Nodo",dataIndex:"codigo_nodo",width:60},{title:"Troba",dataIndex:"codigo_troba",width:70,sorter:function(e,t){return e.codigo_troba<t.codigo_troba?-1:e.codigo_troba>t.codigo_troba?1:0}},{title:"Reiterada",dataIndex:"numero_reiterada",width:100,align:"center",sorter:function(e,t){return e.numero_reiterada-t.numero_reiterada},render:function(e){return e?Object(r.jsx)(dt.a,{color:"#E5302F",children:e}):"-"}},{title:"Distrito",dataIndex:"distrito",width:160,filters:e||[],onFilter:function(e,t){return 0===t.distrito.indexOf(e)}},{title:"Bucket",dataIndex:"bucket",width:200,ellipsis:{showTitle:!1},filters:t||[],onFilter:function(e,t){return 0===t.bucket.indexOf(e)},render:function(e){return Object(r.jsx)(Kt.a,{placement:"topLeft",title:e,children:e})}},{title:"Estado",dataIndex:"estado_toa",width:150,align:"center",filters:n||[],onFilter:function(e,t){return 0===t.estado_toa.indexOf(e)},render:function(e){return Object(r.jsx)(dr,{estado:e})}},{title:"Contrata",dataIndex:"contrata",width:200,ellipsis:{showTitle:!1},filters:a||[],onFilter:function(e,t){return"-"===e?!t.contrata:void 0!==t.contrata&&0===t.contrata._id.indexOf(e)},render:function(e){return Object(r.jsx)(Kt.a,{placement:"topLeft",title:e?e.nombre:"-",children:e?e.nombre:"-"})}},{title:"Gestor",dataIndex:"gestor",width:200,ellipsis:{showTitle:!1},filters:c||[],onFilter:function(e,t){return"-"===e?!t.gestor:void 0!==t.gestor&&0===t.gestor._id.indexOf(e)},render:function(e){return Object(r.jsx)(Kt.a,{placement:"topLeft",title:e?e.nombre+" "+e.apellidos:"-",children:e?e.nombre+" "+e.apellidos:"-"})}},{title:"Fecha Registro",dataIndex:"fecha_registro",width:150,render:function(e){return e?Ke()(e).format("DD/MM/YY HH:mm"):"-"}},{title:"Horas",dataIndex:"fecha_registro",width:80,align:"center",render:function(e){return e?Object(r.jsx)(dt.a,{children:Ke()().diff(e,"hours")}):Object(r.jsx)(dt.a,{children:"-"})}}]}var Or=function(e){e.gestores,e.contratas;var t=e.tipo,n=Object(a.useState)([]),c=Object(te.a)(n,2),o=c[0],i=c[1],s=Object(a.useState)(!1),u=Object(te.a)(s,2),l=u[0],d=u[1],j=Object(a.useState)(!1),b=Object(te.a)(j,2),O=b[0],f=b[1],p=Object(a.useState)([]),h=Object(te.a)(p,2),m=h[0],x=h[1],g=Object(a.useState)([]),v=Object(te.a)(g,2),w=v[0],E=v[1],I=Object(a.useState)([]),y=Object(te.a)(I,2),C=y[0],S=y[1],T=Object(a.useState)([]),_=Object(te.a)(T,2),N=_[0],R=_[1],D=Object(a.useState)([]),G=Object(te.a)(D,2),M=G[0],L=G[1],P=Object(a.useState)([]),z=Object(te.a)(P,2),B=z[0],Y=z[1];function V(){return H.apply(this,arguments)}function H(){return(H=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.next=3,ar(!0,{metodo:Gt}).then((function(e){var t=e.data;return i(t)})).catch((function(e){return console.log(e)})).finally((function(){return d(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(){return(U=Object(k.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.next=3,ar(!0,{metodo:Dt,tipo:t}).then((function(e){"success"===e.status&&V()})).catch((function(e){return console.log(e)})).finally((function(){return f(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){V()}),[]),Object(a.useEffect)((function(){o.length>0&&(Tn(o,"distrito").then((function(e){return E(e)})),Tn(o,"bucket").then((function(e){return S(e)})),Tn(o,"estado_toa").then((function(e){return R(e)})),Cn(o,"contrata").then((function(e){return L(e)})),Cn(o,"gestor",!0).then((function(e){return Y(e)})))}),[o]),Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{children:[Object(r.jsx)(F.a,{type:"primary",icon:l?Object(r.jsx)(yn.a,{spin:!0}):Object(r.jsx)(Nn.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},onClick:V,children:"Actualizar"}),Object(r.jsx)(F.a,{icon:O?Object(r.jsx)(yn.a,{spin:!0}):Object(r.jsx)(ir.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},onClick:function(){return U.apply(this,arguments)},children:"Sincronizar"}),Object(r.jsx)(F.a,{icon:l?Object(r.jsx)(yn.a,{spin:!0}):Object(r.jsx)(sr.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},children:"Editar Bucket"}),Object(r.jsx)(F.a,{icon:l?Object(r.jsx)(yn.a,{spin:!0}):Object(r.jsx)(ur.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},children:"Asignar"})]}),Object(r.jsx)(jt.a,{rowKey:"_id",onRow:function(e){return{onDoubleClick:function(){return console.log(e)}}},rowSelection:{columnWidth:50,selectedRowKeys:m,onChange:function(e){return x(e)}},columns:br(w,C,N,M,B),dataSource:o,loading:l,size:"small",scroll:{y:"65vh"},pagination:{defaultPageSize:50,pageSizeOptions:[50,100,200]}})]})},fr=wn.a.TabPane;var pr=[{path:x,exact:!0,component:function(){return Object(r.jsxs)("div",{children:[Object(r.jsx)(Ye,{titulo:"Administrar Ordenes",subtitulo:"Operativa"}),Object(r.jsx)(Ve,{children:Object(r.jsxs)(wn.a,{style:{paddingLeft:"1rem"},animated:!1,children:[Object(r.jsx)(fr,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(Vn.a,{}),"Actualizar Ordenes"]}),children:Object(r.jsx)(or,{tipoOrden:Hn.TIPO})},"1"),Object(r.jsx)(fr,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)($t.a,{}),"Lista de Ordenes"]}),children:Object(r.jsx)(Or,{tipo:Hn.TIPO})},"2"),Object(r.jsx)(fr,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(je.a,{}),"Aprobar Ordenes"]})},"3")]})})]})},nivel:S.administrarOrdenes},{path:g,exact:!0,component:function(){return Object(r.jsx)("div",{children:"administrar altas"})},nivel:S.administrarOrdenes},{path:v,exact:!0,component:function(){return Object(r.jsx)("div",{children:"administrar basicas"})},nivel:S.administrarOrdenes},{path:w,exact:!0,component:function(){return Object(r.jsx)("div",{children:"administrar speedy"})},nivel:S.administrarOrdenes}],hr=[].concat(Object(oe.a)(Yn),Object(oe.a)(pr)),mr=[].concat(Object(oe.a)(Ut),Object(oe.a)(vn),Object(oe.a)(hr)),xr=n(264),gr=n(496);function vr(){return Object(r.jsx)(Ve,{children:Object(r.jsx)(gr.a,{status:"403",title:"403",subTitle:"Lo sentimos, no tienes autorizacion para entrar a esta p\xe1gina.",extra:Object(r.jsx)(F.a,{type:"primary",onClick:function(){return window.location.pathname=O},children:"Inicio"})})})}var wr=function(e){var t=e.component,n=e.nivel,c=void 0===n?[]:n,o=Object(xr.a)(e,["component","nivel"]),s=Object(a.useState)(null),l=Object(te.a)(s,2),d=l[0],j=l[1];return Object(a.useEffect)((function(){j(new $(R.a.get(H.TOKEN_STORAGE_KEY)).decodedToken)}),[c]),c.includes(0)||d&&c.includes(d.cargo)?Object(r.jsx)(u.a,Object(i.a)(Object(i.a)({},o),{},{render:function(e){return Object(r.jsx)(t,Object(i.a)({},e))}})):Object(r.jsx)(u.a,Object(i.a)(Object(i.a)({},o),{},{render:function(){return Object(r.jsx)(vr,{})}}))};function Er(){return Object(r.jsx)(l.b,{locale:d.a,children:Object(r.jsx)(s.a,{children:Object(r.jsxs)(u.c,{children:[Object(r.jsx)(u.a,{exact:!0,path:"/",component:T}),Object(r.jsx)(u.a,{exact:!0,path:b,component:ee}),Object(r.jsx)(ze,{children:mr.map((function(e,t){return Object(r.jsx)(wr,{path:e.path,exact:e.exact,nivel:e.nivel,component:function(t){return Object(r.jsx)(e.component,Object(i.a)({},t))}},t)}))})]})})})}var Ir=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function yr(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(Object(r.jsx)(Er,{}),document.getElementById("root")),function(e){if(console.log(!0),console.log("serviceWorker"in navigator),console.log(Ir),"serviceWorker"in navigator){var t=new URL("",window.location.href);if(console.log(t,"--",window.location.origin,t.origin!==window.location.origin),t.origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Ir?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):yr(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):yr(t,e)}))}}()}},[[479,1,2]]]);
//# sourceMappingURL=main.248248b5.chunk.js.map