(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{282:function(e,t){},337:function(e,t,n){},363:function(e,t){},612:function(e,t){},613:function(e,t){},616:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),i=n(49),o=n.n(i),c=n(19),s=n(86),l=n(60),d=n(23),u=(n(336),n(323)),b=(n(337),{TODO:[1,2,3,4,5,6,7,8],ADMINISTRADOR:1,JEFE_OPERACIONES:2,JEFE_LOGISTICA:3,LIDER_GESTION:4,ASISTENTE_LOGISTICA:5,JEFE_CONTRATA:6,GESTOR:7,ALMACENERO:8,AUDITOR:9,TECNICO:10}),f="/login",j="/perfil-usuario",h="/dashboard/resumen-general",p="/lista-personal",O="/lista-contratas",g="/lista-rutas/asignar-rutas",x="/lista-rutas/asistencias",m="/administrar-ordenes/averias-hfc",v="/administrar-ordenes/altas-hfc",_="/administrar-ordenes/basicas",w="/administrar-ordenes/speedy",y="/gestionar-ordenes/asistencia",S="/gestionar-ordenes/lista-ordenes",C="/gestionar-ordenes/liquidar-ordenes",k={todos:b.TODO,listaContratas:[b.ADMINISTRADOR,b.JEFE_OPERACIONES,b.JEFE_LOGISTICA,b.LIDER_GESTION],grupoOperativa:[b.ADMINISTRADOR,b.JEFE_OPERACIONES,b.JEFE_LOGISTICA,b.LIDER_GESTION,b.JEFE_CONTRATA,b.GESTOR],administrarOrdenes:[b.ADMINISTRADOR,b.JEFE_OPERACIONES,b.LIDER_GESTION],gestion:[b.GESTOR]},I=n(4),A=n(620),T=n(630),E=n(283),D={urlApi:"https://atenea-v2.herokuapp.com/api",public:"https://atenea-v2.herokuapp.com/",socket:"https://atenea-v2.herokuapp.com/",TOKEN_STORAGE_KEY:"atenea.authToken",logoPath:"/icon.png",logoFull:"/iconL.png",version:"0.0.32",formatosAdmitidos:["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]},N=E(D.socket,{transports:["websocket"],secure:!0,reconnection:!0}),R=n(618),M=n(619);function q(e){var t=e.children;return Object(r.jsx)(R.a,{style:{margin:"0 24px 1rem",borderRadius:".3rem"},children:Object(r.jsx)(M.a,{span:24,style:{borderRadius:".3rem",padding:"0 1rem",backgroundColor:"#fff",WebkitBoxShadow:"0px 0px 10px 0px rgba(0,0,0,0.03)",MozBoxShadow:"0px 0px 10px 0px rgba(0,0,0,0.03)",boxShadow:"0px 0px 10px 0px rgba(0,0,0,0.03)"},children:t})})}var F=n(39);function L(){var e=Object(a.useState)([]),t=Object(I.a)(e,2),n=t[0],i=t[1];return Object(a.useEffect)((function(){return N.emit("enviarIndicadores"),N.on("indicadoresimagenes",(function(e){i(e)})),N.on("error",(function(e){console.log(e),F.a.error("Error conectando al servidor.",{position:"top-left"})})),function(){N.off("indicadoresimagenes")}}),[]),Object(r.jsx)("div",{children:Object(r.jsxs)(q,{children:[Object(r.jsx)("div",{style:{fontSize:"1.5rem"},children:Object(r.jsx)("a",{href:f,children:"login"})}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)(A.a,{autoplay:!0,children:n&&n.length>0?n.map((function(e,t){return e?Object(r.jsx)("div",{style:{minWidth:"100vw",height:"80vh"},children:Object(r.jsx)(T.a,{src:e,width:"100vw",height:"80vh"})},t):null})):null})]})})}var z=n(5),B=n.n(z),P=n(10),G=n(74),Y=n.n(G),H=n(626),V=n(192),U=n(56),K=n(641),J=n(642),W=n(151),Z=n.n(W),X=function(){var e=Object(P.a)(B.a.mark((function e(t){var n,r;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=F.a.loading("Iniciando sesi\xf3n...",{hideAfter:0,position:"top-right",role:"success"}),r=Z.a.create({baseURL:D.urlApi}),e.next=4,r(Object(c.a)({},t)).then((function(e){var t=e.data;if(n.hide(),t&&t.data)return F.a.success(t.message,{position:"top-right"}),{data:t.data,errors:!1};throw F.a.error("No se puede obtener la data",{position:"top-right"}),Error("No se puede obtener la data")})).catch((function(e){if(n.hide(),e.response){console.log(e.response);var t=e.response.data,r=void 0!==t[Object.keys(t)[0]]?t[Object.keys(t)[0]]:"Error en la solicitud.";return F.a.warn(r,{position:"top-right"}),{data:!1,errors:t}}throw e.request?(console.log(e.request),F.a.warn("Se realiz\xf3 la solicitud, pero no se recibi\xf3 respuesta.",{position:"top-right"}),e):(F.a.error("Algo sucedi\xf3 al configurar la solicitud que provoc\xf3 un error.",{position:"top-right"}),e)}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(P.a)(B.a.mark((function e(t,n){var r,a;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n&&(r=F.a.loading("Cargando...",{hideAfter:0,position:"top-right",role:"success"})),a=Z.a.create({baseURL:D.urlApi,headers:{Authorization:"Bearer "+Y.a.get(D.TOKEN_STORAGE_KEY)}}),e.next=4,a(Object(c.a)({},t)).then((function(e){var t=e.data;return n&&(r.hide(),F.a[t.status?t.status:"error"](t.message,{position:"top-right"})),t})).catch((function(e){if(n&&r.hide(),e.response){var t=e.response.data;return"401"===String(e.response.status)?(F.a.error("Token Invalido, cerrando sesi\xf3n.",{position:"top-right"}),Y.a.remove(D.TOKEN_STORAGE_KEY),document.location.href="/login"):F.a.warn("undefined"!==t.message?t.message:"Error en la solicitud.",{position:"top-right"}),{data:null,errors:t}}throw e.request?(console.log(e.request),F.a.warn("Se realiz\xf3 la solicitud, pero no se recibi\xf3 respuesta.",{position:"top-right"}),e):(F.a.error("Algo sucedi\xf3 al configurar la solicitud que provoc\xf3 un error.",{position:"top-right"}),e)}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),$=function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",X({url:"private/auth/login",method:"POST",data:t}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Q({url:"private/auth/session",method:"GET"},t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(P.a)(B.a.mark((function e(){var t,n=arguments;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(n.length>0&&void 0!==n[0])||n[0],e.abrupt("return",Q({url:"private/auth/logout",method:"GET"},t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne=n(174),re=n(175),ae=n(290),ie=function(){function e(t){Object(ne.a)(this,e),this.decodedToken={nombre:null,id:null,cargo:null,imagen:null,gestor:null,exp:0};try{t&&(this.decodedToken=Object(ae.a)(t))}catch(n){console.log("Error"),console.log(n)}}return Object(re.a)(e,[{key:"isValid",get:function(){return!this.isExpired}},{key:"expiresAt",get:function(){return new Date(1e3*this.decodedToken.exp)}},{key:"isExpired",get:function(){return new Date>this.expiresAt}},{key:"authorizationString",get:function(){return"Bearer ".concat(this.token)}}]),e}();function oe(){var e=Object(l.f)();function t(){return(t=Object(P.a)(B.a.mark((function t(n){return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,$(n).then((function(t){t.data&&!t.errors&&(Y.a.set(D.TOKEN_STORAGE_KEY,t.data),e.push(h))})).catch((function(e){console.log("error"),console.log(e)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(a.useEffect)((function(){new ie(Y.a.get(D.TOKEN_STORAGE_KEY)).isValid&&e.push(h)}),[e]),Object(r.jsx)("div",{children:Object(r.jsx)(R.a,{type:"flex",justify:"space-around",align:"middle",style:{backgroundColor:"rgb(242, 242, 247)",height:"100vh"},children:Object(r.jsx)(M.a,{xs:20,sm:12,md:8,lg:6,xl:5,children:Object(r.jsx)("div",{className:"contenedor-padre",children:Object(r.jsxs)(H.a,{name:"normal_login",className:"login-form",initialValues:{remember:!0},onFinish:function(e){return t.apply(this,arguments)},children:[Object(r.jsx)("div",{className:"logoForm"}),Object(r.jsx)(H.a.Item,{name:"username",hasFeedback:!0,rules:[{required:!0,message:"\xa1Se necesita una correo!"},{type:"email",message:"\xa1Ingresa un email v\xe1lido!"}],children:Object(r.jsx)(V.a,{autoComplete:"current-email",type:"email",prefix:Object(r.jsx)(K.a,{className:"site-form-item-icon"}),placeholder:"Correo"})}),Object(r.jsx)(H.a.Item,{name:"password",hasFeedback:!0,rules:[{required:!0,message:"\xa1Se necesita una contrase\xf1a v\xe1lida!"},{min:6,message:"\xa1La contrase\xf1a debe tener mas de 6 car\xe1cteres!"}],children:Object(r.jsx)(V.a.Password,{autoComplete:"current-password",prefix:Object(r.jsx)(J.a,{className:"site-form-item-icon"}),type:"password",placeholder:"Contrase\xf1a"})}),Object(r.jsx)(H.a.Item,{children:Object(r.jsx)(U.a,{type:"primary",htmlType:"submit",className:"login-form-button",children:"Acceder"})})]})})})})})}var ce=n(3),se=n.n(ce),le=n(183),de=n(621),ue=n(28),be=n(643),fe=n(644),je=n(645),he=n(646),pe=n(647),Oe=n(648),ge=n(63),xe=ge.a.SubMenu,me=ge.a.Item,ve=ge.a.Divider,_e=ge.a.ItemGroup,we=function(){return String(window.location.pathname).substring(1)},ye=[{permisos:[].concat(Object(ue.a)(k.todos),[9]),titulo:"Panel de Control",children:[{grupo:!0,key:"sub100",icon:be.a,titulo:"Dashboard",permisos:k.todos,children:[{ruta:h,icon:be.a,titulo:"Resumen General"}]}]},{permisos:k.todos,titulo:"Usuarios y Contratas",children:[{grupo:!1,ruta:p,icon:fe.a,permisos:k.todos,titulo:"Lista de Personal"},{grupo:!1,ruta:O,icon:je.a,permisos:k.listaContratas,titulo:"Lista de Contratas"}]},{permisos:k.grupoOperativa,titulo:"Operativa",children:[{grupo:!0,key:"listaRutas",icon:he.a,titulo:"Lista Rutas",permisos:k.administrarOrdenes,children:[{ruta:g,icon:he.a,titulo:"Asignar Rutas"},{ruta:x,icon:he.a,titulo:"Asistencias"}]},{grupo:!1,ruta:y,icon:he.a,permisos:k.gestion,titulo:"Asistencia"},{grupo:!0,key:"sub98",icon:pe.a,titulo:"Administrar ordenes",permisos:k.administrarOrdenes,children:[{ruta:m,icon:pe.a,titulo:"Averias Hfc"},{ruta:v,icon:pe.a,titulo:"Altas Hfc"},{ruta:_,icon:pe.a,titulo:"Basicas"},{ruta:w,icon:pe.a,titulo:"Speedy"}]},{grupo:!0,key:"sub97",icon:Oe.a,titulo:"Gestionar ordenes",permisos:k.gestion,children:[{ruta:S,icon:Oe.a,titulo:"Lista de Ordenes"},{ruta:C,icon:Oe.a,titulo:"Liquidar Orden"}]}]}];var Se=function(e){var t=e.cargo;return t?Object(r.jsx)(ge.a,{theme:"light",mode:"inline",defaultSelectedKeys:we(),children:ye.map((function(e,n){return e.permisos.includes(t)?Object(r.jsxs)(_e,{title:e.titulo,children:[Object(r.jsx)(ve,{}),e.children.map((function(e){return!e.grupo&&e.permisos.includes(t)?Object(r.jsx)(me,{children:Object(r.jsxs)(s.b,{to:e.ruta,children:[Object(r.jsx)(e.icon,{}),Object(r.jsx)("span",{children:e.titulo})]})},String(e.ruta).substring(1)):e.grupo&&e.permisos.includes(t)?Object(r.jsx)(xe,{title:Object(r.jsxs)("span",{children:[Object(r.jsx)(e.icon,{}),Object(r.jsx)("span",{children:e.titulo})]}),children:e.children.map((function(e){return Object(r.jsx)(me,{children:Object(r.jsxs)(s.b,{to:e.ruta,children:[Object(r.jsx)(e.icon,{}),Object(r.jsx)("span",{children:e.titulo})]})},String(e.ruta).substring(1))}))},e.key):null}))]},n):null}))}):Object(r.jsx)(ge.a,{theme:"light",mode:"inline",defaultSelectedKeys:we(),children:Object(r.jsxs)(_e,{title:"Panel de Control",children:[Object(r.jsx)(ve,{}),Object(r.jsx)(me,{children:Object(r.jsxs)(s.b,{to:h,children:[Object(r.jsx)(be.a,{}),Object(r.jsx)("span",{children:"Dashboard"})]})},"dashboard")]})})},Ce=de.a.Sider,ke=function(e){var t=e.collapsed,n=e.cargo;return Object(r.jsxs)(Ce,{width:256,theme:"light",breakpoint:"lg",trigger:null,collapsible:!0,collapsed:t,className:"sider",children:[Object(r.jsx)("div",{className:"brand",children:t?Object(r.jsx)("div",{className:"logo",children:Object(r.jsx)("img",{alt:"logo",src:D.logoPath})}):Object(r.jsx)("div",{className:"full-logo",children:Object(r.jsx)("img",{alt:"full-logo",src:D.logoFull})})}),Object(r.jsx)("div",{className:"menu-container",children:Object(r.jsx)(Se,{cargo:n})})]})},Ie=n(653),Ae=n(654),Te=n(295),Ee=n(638),De=n(635),Ne=n(649),Re=n(650),Me=[{title:"Hola",icon:"success"},{title:"Hola",icon:"error"},{title:"Hola",icon:"warning"}],qe=function(){var e=Object(a.useState)(!1),t=Object(I.a)(e,2),n=t[0],i=t[1];return Object(r.jsx)(Te.a,{trigger:"click",placement:"bottomRight",overlayClassName:"notification-popover",visible:n,onVisibleChange:function(e){return i(e)},content:Object(r.jsxs)("div",{className:"caja-notificaciones",style:{minWidth:"20rem"},children:[Object(r.jsx)(Ee.b,{itemLayout:"horizontal",dataSource:Me,locale:{emptyText:Object(r.jsx)("span",{children:"You have viewed all notifications."})},renderItem:function(e){return Object(r.jsxs)(Ee.b.Item,{className:"item-notificaciones",children:[Object(r.jsx)(Ee.b.Item.Meta,{className:"datos-notificaciones",title:Object(r.jsx)("span",{lines:1,children:"Orden Actualizada"}),description:"hola k tal como te va"}),Object(r.jsx)(Ne.a,{className:"flecha-notificaciones"})]})}}),Me.length?Object(r.jsx)("div",{className:"clear-button",children:Object(r.jsx)("span",{children:"Limpiar Notificaciones"})}):null]}),children:Object(r.jsx)(De.a,{count:0,dot:!0,offset:[-10,10],className:"icon-button",children:Object(r.jsx)(Re.a,{className:"icon-font"})})})},Fe=n(325),Le=n(629),ze=n(651),Be=n(652);function Pe(){var e=Object(a.useState)(null),t=Object(I.a)(e,2),n=t[0],i=t[1],o=Object(l.f)();Object(a.useEffect)((function(){var e=new ie(Y.a.get(D.TOKEN_STORAGE_KEY));e&&i(e.decodedToken)}),[]);var c=function(){var e=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te().then(function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"error"!==t.status&&(Y.a.remove(D.TOKEN_STORAGE_KEY),o.push("/login"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e),console.log("Error cerrando sesi\xf3n.")}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsx)(ge.a,{mode:"horizontal",children:Object(r.jsxs)(ge.a.SubMenu,{title:Object(r.jsxs)(a.Fragment,{children:[Object(r.jsx)("span",{style:{color:"#999",marginRight:4},children:Object(r.jsx)("span",{children:"Hola,"})}),Object(r.jsx)("span",{children:n&&n.nombre}),Object(r.jsx)(Fe.a,{style:{marginLeft:8},src:n&&n.imagen})]}),children:[Object(r.jsx)(ge.a.Item,{children:Object(r.jsx)(Le.a.Text,{type:"sucess",children:Object(r.jsxs)(s.b,{to:j,children:[Object(r.jsx)(ze.a,{}),"Configuraciones"]})})},"Configuraciones"),Object(r.jsx)(ge.a.Item,{onClick:c,children:Object(r.jsxs)(Le.a.Text,{type:"danger",children:[Object(r.jsx)(Be.a,{}),"Desconectar"]})},"SignOut")]})},"user")}var Ge=n(329),Ye=n(324);var He,Ve=(He=function(e){var t=e.children,n=e.spinLoading,i=e.cargo,o=Object(a.useState)(!1),c=Object(I.a)(o,2),s=c[0],l=c[1],d={backgroundColor:"white",width:"100%",margin:"0px",padding:"16px 16px 24px 10px",transition:"margin .2s",clear:"both",left:s?"80px":"256px",bottom:0,right:0};return Object(r.jsx)(le.a,{spinning:n,tip:"Cargando Interfaz...",size:"large",className:"spin-container",children:Object(r.jsxs)(de.a,{children:[Object(r.jsx)(ke,{collapsed:s,cargo:i}),Object(r.jsxs)(de.a,{className:"site-layout",children:[Object(r.jsxs)(de.a.Header,{style:{minWidth:s&&"calc(100vw - 95px)"},className:se()("header",{collapsed:s}),id:"layoutHeader",children:[Object(r.jsx)("div",{className:"button",onClick:function(){return l(!s)},children:s?Object(r.jsx)(Ie.a,{className:"text-primary"}):Object(r.jsx)(Ae.a,{})}),Object(r.jsxs)("div",{className:"right-container",children:[Object(r.jsx)(qe,{}),Object(r.jsx)(Pe,{})]})]}),Object(r.jsx)(de.a.Content,{className:"site-layout-background",style:{minHeight:"calc(100vh - 94px - 3rem)",marginTop:".5rem",transition:"margin .2s"},children:t}),Object(r.jsxs)(de.a.Footer,{style:d,children:["Atenea System v",D.version," - 2020\xa9"]})]})]})})},function(e){Object(Ge.a)(n,e);var t=Object(Ye.a)(n);function n(e){var r;return Object(ne.a)(this,n),(r=t.call(this,e)).state={spin:!0,cargo:null},r}return Object(re.a)(n,[{key:"componentDidMount",value:function(){var e=Object(P.a)(B.a.mark((function e(){var t,n,r=this;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Y.a.get(D.TOKEN_STORAGE_KEY)){e.next=5;break}document.location.href=f,e.next=8;break;case 5:return n=new ie(t),e.next=8,ee(!0).then((function(e){"error"===e.status?(Y.a.remove(D.TOKEN_STORAGE_KEY),document.location.href=f):r.setState({spin:!1,cargo:n.decodedToken.cargo})})).catch((function(e){r.setState({spin:!1}),console.log(e),console.log("error de sesion en (PrivateRoutes)")}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(r.jsx)(He,Object(c.a)(Object(c.a)({},this.props),{},{spinLoading:this.state.spin,cargo:this.state.cargo}))}}]),n}(a.Component)),Ue=n(44),Ke=n(154),Je=n(639),We=n(623),Ze=n(191),Xe=n(9),Qe=n.n(Xe),$e=n(634),et=function(e){var t=e.titulo,n=[{breadcrumbName:e.subtitulo}];return Object(r.jsx)($e.a,{className:"site-page-header",title:t,breadcrumb:{routes:n}})},tt=function(){var e=Object(P.a)(B.a.mark((function e(t,n){var r,a,i,o;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.metodo,a=n.page,i=n.limit,o=n.idFiltro,e.abrupt("return",Q({url:"empleados",method:"GET",params:{metodo:r,page:a,limit:i,idFiltro:o}},t));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),nt=function(){var e=Object(P.a)(B.a.mark((function e(t,n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Q({url:"empleados/buscar",method:"GET",params:{value:t,field:n}},!0));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),rt=function(){var e=Object(P.a)(B.a.mark((function e(t,n){var r,a,i,o,c,s,l,d,u,b,f,j,h,p;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.id,a=n.metodo,i=n.cargo,o=n.fecha_baja,c=n.estado_empresa,s=n.gestor,l=n.auditor,d=n.negocio,u=n.subNegocio,b=n.columnas,f=n.tecnicos,j=n.password,h=n.newPassword1,p=n.newPassword2,e.abrupt("return",Q({url:"empleados",method:"PATCH",data:{id:r,metodo:a,cargo:i,fecha_baja:o,estado_empresa:c,gestor:s,auditor:l,negocio:d,subNegocio:u,columnas:b,tecnicos:f,password:j,newPassword1:h,newPassword2:p}},t));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),at=function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Q({url:"empleados",method:"POST",data:t},!0));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),it=function(){var e=Object(P.a)(B.a.mark((function e(t,n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Q({url:"empleados/"+t,method:"PUT",data:n},!0));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ot="perfilUsuario",ct="listaTodo",st="listaTecnicosGlobal",lt="listaGestores",dt="listaAuditores",ut="obtenerColumnas",bt="resetPassword",ft="cerrarSesion",jt="actualizarPermisos",ht="activarCuenta",pt="editarEstadoEmpresa",Ot="actualizarGestor",gt="actualizarAuditor",xt="actualizarNegocio",mt="actualizarSubNegocio",vt="actualizarColumnasGestor",_t="actualizarContrase\xf1a",wt="listaTodo",yt="listaNombres",St="subirData",Ct="comprobarInfancias",kt="actualizarLiquidadas",It="cruzarData",At="obtenerOrdenesPendientes",Tt="obtenerOrdenesLiquidadas",Et="obtenerOrdenesAnuladas",Dt="obtenerOrdenesOtrasBandejas",Nt="exportarPendientes",Rt="exportarLiquidadas",Mt="exportarPendientesGestor",qt="obtenerOrdenesPendientesGestor",Ft="buscarReiterada",Lt="buscarInfancia",zt="buscarRegistro",Bt="obtenerDetalleOrden",Pt="agendarOrden",Gt="agendarOrdenGestor",Yt="asignarOrden",Ht="actualizarEstado",Vt="agregarObservacion",Ut="listarTodo",Kt="listarGestor",Jt=["https://res.cloudinary.com/liteyca/image/upload/v1613847830/avatars/daniel_fbzpxm.jpg","https://res.cloudinary.com/liteyca/image/upload/v1613847803/avatars/stevie_g4dcxw.jpg","https://res.cloudinary.com/liteyca/image/upload/v1613847793/avatars/veronika_ydt9xq.jpg","https://res.cloudinary.com/liteyca/image/upload/v1613847792/avatars/nan_ng0uzp.jpg","https://res.cloudinary.com/liteyca/image/upload/v1613847790/avatars/justen_oprd2m.jpg","https://res.cloudinary.com/liteyca/image/upload/v1613847788/avatars/jenny_goini9.jpg","https://res.cloudinary.com/liteyca/image/upload/v1613847786/avatars/elyse_tqzbdt.png","https://res.cloudinary.com/liteyca/image/upload/v1613847983/avatars/matthew_wwdp4r.png","https://res.cloudinary.com/liteyca/image/upload/v1613847771/avatars/elliot_dpwphr.jpg"],Wt=Ke.a.Option;var Zt=[{path:j,exact:!0,component:function(){var e=Object(a.useState)(!1),t=Object(I.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)(!1),s=Object(I.a)(o,2),l=s[0],d=s[1],u=Object(a.useState)(!1),b=Object(I.a)(u,2),f=b[0],j=b[1],h=Object(a.useState)({}),p=Object(I.a)(h,2),O=p[0],g=p[1],x=Object(a.useState)(null),m=Object(I.a)(x,2),v=m[0],_=m[1],w=Object(a.useState)(null),y=Object(I.a)(w,2),S=y[0],C=y[1],k=Object(a.useState)(null),A=Object(I.a)(k,2),E=A[0],D=A[1];function N(){return(N=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.next=3,tt(!0,{metodo:ot}).then((function(e){var t=e.data;g(t||{})})).catch((function(e){return console.log(e)})).finally((function(){return i(!1)}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){return(L=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O._id){e.next=7;break}return d(!0),e.next=4,it(O._id,O).catch((function(e){return console.log(e)})).finally((function(){return d(!1)}));case 4:return e.abrupt("return",e.sent);case 7:F.a.warn("No se encontr\xf3 el id del usuario.",{position:"top-right"});case 8:case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(){return(z=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O._id){e.next=7;break}return j(!0),e.next=4,rt(!0,{id:O._id,metodo:_t,password:v,newPassword1:S,newPassword2:E}).catch((function(e){return console.log(e)})).finally((function(){Y(),j(!1)}));case 4:return e.abrupt("return",e.sent);case 7:F.a.warn("No se encontr\xf3 el id del usuario.",{position:"top-right"});case 8:case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){!function(){N.apply(this,arguments)}()}),[]);var G=function(e,t){g(Object(c.a)(Object(c.a)({},O),{},Object(Ue.a)({},e,t)))},Y=function(){_(null),C(null),D(null)};return Object(r.jsxs)("div",{children:[Object(r.jsx)(et,{titulo:"Datos de Usuario",subtitulo:"Perfil"}),Object(r.jsx)(q,{children:n?Object(r.jsx)("div",{style:{margin:"2rem",justifyContent:"center",display:"flex"},children:Object(r.jsx)(le.a,{spinning:!0,size:"large"})}):Object(r.jsxs)("div",{style:{margin:"1rem .5rem"},children:[Object(r.jsx)("h3",{children:"Editar Datos Personales:"}),Object(r.jsxs)(R.a,{style:{margin:"1rem 0"},children:[Object(r.jsx)(M.a,{sm:12,children:Object(r.jsxs)(Je.b,{direction:"vertical",children:[Object(r.jsx)(V.a,{addonBefore:"Nombre:",placeholder:"Nombre",style:{width:"400px"},value:O.nombre?O.nombre:null,onChange:function(e){return G("nombre",e.currentTarget.value)}}),Object(r.jsx)(V.a,{addonBefore:"Apellidos:",placeholder:"Apellidos",style:{width:"400px",marginBottom:".5rem"},value:O.apellidos?O.apellidos:null,onChange:function(e){return G("apellidos",e.currentTarget.value)}}),Object(r.jsx)(V.a,{addonBefore:"Correo:",placeholder:"Correo",style:{width:"400px",marginBottom:".5rem"},value:O.usuario&&O.usuario.email?O.usuario.email:null,onChange:function(e){return g(Object(c.a)(Object(c.a)({},O),{},{usuario:Object(c.a)(Object(c.a)({},O.usuario),{},{email:e.target.value})}))}}),Object(r.jsx)(V.a,{onChange:function(e){return G("nacionalidad",e.currentTarget.value)},value:O.nacionalidad?O.nacionalidad:null,addonBefore:"Nacionalidad",placeholder:"Nacionalidad",style:{width:"400px"}})]})}),Object(r.jsx)(M.a,{sm:12,children:Object(r.jsxs)(Je.b,{direction:"vertical",children:[Object(r.jsx)("span",{children:"Fecha de Nacimiento:"}),Object(r.jsx)(We.a,{placeholder:"Fecha de Nacimiento",style:{width:"400px"},value:O.fecha_nacimiento?Qe()(O.fecha_nacimiento):null,onChange:function(e,t){return G("fecha_nacimiento",t)}}),Object(r.jsx)("span",{children:"Tipo de Documento:"}),Object(r.jsxs)(Ke.a,{onChange:function(e){return G("tipo_documento",e)},value:O.tipo_documento?O.tipo_documento:null,style:{width:"400px"},placeholder:"Seleccionar tipo de Documento",children:[Object(r.jsx)(Wt,{value:"DNI",children:"DNI"}),Object(r.jsx)(Wt,{value:"Otro",children:"Otros"})]}),Object(r.jsx)(V.a,{onChange:function(e){return G("numero_documento",e.currentTarget.value)},value:O.numero_documento?O.numero_documento:null,addonBefore:"N\xfamero de Documento",placeholder:"Numero de Documento",style:{width:"400px"}})]})})]}),Object(r.jsxs)(R.a,{style:{marginBottom:"3rem"},children:[Object(r.jsx)("span",{children:"Imagen de Perfil:"}),Object(r.jsx)("br",{}),Object(r.jsx)(Ze.a.Group,{value:O.usuario&&O.usuario.imagen?O.usuario.imagen:null,onChange:function(e){return g(Object(c.a)(Object(c.a)({},O),{},{usuario:Object(c.a)(Object(c.a)({},O.usuario),{},{imagen:e.target.value})}))},children:Jt.map((function(e,t){return Object(r.jsxs)(Ze.a,{value:e,style:{margin:".5rem"},children:[Object(r.jsx)(Fe.a,{size:{xs:20,sm:28,md:36,lg:60,xl:76,xxl:90},src:Object(r.jsx)(T.a,{src:e})}),","]},t)}))})]}),Object(r.jsx)(U.a,{onClick:function(){return L.apply(this,arguments)},type:"primary",loading:l,children:"Guardar"})]})}),Object(r.jsxs)(q,{children:[Object(r.jsxs)("div",{style:{margin:"1rem .5rem"},children:[Object(r.jsx)("h3",{children:"Cambiar Constrase\xf1a:"}),Object(r.jsxs)(Je.b,{direction:"vertical",children:[Object(r.jsx)("span",{children:"Contrase\xf1a actual:"}),Object(r.jsx)(V.a.Password,{required:!0,style:{width:300},onChange:function(e){return _(e.currentTarget.value)},value:v}),Object(r.jsx)("br",{}),Object(r.jsx)("span",{children:"Nueva contrase\xf1a:"}),Object(r.jsx)(V.a.Password,{required:!0,style:{width:300},onChange:function(e){return C(e.currentTarget.value)},value:S}),Object(r.jsx)("br",{}),Object(r.jsx)("span",{children:"Repetir contrase\xf1a:"}),Object(r.jsx)(V.a.Password,{required:!0,style:{width:300},onChange:function(e){return D(e.currentTarget.value)},value:E}),Object(r.jsx)("br",{})]})]}),Object(r.jsx)(U.a,{style:{marginBottom:"1rem"},type:"primary",onClick:function(){return z.apply(this,arguments)},loading:f,children:"Guardar"})]})]})},nivel:k.todos}],Xt=n(640),Qt=n(627),$t=n(655),en=n(656),tn={success:"#52c41a",error:"#EB2F2F",warning:"#F8C82E",Pendiente:"#EFFF12",Completado:"#9BB6C2",Iniciado:"#5DBE3F",Suspendido:"#ABFFBC",Cancelado:"#80FF80",NoRealizada:"#1414FF"},nn=["Instalaci\xf3n Movistar uno Gpon","Instalaci\xf3n Gpon Movistar Tot","Instalaci\xf3n Migraci\xf3n Gpon","Instalaci\xf3n Migraci\xf3n Gpon MT","Instalaci\xf3n Gpon New","Instalaci\xf3n Migraci\xf3n HFC a Gpon","Instalaci\xf3n Migraci\xf3n HFC a Gpon CC","Instalacion B2B Tradicional GPON"],rn=["Instalaci\xf3n Migraci\xf3n","Instalaci\xf3n Migraci\xf3n Movistar Total","Instalaci\xf3n Movistar Total","Instalaci\xf3n Movistar uno","Instalaci\xf3n CATV","Instalacion B2B Tradicional HFC"],an=["Reparaci\xf3n GPON","Reparaci\xf3n Gpon Movistar Uno","Reparacion Movistar Total Gpon","Reparacion B2B Tradicional GPON"],on=["Reparaci\xf3n Movistar Total","Reparaci\xf3n Movistar uno","Reparaci\xf3n CATV","Reparacion B2B Tradicional HFC"],cn=["Instalaci\xf3n Rutina VA Gpon","Rutina MT GPON MT","Rutina MT GPON MT","Rutina VA GPON MT","Traslado GPON","Instalaci\xf3n rutina MT Gpon","Instalaci\xf3n rutina Bucle Gpon","Traslado GPON Movistar Total","Instalaci\xf3n rutina AT Gpon","Rutina AT GPON MT"],sn=["Instalaci\xf3n Rutina Bucle","Instalaci\xf3n Rutina CATV_AT","Instalaci\xf3n Rutina CATV_VA","Instalaci\xf3n Rutina MT Movistar Total","Traslado HFC","Instalaci\xf3n Rutina VA Movistar Total","Traslado HFC Mov Total","Instalaci\xf3n Rutina AT Movistar Total","Instalaci\xf3n Rutina CATV_MT"],ln={CANCELADO:"Cancelado",COMPLETADO:"Completado",INICIADO:"Iniciado",NO_REALIZADA:"No Realizada",PENDIENTE:"Pendiente",SUSPENDIDO:"Suspendido"},dn=["Baja de Acometida"],un=["Instalacion B2B Tradicional GPON","Instalacion B2B Tradicional HFC","Reparacion B2B Tradicional GPON","Reparacion B2B Tradicional HFC"];var bn=function(e){var t=e.titulo,n=e.ordenes,a=void 0===n?[]:n;return Object(r.jsxs)(R.a,{style:{padding:".5rem 0"},children:[Object(r.jsx)(M.a,{sm:24,children:Object(r.jsx)("h4",{children:t})}),Object(r.jsx)(M.a,{sm:12,children:Object(r.jsx)(Qt.a,{title:"Liquidadas",value:a&&a.length>0?a.filter((function(e){return e&&e.estado_toa===ln.COMPLETADO})).length:0,valueStyle:{color:tn.success},prefix:Object(r.jsx)($t.a,{})})}),Object(r.jsx)(M.a,{sm:12,children:Object(r.jsx)(Qt.a,{title:"Pendientes",value:a&&a.length>0?a.filter((function(e){return e&&e.estado_toa===ln.PENDIENTE})).length:0,valueStyle:{color:tn.warning},prefix:Object(r.jsx)(en.a,{})})})]})},fn="averiashfc",jn="altashfc",hn="rutinas",pn="bajas",On="gpon",gn="hfc",xn=[{text:"Averia",value:"averias"},{text:"Altas",value:"altas"}],mn=[{text:"GPON",value:On},{text:"HFC",value:gn},{text:"COBRE",value:"cobre"},{text:"CRITICOS",value:"criticos"},{text:"EMPRESAS",value:"empresas"}],vn=["MA","SM","SJ","PN","MR","SV","VN","B1","B3","B2","BE","GC","GM","GR","EH","PS","P2","GU","GX","GZ","TJ","TO","D4","D5","P0","PB","SU","W5","W6","BD","B0","B5","B4","PF","B7","BZ","E1","BO","BG","BW","BK","PD","BF","B9","B6","E3","E2","B8","B3","BX","P8","ANAI","ANBA","ANCA","ANCB","ANCC","ANCD","ANCH","ANCM","ANCO","ANCP","ANCQ","ANCR","ANEM","ANEP","ANHL","ANHM","ANHR","ANHU","ANMA","ANMC","ANMO","ANNE","ANPO","ANRE","ANSA","ANSI","ANSJ","ANSM","ANSN","ANTI","ANYC","ANYU","MA","MAU2","MAU3","PIEA","PILA","PILO","PIMA","PINE","PING","PIQU","PISJ","PISU","PITA","SJ","SJU1","SJU2","SJU3","TUCC","TUCO","TUPP","TUPS","TUTU","TUZA","TUZO"],_n=n(59),wn=n(101),yn=n(70);var Sn=function(e){var t=e.data,n=void 0===t?[]:t,a=e.field,i=e.height,o=e.paddinLeft,c=void 0===o?150:o;return!n||n.length<1?Object(r.jsx)("div",{style:{width:"100%",height:i,display:"flex",alignItems:"center",justifyContent:"center"},children:Object(r.jsx)(wn.a,{})}):Object(r.jsxs)(_n.Chart,{data:n,height:i,padding:[0,50,10,c],autoFit:!0,children:[Object(r.jsx)(_n.Coordinate,{transpose:!0}),Object(r.jsx)(_n.Axis,{name:"nombre"}),Object(r.jsx)(_n.Axis,{name:"cantidad",visible:!1}),Object(r.jsx)(yn.a,{}),Object(r.jsx)(_n.Interval,{shape:"rect",position:"nombre*cantidad*".concat(a),animate:{enter:{duration:500}},label:"cantidad",tooltip:["".concat(a,"*cantidad")]})]})},Cn=n(327),kn=n(631),In=n(624),An=Le.a.Text;var Tn=function(e){var t=e.ordenes,n=void 0===t?[]:t,a=e.visible,i=e.abrir,o=e.horas,c=e.devolucion,s=void 0!==c&&c,l=[{title:"#",width:40,align:"center",render:function(e,t,n){return n+1}},{title:"Requerimiento",dataIndex:"requerimiento",width:115,align:"center",render:function(e){return Object(r.jsx)(An,{copyable:!0,children:e})}},{title:"Cliente",dataIndex:"codigo_cliente",width:100,align:"center",render:function(e){return Object(r.jsx)(An,{copyable:!0,children:e})}},{title:"Gestor",dataIndex:"gestor",width:180,ellipsis:!0,render:function(e){return e&&e.nombre?Object(r.jsx)(An,{children:"".concat(e.nombre," ").concat(e.apellidos)}):"-"}},{title:"Tecnico",dataIndex:"tecnico",width:180,ellipsis:!0,render:function(e){return e&&e.nombre?Object(r.jsx)(An,{children:"".concat(e.nombre," ").concat(e.apellidos)}):"-"}},{title:"Carnet",dataIndex:"carnet",width:80,align:"center"},{title:"Actividad",dataIndex:"subtipo_actividad",width:220},{title:"Tipo de Cita",dataIndex:"tipo_cita",width:150}],d=[{title:"Fecha Registro",dataIndex:"fecha_registro_legados",width:120,align:"center",render:function(e){return Qe()(e).format("DD/MM/YY HH:mm")}},{title:"Fecha Liquidado",dataIndex:"fecha_pre_no_realizado",width:120,align:"center",render:function(e){return Qe()(e).format("DD/MM/YY HH:mm")}},{title:"Horas",dataIndex:"fecha_registro_legados",width:60,align:"center",render:function(e,t){var n=Qe()(t.fecha_pre_no_realizado).diff(e,"hour");return n<o?Object(r.jsx)(Cn.a,{color:"success",children:n}):Object(r.jsx)(Cn.a,{color:"error",children:n})}}],u=[{title:"Observacion TOA",dataIndex:"observacion_toa",width:450}];return Object(r.jsx)(kn.a,{title:"Lista de Ordenes",visible:a,onOk:i,onCancel:i,footer:!1,width:"85vw",centered:!0,children:Object(r.jsx)(In.a,{rowKey:"requerimiento",dataSource:n,columns:function(){var e=l;return s?e.push.apply(e,u):e.push.apply(e,d),e}(),pagination:{pageSize:50},size:"small",bordered:!0,scroll:{y:"60vh",x:"80vw"}})})};var En=function(e){var t=e.data,n=void 0===t?[]:t,i=e.tipo,o=void 0===i||i,c=Object(a.useState)(!1),s=Object(I.a)(c,2),l=s[0],d=s[1],u=Object(a.useState)([]),b=Object(I.a)(u,2),f=b[0],j=b[1],h=function(){return d(!l)};return!n||n.length<1?Object(r.jsx)("div",{style:{width:"100%",height:500,display:"flex",alignItems:"center",justifyContent:"center"},children:Object(r.jsx)(wn.a,{})}):Object(r.jsxs)(_n.Chart,{data:n,height:500,padding:[0,50,20,o?150:190],onClick:function(e){return function(e){e&&e.data&&(j(e.data.ordenes),h())}(e.data)},autoFit:!0,children:[Object(r.jsx)(_n.Coordinate,{transpose:!0}),Object(r.jsx)(_n.Axis,{name:"cantidad"}),Object(r.jsx)(_n.Axis,{name:"cantidad",visible:!1}),Object(r.jsx)(_n.Interval,{adjust:[{type:"stack"}],color:{fields:["estado"],values:["#ff764a","#ffa600"]},position:"nombre*cantidad*".concat(o?"gestor":"motivo"),animate:{enter:{duration:500}},label:["total",function(e){return{content:e||null}}],tooltip:["".concat(o?"gestor":"motivo","*estado*cantidad")]}),Object(r.jsx)(Tn,{ordenes:f,abrir:h,visible:l,horas:72,devolucion:!0})]})};var Dn=function(e){var t=e.ordenes,n=void 0===t?[]:t,i=(e.hora,Object(a.useState)([])),o=Object(I.a)(i,2),c=o[0],s=o[1],l=Object(a.useState)([]),d=Object(I.a)(l,2),u=d[0],b=d[1],f=Object(a.useState)(!0),j=Object(I.a)(f,2),h=j[0],p=j[1];function O(){if(n&&n.length>0){var e=[].concat(Object(ue.a)(rn),Object(ue.a)(nn),Object(ue.a)(sn),Object(ue.a)(rn)),t=n.filter((function(t){return t&&t.gestor&&[ln.CANCELADO,ln.NO_REALIZADA].includes(t.estado)&&e.includes(t.subtipo_actividad)}));if(t.length>0){var r=[],a=[],i=[];t.forEach((function(e){e&&e.gestor&&!r.includes(e.gestor.nombre)&&(r.push(e.gestor.nombre),a.push("".concat(e.gestor.nombre," ").concat(e.gestor.apellidos)))})),r.forEach((function(e,n){i.push({nombre:e,gestor:a[n],estado:ln.CANCELADO,total:null,ordenes:t.filter((function(t){return t&&t.gestor&&t.gestor.nombre===e&&t.estado_toa===ln.CANCELADO})),cantidad:t.filter((function(t){return t&&t.gestor&&t.gestor.nombre===e&&t.estado_toa===ln.CANCELADO})).length},{nombre:e,gestor:a[n],estado:ln.NO_REALIZADA,total:t.filter((function(t){return t&&t.gestor&&t.gestor.nombre===e})).length,ordenes:t.filter((function(t){return t&&t.gestor&&t.gestor.nombre===e&&t.estado_toa===ln.NO_REALIZADA})),cantidad:t.filter((function(t){return t&&t.gestor&&t.gestor.nombre===e&&t.estado_toa===ln.NO_REALIZADA})).length})})),b(i)}else b([])}}function g(){if(n&&n.length>0){var e=[].concat(Object(ue.a)(rn),Object(ue.a)(nn),Object(ue.a)(sn),Object(ue.a)(rn)),t=n.filter((function(t){return t&&t.gestor&&[ln.CANCELADO,ln.NO_REALIZADA].includes(t.estado)&&e.includes(t.subtipo_actividad)}));if(t.length>0){var r=[],a=[];t.forEach((function(e){e&&e.gestor&&!r.includes(e.motivo_no_realizado)&&r.push(e.motivo_no_realizado)})),r.forEach((function(e,n){a.push({nombre:String(e).substring(9,e.length).replace("-",""),motivo:e,estado:ln.CANCELADO,total:null,ordenes:t.filter((function(t){return t&&t.motivo_no_realizado===e&&t.estado_toa===ln.CANCELADO})),cantidad:t.filter((function(t){return t&&t.motivo_no_realizado===e&&t.estado_toa===ln.CANCELADO})).length},{nombre:String(e).substring(9,e.length).replace("-",""),motivo:e,estado:ln.NO_REALIZADA,total:t.filter((function(t){return t&&t.motivo_no_realizado===e})).length,ordenes:t.filter((function(t){return t&&t.motivo_no_realizado===e&&t.estado_toa===ln.NO_REALIZADA})),cantidad:t.filter((function(t){return t&&t.motivo_no_realizado===e&&t.estado_toa===ln.NO_REALIZADA})).length})})),b(a)}else b([])}}return Object(a.useEffect)((function(){!function(){if(n&&n.length>0){var e=n.filter((function(e){return e&&e.gestor_liquidado_toa&&e.estado===ln.COMPLETADO}));if(e.length>0){var t=[],r=[],a=[];e.forEach((function(e){e&&e.gestor_liquidado_toa&&!t.includes(e.gestor_liquidado_toa.nombre)&&(t.push(e.gestor_liquidado_toa.nombre),r.push("".concat(e.gestor_liquidado_toa.nombre," ").concat(e.gestor_liquidado_toa.apellidos)))})),t.forEach((function(t,n){a.push({nombre:t,gestor:r[n],ordenes:e.filter((function(e){return e&&e.gestor_liquidado_toa&&e.gestor_liquidado_toa.nombre===t})),cantidad:e.filter((function(e){return e&&e.gestor_liquidado_toa&&e.gestor_liquidado_toa.nombre===t})).length})})),s(a)}else s([])}}(),h?O():g()}),[n]),Object(a.useEffect)((function(){h?O():g()}),[h]),Object(r.jsxs)("div",{children:[Object(r.jsxs)(R.a,{children:[Object(r.jsx)(M.a,{sm:12,children:Object(r.jsx)(q,{children:Object(r.jsx)(bn,{titulo:"Averias",ordenes:n.filter((function(e){return e&&e.tipo===fn}))})})}),Object(r.jsx)(M.a,{sm:12,children:Object(r.jsx)(q,{children:Object(r.jsx)(bn,{titulo:"Altas",ordenes:n.filter((function(e){return e&&e.tipo===jn&&!dn.includes(e.subtipo_actividad)}))})})})]}),Object(r.jsx)(q,{children:Object(r.jsxs)(R.a,{children:[Object(r.jsx)(Je.b,{direction:"vertical"}),Object(r.jsx)(M.a,{sm:12,children:Object(r.jsxs)("div",{style:{marginTop:".5rem",marginBottom:"1rem"},children:[Object(r.jsx)("h3",{children:"Indicadores de Liquidaci\xf3n (Gestor)"}),Object(r.jsx)(Sn,{data:c,field:"gestor",height:500})]})}),Object(r.jsx)(M.a,{sm:12,children:Object(r.jsxs)("div",{style:{marginTop:".5rem",marginBottom:"1rem"},children:[Object(r.jsxs)("h3",{children:["Indicadores de Devoluci\xf3n (Altas/Rutinas) - "," ",Object(r.jsx)(Xt.a,{size:"small",checkedChildren:"Gestor",unCheckedChildren:"Motivo",onChange:function(e){return p(e)},checked:h})]}),Object(r.jsx)(En,{data:u,tipo:h})]})})]})})]})},Nn=n(625),Rn=n(659),Mn=n(660),qn=n(657),Fn=n(658),Ln=n(155),zn=n.n(Ln);function Bn(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Pn(e){return[{title:Bn(e),dataIndex:e,ellipsis:{showTitle:!1},width:200,align:"left",render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e,children:e})}},{title:"Completado",dataIndex:"completado",align:"center",sorter:function(e,t){return e.completado<t.completado?-1:e.completado>t.completado?1:0},render:function(e){return Object(r.jsx)(Cn.a,{icon:Object(r.jsx)($t.a,{}),color:"#8994e9",children:e||0})}},{title:"Iniciado",dataIndex:"iniciado",align:"center",sorter:function(e,t){return e.iniciado<t.iniciado?-1:e.iniciado>t.iniciado?1:0},render:function(e){return Object(r.jsx)(Cn.a,{icon:Object(r.jsx)(qn.a,{}),color:"#66CC33",children:e||0})}},{title:"No Realizada",dataIndex:"no_realizada",align:"center",sorter:function(e,t){return e.no_realizada<t.no_realizada?-1:e.no_realizada>t.no_realizada?1:0},render:function(e){return e||0}},{title:"Pendiente",dataIndex:"pendiente",align:"center",sorter:function(e,t){return e.pendiente<t.pendiente?-1:e.pendiente>t.pendiente?1:0},render:function(e){return e||0}},{title:"Suspendido",dataIndex:"suspendido",align:"center",sorter:function(e,t){return e.suspendido<t.suspendido?-1:e.suspendido>t.suspendido?1:0},render:function(e){return e||0}},{title:"Cancelado",dataIndex:"cancelado",align:"center",sorter:function(e,t){return e.cancelado<t.cancelado?-1:e.cancelado>t.cancelado?1:0},render:function(e){return e||0}},{title:"Total",dataIndex:"total",align:"center",sorter:function(e,t){return e.total<t.total?-1:e.total>t.total?1:0},render:function(e){return e?Object(r.jsx)(Cn.a,{color:"#999999",children:Object(r.jsx)("strong",{children:e||0})}):0}}]}function Gn(e){var t=0,n=0,a=0,i=0,o=0,c=0,s=0;return e.forEach((function(e){var r=e.completado,l=e.iniciado,d=e.no_realizada,u=e.pendiente,b=e.suspendido,f=e.cancelado,j=e.total;t+=r,n+=l,a+=d,i+=u,o+=b,c+=f,s+=j})),Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)(In.a.Summary.Row,{style:{backgroundColor:"#F7F7F7"},children:[Object(r.jsx)(In.a.Summary.Cell,{children:Object(r.jsx)("strong",{children:"Total"})}),Object(r.jsx)(In.a.Summary.Cell,{align:"center",children:Object(r.jsx)(Cn.a,{icon:Object(r.jsx)($t.a,{}),color:"#8994e9",children:Object(r.jsx)("strong",{children:t})})}),Object(r.jsx)(In.a.Summary.Cell,{align:"center",children:Object(r.jsx)(Cn.a,{icon:Object(r.jsx)(Fn.a,{}),color:"#66CC33",children:n})}),Object(r.jsx)(In.a.Summary.Cell,{align:"center",children:Object(r.jsx)(zn.a,{children:a})}),Object(r.jsx)(In.a.Summary.Cell,{align:"center",children:Object(r.jsx)(zn.a,{children:i})}),Object(r.jsx)(In.a.Summary.Cell,{align:"center",children:Object(r.jsx)(zn.a,{children:o})}),Object(r.jsx)(In.a.Summary.Cell,{align:"center",children:Object(r.jsx)(zn.a,{children:c})}),Object(r.jsx)(In.a.Summary.Cell,{align:"center",children:Object(r.jsx)(Cn.a,{color:"#999999",children:Object(r.jsx)("strong",{children:s})})})]})})}function Yn(e){var t=e.data,n=void 0===t?[]:t,a=e.field;return!n||n.length<1?Object(r.jsx)("div",{style:{width:"100%",height:250,display:"flex",alignItems:"center",justifyContent:"center"},children:Object(r.jsx)(le.a,{spinning:!0,tip:"Cargando...",size:"large"})}):Object(r.jsxs)(_n.Chart,{height:250,padding:[30,20,90,40],data:n,autoFit:!0,filter:[["ordenes",function(e){return null!=e}]],children:[Object(r.jsx)(_n.Interval,{adjust:[{type:"dodge",marginRatio:0}],color:{fields:["estado"],callback:function(e){return"Pendiente"===(t=e)?tn.Pendiente:"Completado"===t?tn.Completado:"Iniciado"===t?tn.Iniciado:"Suspendido"===t?tn.Suspendido:"Cancelado"===t?tn.Cancelado:"No Realizada"===t?tn.NoRealizada:void 0;var t}},position:"".concat(a,"*ordenes"),label:{fields:["ordenes","estado"],callback:function(e,t){return"Completado"===t&&e>0?{content:e,style:{fill:"red",fontSize:15,fontWeight:"bold"}}:{content:e}}}}),Object(r.jsx)(_n.Tooltip,{shared:!0}),Object(r.jsx)(_n.Interaction,{type:"active-region"})]})}var Hn=function(e){var t=e.dataSource,n=void 0===t?[]:t,a=e.dataChart,i=void 0===a?[]:a,o=e.tipo;return n.length<=0||i<=0?Object(r.jsx)("div",{children:Object(r.jsx)(wn.a,{style:{margin:"5rem"}})}):Object(r.jsxs)(R.a,{style:{marginTop:"2rem",marginBottom:"1rem"},children:[Object(r.jsx)(M.a,{sm:24,children:Object(r.jsx)(Yn,{data:i,field:o})}),Object(r.jsx)(M.a,{sm:24,children:Object(r.jsx)(R.a,{style:{margin:"1rem 0"},children:Object(r.jsx)(In.a,{style:{background:"white !important"},rowKey:"key",columns:Pn(o),dataSource:n,size:"small",pagination:!1,summary:Gn})})})]})};function Vn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];if(e&&0!==e.length){var n=[],r=[];return e.forEach((function(e){return t.includes(e.bucket)?null:t.push(e.bucket)})),e.forEach((function(e){return n.includes(e.estado)?null:n.push(e.estado)})),t.forEach((function(t){n.forEach((function(n){var a=e.filter((function(e){return e.bucket===t&&e.estado===n})).length;r.push({bucket:String(t).substring(6),estado:n,ordenes:a})}))})),{ordenes:r,buckets:t,estados:n}}return{ordenes:[],buckets:t,estados:[]}}function Un(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];if(e&&0!==e.length){var n=[],r=[];return e.forEach((function(e){e.contrata&&e.contrata.nombre&&(t.includes(e.contrata.nombre)||t.push(e.contrata.nombre))})),e.forEach((function(e){return n.includes(e.estado)?null:n.push(e.estado)})),t.forEach((function(t){n.forEach((function(n){var a=e.filter((function(e){return!(!e.contrata||!e.contrata.nombre)&&(e.contrata.nombre===t&&e.estado===n)})).length;r.push({contrata:t,estado:n,ordenes:a})}))})),{ordenes:r,contratas:t}}return{ordenes:[],contratas:t}}function Kn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];if(e&&0!==e.length){var n=[],r=[];return e.forEach((function(e){e.gestor&&e.gestor.nombre&&(t.includes(e.gestor.nombre)||t.push(e.gestor.nombre))})),e.forEach((function(e){return n.includes(e.estado)?null:n.push(e.estado)})),t.forEach((function(t){n.forEach((function(n){var a=e.filter((function(e){return!(!e.gestor||!e.gestor.nombre)&&(e.gestor.nombre===t&&e.estado===n)})).length;r.push({gestor:t,estado:n,ordenes:a})}))})),{ordenes:r,gestores:t}}return{ordenes:[],gestores:t}}function Jn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(e&&e.length>0){var n=[],r=[];return e.forEach((function(e){n.includes(e[t])||n.push(e[t])})),n.filter((function(e){return e})).forEach((function(n,a){var i,o;r.length<=0?r=[(i={key:a},Object(Ue.a)(i,t,n),Object(Ue.a)(i,"completado",e.filter((function(e){return e.estado===ln.COMPLETADO&&n===e[t]})).length),Object(Ue.a)(i,"iniciado",e.filter((function(e){return e.estado===ln.INICIADO&&n===e[t]})).length),Object(Ue.a)(i,"no_realizada",e.filter((function(e){return e.estado===ln.NO_REALIZADA&&n===e[t]})).length),Object(Ue.a)(i,"pendiente",e.filter((function(e){return e.estado===ln.PENDIENTE&&n===e[t]})).length),Object(Ue.a)(i,"suspendido",e.filter((function(e){return e.estado===ln.SUSPENDIDO&&n===e[t]})).length),Object(Ue.a)(i,"cancelado",e.filter((function(e){return e.estado===ln.CANCELADO&&n===e[t]})).length),Object(Ue.a)(i,"total",e.filter((function(e){return n===e[t]})).length),i)]:r.push((o={key:a},Object(Ue.a)(o,t,n),Object(Ue.a)(o,"completado",e.filter((function(e){return e.estado===ln.COMPLETADO&&n===e[t]})).length),Object(Ue.a)(o,"iniciado",e.filter((function(e){return e.estado===ln.INICIADO&&n===e[t]})).length),Object(Ue.a)(o,"no_realizada",e.filter((function(e){return e.estado===ln.NO_REALIZADA&&n===e[t]})).length),Object(Ue.a)(o,"pendiente",e.filter((function(e){return e.estado===ln.PENDIENTE&&n===e[t]})).length),Object(Ue.a)(o,"suspendido",e.filter((function(e){return e.estado===ln.SUSPENDIDO&&n===e[t]})).length),Object(Ue.a)(o,"cancelado",e.filter((function(e){return e.estado===ln.CANCELADO&&n===e[t]})).length),Object(Ue.a)(o,"total",e.filter((function(e){return n===e[t]})).length),o))})),r}return[]}function Wn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(e&&e.length>0){var n=[],r=[];return e.forEach((function(e){n.includes(e[t].nombre)||n.push(e[t].nombre)})),n.filter((function(e){return e})).forEach((function(n,a){var i,o;r.length<=0?r=[(i={key:a},Object(Ue.a)(i,t,n),Object(Ue.a)(i,"completado",e.filter((function(e){return e.estado===ln.COMPLETADO&&n===e[t].nombre})).length),Object(Ue.a)(i,"iniciado",e.filter((function(e){return e.estado===ln.INICIADO&&n===e[t].nombre})).length),Object(Ue.a)(i,"no_realizada",e.filter((function(e){return e.estado===ln.NO_REALIZADA&&n===e[t].nombre})).length),Object(Ue.a)(i,"pendiente",e.filter((function(e){return e.estado===ln.PENDIENTE&&n===e[t].nombre})).length),Object(Ue.a)(i,"suspendido",e.filter((function(e){return e.estado===ln.SUSPENDIDO&&n===e[t].nombre})).length),Object(Ue.a)(i,"cancelado",e.filter((function(e){return e.estado===ln.CANCELADO&&n===e[t].nombre})).length),Object(Ue.a)(i,"total",e.filter((function(e){return n===e[t].nombre})).length),i)]:r.push((o={key:a},Object(Ue.a)(o,t,n),Object(Ue.a)(o,"completado",e.filter((function(e){return e.estado===ln.COMPLETADO&&n===e[t].nombre})).length),Object(Ue.a)(o,"iniciado",e.filter((function(e){return e.estado===ln.INICIADO&&n===e[t].nombre})).length),Object(Ue.a)(o,"no_realizada",e.filter((function(e){return e.estado===ln.NO_REALIZADA&&n===e[t].nombre})).length),Object(Ue.a)(o,"pendiente",e.filter((function(e){return e.estado===ln.PENDIENTE&&n===e[t].nombre})).length),Object(Ue.a)(o,"suspendido",e.filter((function(e){return e.estado===ln.SUSPENDIDO&&n===e[t].nombre})).length),Object(Ue.a)(o,"cancelado",e.filter((function(e){return e.estado===ln.CANCELADO&&n===e[t].nombre})).length),Object(Ue.a)(o,"total",e.filter((function(e){return n===e[t].nombre})).length),o))})),r}return[]}var Zn=Ke.a.Option,Xn=Le.a.Text,Qn=Nn.a.TabPane;var $n=function(e){var t=e.hora,n=e.ordenes,i=void 0===n?[]:n,o=Object(a.useState)(fn),c=Object(I.a)(o,2),s=c[0],l=c[1],d=Object(a.useState)(gn),u=Object(I.a)(d,2),b=u[0],f=u[1],j=Object(a.useState)([]),h=Object(I.a)(j,2),p=h[0],O=h[1];function g(){return(g=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i&&i.length>0)){e.next=4;break}return e.abrupt("return",new Promise((function(e){return e(x(i))})).then((function(e){return m(e)})).then((function(e){return O(e)})).catch((function(e){return console.log(e)})));case 4:return O([]),e.abrupt("return");case 6:case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!e&&e.length<1)return[];var t=[].concat(Object(ue.a)(on),Object(ue.a)(an)),n=[].concat(Object(ue.a)(rn),Object(ue.a)(nn)),r=[].concat(Object(ue.a)(sn),Object(ue.a)(cn));return s===fn?e.filter((function(e){return e&&e.subtipo_actividad&&t.includes(e.subtipo_actividad)})):s===jn?e.filter((function(e){return e&&e.subtipo_actividad&&n.includes(e.subtipo_actividad)})):s===hn?e.filter((function(e){return e&&e.subtipo_actividad&&r.includes(e.subtipo_actividad)})):s===pn?e.filter((function(e){return e&&e.subtipo_actividad&&dn.includes(e.subtipo_actividad)})):e}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!e&&e.length<1)return[];var t=[].concat(Object(ue.a)(on),Object(ue.a)(rn),Object(ue.a)(sn)),n=[].concat(Object(ue.a)(an),Object(ue.a)(nn),Object(ue.a)(cn));return b===gn?e.filter((function(e){return e&&e.subtipo_actividad&&t.includes(e.subtipo_actividad)})):b===On?e.filter((function(e){return e&&e.subtipo_actividad&&n.includes(e.subtipo_actividad)})):e}return Object(a.useEffect)((function(){s===pn&&"Todo"!==b&&f("Todo"),function(){g.apply(this,arguments)}()}),[i,s,b]),Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{style:{marginTop:".5rem"},children:[Object(r.jsxs)("h3",{children:["Indicadores de Actividad - ",t]}),Object(r.jsxs)(R.a,{children:[Object(r.jsxs)(M.a,{sm:7,children:[Object(r.jsx)("span",{children:"Negocio: "}),Object(r.jsxs)(Ke.a,{size:"small",style:{width:"100px",marginLeft:".5rem"},value:s,onChange:function(e){return l(e)},children:[Object(r.jsx)(Zn,{value:fn,children:"Averias"}),Object(r.jsx)(Zn,{value:jn,children:"Altas"}),Object(r.jsx)(Zn,{value:hn,children:"Rutinas"}),Object(r.jsx)(Zn,{value:pn,children:"Bajas"}),Object(r.jsx)(Zn,{value:"Todo",children:"Todo"})]})]}),Object(r.jsxs)(M.a,{sm:7,children:[Object(r.jsx)("span",{children:"Tecnolog\xeda:"}),Object(r.jsxs)(Ke.a,{size:"small",disabled:s===pn,style:{width:"100px",marginLeft:".5rem"},value:b,onChange:function(e){return f(e)},children:[Object(r.jsx)(Zn,{value:gn,children:"HFC"}),Object(r.jsx)(Zn,{value:On,children:"GPON"}),Object(r.jsx)(Zn,{value:"Todo",children:"Todo"})]})]}),Object(r.jsxs)(M.a,{sm:7,children:[Object(r.jsx)("span",{children:"Zona: "}),Object(r.jsx)(Xn,{type:"secondary",children:"LIMA"})]})]})]}),Object(r.jsxs)(Nn.a,{style:{paddingLeft:"1rem"},animated:!1,children:[Object(r.jsx)(Qn,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(Rn.a,{}),"Bucket"]}),children:Object(r.jsx)(Hn,{dataSource:Jn(p,"bucket"),dataChart:Vn(p).ordenes,tipo:"bucket"})},"1"),Object(r.jsx)(Qn,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(Mn.a,{}),"Contrata"]}),children:Object(r.jsx)(Hn,{dataSource:Wn(p.filter((function(e){return e.tecnico&&e.contrata})),"contrata"),dataChart:Un(p.filter((function(e){return e.tecnico&&e.contrata}))).ordenes,tipo:"contrata"})},"2"),Object(r.jsx)(Qn,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(K.a,{}),"Gestor"]}),children:Object(r.jsx)(Hn,{dataSource:Wn(p.filter((function(e){return e.tecnico&&e.gestor})),"gestor"),dataChart:Kn(p.filter((function(e){return e.tecnico&&e.gestor}))).ordenes,tipo:"gestor"})},"3")]})]})},er=n(98),tr=n(322);var nr=function(e){var t=e.hora,n=e.plazo,a=e.vencidas,i=e.porcentaje;return Object(r.jsxs)(M.a,{sm:12,style:{justifyContent:"center",textAlign:"center"},children:[Object(r.jsxs)("h4",{children:["Plazo ",t,"h"]}),Object(r.jsxs)(R.a,{gutter:16,style:{margin:"1rem 0"},children:[Object(r.jsx)(M.a,{sm:12,children:Object(r.jsx)(yn.a,{title:"".concat(n," En plazo / ").concat(a," Vencidas"),children:Object(r.jsx)(tr.a,{format:function(e){return e+"%"},strokeColor:i<50?tn.error:i>=50&&i<70?tn.warning:tn.success,percent:i,strokeWidth:10,width:160,gapDegree:80,trailColor:"#CCCCFF",type:"dashboard",showInfo:!0})})}),Object(r.jsxs)(M.a,{sm:12,children:[Object(r.jsx)(R.a,{style:{marginBottom:".5rem"},children:Object(r.jsx)(Qt.a,{title:"En plazo",value:n,valueStyle:{color:tn.success},prefix:Object(r.jsx)($t.a,{})})}),Object(r.jsx)(R.a,{style:{marginBottom:".5rem"},children:Object(r.jsx)(Qt.a,{title:"Vencidas",value:a,valueStyle:{color:tn.error},prefix:Object(r.jsx)(en.a,{})})})]})]})]})},rr=n(13);function ar(e){var t=e.data,n=void 0===t?[]:t,i=e.paddingLeft,o=e.height,c=Object(a.useState)(!1),s=Object(I.a)(c,2),l=s[0],d=s[1],u=Object(a.useState)(!1),b=Object(I.a)(u,2),f=b[0],j=b[1],h=Object(a.useState)([]),p=Object(I.a)(h,2),O=p[0],g=p[1],x=Object(a.useState)(0),m=Object(I.a)(x,2),v=m[0],_=m[1];Object(a.useEffect)((function(){d(!0),setTimeout((function(){d(!1)}),80)}),[n,f]);var w=function(){return j(!f)},y={"Averias 24h":{title:"Averias 24h",color:rr.green[4]},"Plazo 72h":{title:"Plazo 72h",color:rr.green[4]}},S={plazo:"Plazo",vencido:"Vencido"};return l||!n||n.length<1?Object(r.jsx)("div",{style:{width:"100%",height:o,display:"flex",alignItems:"center",justifyContent:"center"},children:Object(r.jsx)(le.a,{spinning:!0,tip:"Cargando...",size:"large"})}):Object(r.jsxs)(_n.Chart,{autoFit:!0,data:n,height:o,padding:[20,20,20,i],appendPadding:[10],onClick:function(e){return function(e){e&&e.data&&("Plazo 72h"===e.data.indexCode?_(72):_(24),g(e.data.ordenes),w())}(e.data)},children:[Object(r.jsx)(_n.Legend,{visible:!0,itemName:{formatter:function(e,t){return S[e]}}}),Object(r.jsx)(_n.Tooltip,{showMarkers:!1}),Object(r.jsx)(_n.Facet,{fields:["indexCode"],type:"rect",columnTitle:{offsetY:-15,style:{fontSize:14,fontWeight:300,fill:"#505050"},formatter:function(e){return y[e].title}},eachView:function(e,t){e.coordinate().transpose(),0===t.columnIndex?(e.axis("nombre",{tickLine:null,line:null}),e.axis("value",!1)):e.axis(!1);var n=y[t.columnValue].color;e.interval().adjust("stack").position("nombre*value").color("type",[n,"#FFE2DC"]).size(20).label("value*type",(function(e,t){if("vencido"===t)return null;var n=e<30?10:-4;return{content:"".concat(e,"%"),offset:n}})).tooltip("nombre*value*indexCode*type*ordenes",(function(e,t,n,r,a){return{title:e,value:"".concat(r," : ").concat(a.length),name:n}})),e.interaction("element-active")}}),Object(r.jsx)(Tn,{ordenes:O,abrir:w,visible:f,horas:v})]})}var ir=Nn.a.TabPane;var or=function(e){var t=e.ordenes,n=void 0===t?[]:t,i=e.hora,o=Object(a.useState)({plazo:[],vencidas:[],porcentaje:0}),c=Object(I.a)(o,2),s=c[0],l=c[1],d=Object(a.useState)({plazo:[],vencidas:[],porcentaje:0}),u=Object(I.a)(d,2),b=u[0],f=u[1],j=Object(a.useState)(!1),h=Object(I.a)(j,2),p=h[0],O=h[1],g=Object(a.useState)([]),x=Object(I.a)(g,2),m=x[0],v=x[1],_=Object(a.useState)([]),w=Object(I.a)(_,2),y=w[0],S=w[1],C=Object(a.useState)([]),k=Object(I.a)(C,2),A=k[0],T=k[1];function E(e,t){var n=e.filter((function(e){return Qe()(e.fecha_pre_no_realizado).diff(e.fecha_registro_legados,"hour")<t})),r=e.filter((function(e){return Qe()(e.fecha_pre_no_realizado).diff(e.fecha_registro_legados,"hour")>=t}));return{plazo:n,vencidas:r,porcentaje:Math.round(100*n.length/(n.length+r.length))}}function D(e,t,n,r,a){return[{indexCode:"Averias 24h",nombre:e,type:"plazo",ordenes:t,value:Math.round(100*t.length/(t.length+n.length))},{indexCode:"Averias 24h",nombre:e,type:"vencido",ordenes:n,value:Math.round(100*n.length/(t.length+n.length))},{indexCode:"Plazo 72h",nombre:e,type:"plazo",ordenes:r,value:Math.round(100*r.length/(r.length+a.length))},{indexCode:"Plazo 72h",nombre:e,type:"vencido",ordenes:a,value:Math.round(100*a.length/(r.length+a.length))}]}return Object(a.useEffect)((function(){n&&n.length>0?function(){var e=[].concat(Object(ue.a)(on),Object(ue.a)(an)),t=[].concat(Object(ue.a)(rn),Object(ue.a)(nn)),r=[].concat(Object(ue.a)(e),Object(ue.a)(t)),a=p?n.filter((function(e){return r.includes(e.subtipo_actividad)&&"telef\xf3nica"===String(e.tipo_cita).toLowerCase()})):n.filter((function(e){return r.includes(e.subtipo_actividad)})),i=E(a.filter((function(t){return e.includes(t.subtipo_actividad)})),24),o=E(a.filter((function(e){return t.includes(e.subtipo_actividad)})),72);try{!function(e,t,n){var r=[],a=[];e.forEach((function(e){r.includes(e.bucket)||r.push(e.bucket)})),r.filter((function(e){return e})).forEach((function(e){var r=t.plazo.filter((function(t){return t&&t.bucket===e})),i=t.vencidas.filter((function(t){return t&&t.bucket===e})),o=n.plazo.filter((function(t){return t&&t.bucket===e})),c=n.vencidas.filter((function(t){return t&&t.bucket===e}));a.push.apply(a,Object(ue.a)(D(String(e).substring(6),r,i,o,c)))})),v(a)}(a,i,o),function(e,t,n){var r=[],a=[];e.forEach((function(e){e.contrata&&!r.includes(e.contrata.nombre)&&r.push(e.contrata.nombre)})),r.filter((function(e){return e})).forEach((function(e){var r=t.plazo.filter((function(t){return t&&t.contrata&&t.contrata.nombre===e})),i=t.vencidas.filter((function(t){return t&&t.contrata&&t.contrata.nombre===e})),o=n.plazo.filter((function(t){return t&&t.contrata&&t.contrata.nombre===e})),c=n.vencidas.filter((function(t){return t&&t.contrata&&t.contrata.nombre===e}));a.push.apply(a,Object(ue.a)(D(e,r,i,o,c)))})),S(a)}(a,i,o),function(e,t,n){var r=[],a=[];e.forEach((function(e){e.gestor&&!r.includes(e.gestor.nombre)&&r.push(e.gestor.nombre)})),r.filter((function(e){return e})).forEach((function(e){var r=t.plazo.filter((function(t){return t&&t.gestor&&t.gestor.nombre===e})),i=t.vencidas.filter((function(t){return t&&t.gestor&&t.gestor.nombre===e})),o=n.plazo.filter((function(t){return t&&t.gestor&&t.gestor.nombre===e})),c=n.vencidas.filter((function(t){return t&&t.gestor&&t.gestor.nombre===e}));a.push.apply(a,Object(ue.a)(D(e,r,i,o,c)))})),T(a)}(a,i,o)}catch(c){console.log(c)}f(i),l(o)}():(l({plazo:[],vencidas:[],porcentaje:0}),f({plazo:[],vencidas:[],porcentaje:0}))}),[n,p]),Object(r.jsxs)("div",{style:{marginTop:".5rem"},children:[Object(r.jsxs)("h3",{children:["Indicadores TCFL - ",i]}),Object(r.jsx)(er.a,{checked:p,onChange:function(e){return O(e.target.checked)}})," Excluir Agendas",Object(r.jsxs)(R.a,{style:{margin:"1rem 0"},children:[Object(r.jsx)(nr,{hora:24,plazo:b.plazo.length,vencidas:b.vencidas.length,porcentaje:b.porcentaje}),Object(r.jsx)(nr,{hora:72,plazo:s.plazo.length,vencidas:s.vencidas.length,porcentaje:s.porcentaje})]}),Object(r.jsxs)(Nn.a,{style:{paddingLeft:"1rem"},animated:!1,children:[Object(r.jsx)(ir,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(Rn.a,{}),"Bucket"]}),children:Object(r.jsx)(ar,{data:m,paddingLeft:120,height:350})},"1"),Object(r.jsx)(ir,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(Mn.a,{}),"Contrata"]}),children:Object(r.jsx)(ar,{data:y,paddingLeft:190,height:350})},"2"),Object(r.jsx)(ir,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(K.a,{}),"Gestor"]}),children:Object(r.jsx)(ar,{data:A,paddingLeft:120,height:750})},"3")]})]})},cr=Ke.a.Option,sr="Todo";var lr=function(e){var t=e.ordenes,n=void 0===t?[]:t,i=e.hora,o=Object(a.useState)([]),c=Object(I.a)(o,2),s=c[0],l=c[1],d=Object(a.useState)(sr),u=Object(I.a)(d,2),b=u[0],f=u[1],j=Object(a.useState)([]),h=Object(I.a)(j,2),p=h[0],O=h[1],g=Object(a.useState)([]),x=Object(I.a)(g,2),m=x[0],v=x[1],_=Object(a.useState)(500),w=Object(I.a)(_,2),y=w[0],S=w[1];function C(){return(C=Object(P.a)(B.a.mark((function e(){var t;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&n.length>0&&(t=["Todo"],n.forEach((function(e){e.contrata&&e.contrata.nombre&&!t.includes(e.contrata.nombre)&&t.push(e.contrata.nombre)})),l(t.filter((function(e){return e}))));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return A.apply(this,arguments)}function A(){return(A=Object(P.a)(B.a.mark((function e(){var t,r;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&n.length>0?(t=n.filter((function(e){return e.tipo===fn})),r=n.filter((function(e){return e.tipo===jn})),O(T(t)),v(T(r))):(O([]),v([]));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e){var t=[],n=[],r=[{nombre:!1,tecnico:!1,cantidad:!1}];return e.forEach((function(e){(b===sr||e.contrata.nombre===b)&&!t.includes("".concat(e.tecnico.nombre," ").concat(e.tecnico.apellidos))&&(t.push("".concat(e.tecnico.nombre," ").concat(e.tecnico.apellidos)),n.push(e.tecnico.apellidos))})),n=n.filter((function(e){return e})),t.filter((function(e){return e})).forEach((function(t){var n=e.filter((function(e){var n=b===sr||e.contrata.nombre===b;return e.tecnico.nombre+" "+e.tecnico.apellidos===t&&n})),a=String(n[0].tecnico.nombre).substring(0,1)+". "+n[0].tecnico.apellidos,i=String(a).length>20?String(a).substring(0,20)+"...":String(a);r.push({nombre:i.replace(/ {3}/g," "),tecnico:String(t).replace(/ {3}/g," "),cantidad:n.length})})),r=r.filter((function(e){return e.nombre}))}return Object(a.useEffect)((function(){!function(){C.apply(this,arguments)}(),k()}),[n]),Object(a.useEffect)((function(){k()}),[b]),Object(a.useEffect)((function(){if(p.length>0||m.length>0){var e=p.length>m.length?p.length:m.length;S(e>35?19*e:23*e)}else S(400)}),[p,m]),Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{style:{marginTop:".5rem"},children:[Object(r.jsxs)("h3",{children:["Indicadores de Producci\xf3n - ",i]}),Object(r.jsxs)(R.a,{style:{marginTop:"1rem"},children:[Object(r.jsx)("span",{children:"Contrata: "}),Object(r.jsx)(Ke.a,{size:"small",style:{width:"260px",marginLeft:".5rem"},value:b,onChange:function(e){return f(e)},children:s.length>0?s.map((function(e,t){return Object(r.jsx)(cr,{value:e,children:e},t)})):Object(r.jsx)(cr,{value:0,children:"-"})})]})]}),Object(r.jsxs)(R.a,{style:{margin:"1rem 0"},children:[Object(r.jsxs)(M.a,{sm:12,style:{textAlign:"center",margin:0,padding:0},children:[Object(r.jsx)("h4",{children:"Averias"}),Object(r.jsx)(Sn,{data:p,field:"tecnico",height:y,paddinLeft:180})]}),Object(r.jsxs)(M.a,{sm:12,style:{textAlign:"center",margin:0,padding:0},children:[Object(r.jsx)("h4",{children:"Altas"}),Object(r.jsx)(Sn,{data:m,field:"tecnico",height:y,paddinLeft:180})]})]})]})};var dr=[{path:h,exact:!0,component:function(){var e=Object(a.useState)([]),t=Object(I.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)(""),c=Object(I.a)(o,2),s=c[0],l=c[1];return Object(a.useEffect)((function(){return N.emit("obtenerOrdenes"),N.on("ordenesGraficos",(function(e){var t=e.averias,n=e.altas,r=e.hora,a=new Array(JSON.parse(t)),o=new Array(JSON.parse(n));r&&Qe()(new Date(r)).isValid()&&l(Qe()(new Date(r)).format("HH:mm")),a&&a[0]&&a[0].length>0&&o&&o[0]&&o[0].length>0&&i([].concat(Object(ue.a)(a[0]),Object(ue.a)(o[0])))})),N.on("error",(function(e){console.log(e),F.a.error("Error conectando al servidor.",{position:"top-left"})})),function(){N.off("ordenesGraficos")}}),[]),Object(r.jsxs)("div",{children:[Object(r.jsx)(et,{titulo:"Resumen General",subtitulo:"Dashboard"}),Object(r.jsx)(Dn,{ordenes:n,hora:s}),Object(r.jsx)(q,{children:Object(r.jsx)($n,{ordenes:n,hora:s})}),Object(r.jsx)(q,{children:Object(r.jsx)(or,{ordenes:n.filter((function(e){return e.estado_toa===ln.COMPLETADO})),hora:s})}),Object(r.jsx)(q,{children:Object(r.jsx)(lr,{ordenes:n.filter((function(e){return e.estado_toa===ln.COMPLETADO&&e.contrata&&e.contrata.nombre})),hora:s})})]})},nivel:k.todos}],ur=n(661),br=V.a.Search;var fr=n(662),jr=n(663),hr={ACTIVO:"Activo",SUSPENDIDO:"Suspendido",INACTIVO:"Inactivo"};function pr(e){switch(e.cargo){case b.ADMINISTRADOR:return Object(r.jsx)(Cn.a,{color:"geekblue",children:"Administrador"});case b.JEFE_OPERACIONES:return Object(r.jsx)(Cn.a,{color:"blue",children:"Jefe de Operaciones"});case b.JEFE_LOGISTICA:return Object(r.jsx)(Cn.a,{color:"cyan",children:"Jefe de Logistica"});case b.LIDER_GESTION:return Object(r.jsx)(Cn.a,{color:"purple",children:"Lider de Gestion"});case b.ASISTENTE_LOGISTICA:return Object(r.jsx)(Cn.a,{color:"green",children:"Asistente de Logistica"});case b.JEFE_CONTRATA:return Object(r.jsx)(Cn.a,{color:"orange",children:"Jefe de Contrata"});case b.GESTOR:return Object(r.jsx)(Cn.a,{color:"magenta",children:"Gestor"});case b.ALMACENERO:return Object(r.jsx)(Cn.a,{color:"red",children:"Almacenero"});case b.AUDITOR:return Object(r.jsx)(Cn.a,{color:"gold",children:"Auditor"});case b.TECNICO:return Object(r.jsx)(Cn.a,{color:"volcano",children:"Tecnico"});default:return Object(r.jsx)(Cn.a,{children:"Sin cargo"})}}function Or(e){var t=e.estado;switch(t){case hr.ACTIVO:return Object(r.jsx)(Cn.a,{icon:Object(r.jsx)($t.a,{}),color:tn.success,children:t});case hr.SUSPENDIDO:return Object(r.jsx)(Cn.a,{icon:Object(r.jsx)(fr.a,{}),color:tn.warning,children:t});case hr.INACTIVO:return Object(r.jsx)(Cn.a,{icon:Object(r.jsx)(jr.a,{}),color:tn.error,children:t});default:return Object(r.jsx)(Cn.a,{children:"Desconocido"})}}var gr=n(665),xr=n(666),mr=Ke.a.Option;var vr=function(e){var t=e.accion,n=e.visible,i=e.setVisible,o=e.empleado,s=void 0===o?{}:o,l=e.contratas,d=void 0===l?[]:l,u=e.guardar,f=Object(a.useState)({numero_documento:Number(Date.now())}),j=Object(I.a)(f,2),h=j[0],p=j[1],O=H.a.useForm(),g=Object(I.a)(O,1)[0];return Object(a.useEffect)((function(){s._id&&p(Object(c.a)(Object(c.a)({},s),{},{email:s.usuario.email,cargo:s.usuario.cargo,contrata:s.contrata&&s.contrata._id}))}),[s]),Object(r.jsx)(kn.a,{width:300,cancelText:"Cancelar",okText:"Guardar",title:"crear"===t?"Crear Empleado":"Editar Empleado",visible:n,onOk:function(){g.validateFields().then(function(){var e=Object(P.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p({numero_documento:Date.now()}),g.resetFields(),n=Object(c.a)(Object(c.a)({},t),{},{usuario:{email:t.email,cargo:t.cargo}}),e.next=5,u(n);case 5:i(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("Validate Failed:",e)}))},onCancel:function(){i(!1)},destroyOnClose:!0,centered:!0,children:Object(r.jsxs)(H.a,{name:"form_empleado",layout:"vertical",size:"small",form:g,initialValues:h,onValuesChange:function(e){return p(Object(c.a)(Object(c.a)({},h),e))},children:[Object(r.jsx)(H.a.Item,{name:"nombre",label:"Nombre",rules:[{required:!0}],children:Object(r.jsx)(V.a,{})}),Object(r.jsx)(H.a.Item,{name:"apellidos",label:"Apellidos",rules:[{required:!0}],children:Object(r.jsx)(V.a,{})}),Object(r.jsx)(H.a.Item,{name:"email",label:"Correo",rules:[{required:!0,type:"email"}],children:Object(r.jsx)(V.a,{})}),Object(r.jsx)(H.a.Item,{name:"cargo",label:"Cargo",rules:[{required:!0,type:"number"}],children:Object(r.jsxs)(Ke.a,{disabled:h.cargo<b.JEFE_LOGISTICA&&"editar"===t,placeholder:"Seleccionar cargo",onChange:function(e){return p(Object(c.a)(Object(c.a)({},h),{},{cargo:e}))},allowClear:!0,children:[Object(r.jsx)(mr,{value:b.JEFE_OPERACIONES,children:"Jefe de Operaciones"}),Object(r.jsx)(mr,{value:b.LIDER_GESTION,children:"Lider de Gesti\xf3n"}),Object(r.jsx)(mr,{value:b.ASISTENTE_LOGISTICA,children:"Asistente de Logistica"}),Object(r.jsx)(mr,{value:b.JEFE_CONTRATA,children:"Jefe de Contrata"}),Object(r.jsx)(mr,{value:b.GESTOR,children:"Gestor"}),Object(r.jsx)(mr,{value:b.ALMACENERO,children:"Almacenero"}),Object(r.jsx)(mr,{value:b.AUDITOR,children:"Auditor"}),Object(r.jsx)(mr,{value:b.TECNICO,children:"Tecnico"})]})}),Object(r.jsx)(H.a.Item,{name:"carnet",label:"Carnet",rules:[{required:!1}],children:Object(r.jsx)(V.a,{})}),d&&d.length>0?Object(r.jsx)(H.a.Item,{name:"contrata",label:"Contrata",rules:[{required:!0}],children:Object(r.jsx)(Ke.a,{placeholder:"Seleccionar contrata",onChange:function(e){return p(Object(c.a)(Object(c.a)({},h),{},{contrata:e}))},allowClear:!0,children:d.map((function(e,t){return Object(r.jsx)(mr,{value:e._id,children:e.nombre},t)}))})}):null,Object(r.jsx)(H.a.Item,{name:"tipo_documento",label:"Tipo de Documento",children:Object(r.jsxs)(Ke.a,{placeholder:"Seleccionar tipo",onChange:function(e){return p(Object(c.a)(Object(c.a)({},h),{},{tipo_documento:e}))},allowClear:!0,children:[Object(r.jsx)(mr,{value:"DNI",children:"DNI"}),Object(r.jsx)(mr,{value:"Otro",children:"Otro"})]})}),Object(r.jsx)(H.a.Item,{name:"numero_documento",label:"Numero de Documento",rules:[{required:!1,type:"string"}],children:Object(r.jsx)(V.a,{})})]})})},_r=n(664),wr=Ke.a.Option;var yr=function(e){var t=e.visible,n=e.setVisible,i=(e.listarEmpleados,e.id),o=Object(a.useState)(4),c=Object(I.a)(o,2),s=c[0],l=c[1];function d(){return(d=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rt(!0,{id:i,metodo:jt,cargo:s}).then((function(){return n(!t)})).catch((function(e){n(!1),console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.jsxs)(kn.a,{title:"Actualizar Cargo",visible:t,width:300,onOk:function(){return d.apply(this,arguments)},onCancel:function(){return n(!1)},centered:!0,children:[Object(r.jsx)("p",{style:{fontSize:"13px",color:"rgba(0,0,0,.55)"},children:"*Recuerda que no es posible otorgar un cargo superior al tuyo y que todo cambio quedar\xe1 registrado en el sistema."}),Object(r.jsx)("p",{children:"Seleccionar Cargo:"}),Object(r.jsxs)(Ke.a,{defaultValue:s,onChange:function(e){return l(e)},style:{width:180},children:[Object(r.jsx)(wr,{value:b.LIDER_GESTION,children:"Lider de Gestion"}),Object(r.jsx)(wr,{value:b.ASISTENTE_LOGISTICA,children:"Asistente de Logistica"}),Object(r.jsx)(wr,{value:b.JEFE_CONTRATA,children:"Jefe de contrata"}),Object(r.jsx)(wr,{value:b.GESTOR,children:"Gestor"}),Object(r.jsx)(wr,{value:b.ALMACENERO,children:"Almacenero"}),Object(r.jsx)(wr,{value:b.AUDITOR,children:"Auditor"}),Object(r.jsx)(wr,{value:b.TECNICO,children:"Tecnico"})]})]})},Sr=Ke.a.Option;var Cr=function(e){var t=e.visible,n=e.setVisible,i=e.listarEmpleados,o=e.id,c=Object(a.useState)(1),s=Object(I.a)(c,2),l=s[0],d=s[1],u=Object(a.useState)(""),b=Object(I.a)(u,2),f=b[0],j=b[1];function h(){return(h=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rt(!0,{id:o,metodo:pt,fecha_baja:f,estado_empresa:l}).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(!1),e.next=3,i();case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.jsxs)(kn.a,{title:"Estado Empresa",visible:t,width:300,onOk:function(){return h.apply(this,arguments)},onCancel:function(){return n(!1)},centered:!0,children:[Object(r.jsx)("p",{style:{fontSize:"13px",color:"rgba(0,0,0,.55)"},children:'*Un usuario "Activo" tiene la cuenta habilitada y aparece en las listas del personal (ordenes, inventario, etc.)'}),Object(r.jsx)("p",{style:{fontSize:"13px",color:"rgba(0,0,0,.55)"},children:'*Un usuario "Suspendido" no podr\xe1 iniciar sesi\xf3n en el sistema, pero seguir\xe1 apareciendo en las listas del personal (ordenes, inventario, etc.)'}),Object(r.jsx)("p",{style:{fontSize:"13px",color:"rgba(0,0,0,.55)"},children:'*Un usuario "Inactivo" no podr\xe1 iniciar sesi\xf3n en el sistema y desaparecer\xe1 por completo de las listas del sistema (usuario de baja)'}),Object(r.jsxs)(Je.b,{direction:"vertical",children:["Seleccionar:",Object(r.jsxs)(Ke.a,{defaultValue:l,onChange:function(e){return d(e)},style:{width:150},children:[Object(r.jsx)(Sr,{value:1,children:"Activo"}),Object(r.jsx)(Sr,{value:2,children:"Suspendido"}),Object(r.jsx)(Sr,{value:3,children:"Inactivo"})]}),"Fecha de suspensi\xf3n / baja:",Object(r.jsx)(We.a,{onChange:function(e,t){return j(t)}})]})]})};var kr=function(e){var t=e.visible,n=e.setVisible,i=e.id,o=e.listarEmpleados,c=Object(a.useState)(!1),s=Object(I.a)(c,2),l=s[0],d=s[1],u=Object(a.useState)(!1),b=Object(I.a)(u,2),f=b[0],j=b[1];function h(e){return p.apply(this,arguments)}function p(){return(p=Object(P.a)(B.a.mark((function e(r){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rt(!0,{id:i,metodo:r}).then((function(){o(),n(!t)})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=function(){var e=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:n(!1);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(kn.a,{title:"Configuraciones",visible:t,width:250,onOk:O,onCancel:function(){return n(!1)},centered:!0,children:[Object(r.jsx)(U.a,{block:!0,icon:Object(r.jsx)(J.a,{}),style:{marginBottom:".5rem"},onClick:function(){return h(bt)},children:"Reiniciar Contrase\xf1a"}),Object(r.jsx)(U.a,{block:!0,icon:Object(r.jsx)(jr.a,{}),style:{marginBottom:".5rem"},onClick:function(){return h(ft)},children:"Cerrar Sessi\xf3n"}),Object(r.jsx)(U.a,{block:!0,icon:Object(r.jsx)(_r.a,{}),style:{marginBottom:".5rem"},onClick:function(){return d(!l)},children:"Permisos"}),Object(r.jsx)(U.a,{block:!0,icon:Object(r.jsx)(K.a,{}),style:{marginBottom:".5rem"},onClick:function(){return h(ht)},children:"Activar Cuenta"}),Object(r.jsx)(U.a,{block:!0,danger:!0,icon:Object(r.jsx)(fr.a,{}),style:{marginBottom:".5rem"},onClick:function(){return j(!f)},children:"Cambiar Estado"}),Object(r.jsx)(yr,{visible:l,setVisible:d,listarEmpleados:o,id:i}),Object(r.jsx)(Cr,{visible:f,setVisible:j,listarEmpleados:o,id:i})]})};function Ir(e){var t=e.id,n=e.empleado,i=e.listarEmpleados,o=e.listaContratas,c=Object(a.useState)(!1),s=Object(I.a)(c,2),l=s[0],d=s[1],u=Object(a.useState)(!1),b=Object(I.a)(u,2),f=b[0],j=b[1];function h(){return(h=Object(P.a)(B.a.mark((function e(n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,it(t,n).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.jsxs)("span",{children:[Object(r.jsx)(gr.a,{title:"Editar",twoToneColor:tn.warning,style:{paddingRight:"8px",fontSize:"1.5rem"},onClick:function(){return d(!0)}}),Object(r.jsx)(xr.a,{title:"Configuraciones",style:{paddingRight:"8px",fontSize:"1.5rem"},onClick:function(){return j(!0)}}),Object(r.jsx)(vr,{accion:"editar",empleado:n,contratas:o,visible:l,setVisible:d,guardar:function(e){return h.apply(this,arguments)}}),Object(r.jsx)(kr,{visible:f,setVisible:j,listarEmpleados:i,id:t})]})}var Ar=function(){var e=Object(P.a)(B.a.mark((function e(t,n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Q({url:"contratas",method:"GET",params:{metodo:n}},t));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Tr=function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Q({url:"contratas",method:"POST",data:t},!0));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Er=function(){var e=Object(P.a)(B.a.mark((function e(t,n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Q({url:"contratas/"+t,method:"PUT",data:n},!0));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Dr=function(){var e=Object(P.a)(B.a.mark((function e(t,n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Q({url:"contratas/"+t,method:"PATCH",data:n},!0));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Nr=n(636),Rr=Le.a.Text;var Mr=function(e){var t=e.visible,n=e.abrirModal,a=e.empleado,i=void 0===a?{}:a;return Object(r.jsx)(kn.a,{width:450,cancelText:"Cancelar",okText:"Aceptar",title:"Detalle del Usuario",visible:t,onOk:n,onCancel:n,destroyOnClose:!0,centered:!0,children:Object(r.jsxs)(Nr.a,{layout:"vertical",bordered:!0,size:"small",column:2,children:[i.gestor&&Object(r.jsx)(Nr.a.Item,{label:"Gestor:",children:i.gestor.nombre&&i.gestor.nombre}),Object(r.jsx)(Nr.a.Item,{label:"Tipo de Doc.:",children:i.tipo_documento}),Object(r.jsx)(Nr.a.Item,{label:"Numero de Doc.:",children:Object(r.jsx)(Rr,{copyable:!0,children:i.numero_documento})}),Object(r.jsx)(Nr.a.Item,{label:"Fecha de Nacimiento:",children:i.fecha_nacimiento&&Qe()(i.fecha_nacimiento).format("DD-MM-YYYY")}),i.fecha_ingreso&&Object(r.jsx)(Nr.a.Item,{label:"Fecha de Ingreso",children:Qe()(i.fecha_ingreso).format("DD-MM-YYYY")}),i.fecha_baja&&Object(r.jsx)(Nr.a.Item,{label:"Fecha de Baja",children:Qe()(i.fecha_baja).format("DD-MM-YYYY")}),Object(r.jsx)(Nr.a.Item,{label:"Nacionalidad",children:i.nacionalidad?i.nacionalidad:"-"}),Object(r.jsx)(Nr.a.Item,{label:"Observaci\xf3n",span:2,children:i.observacion})]})})},qr=Le.a.Text;function Fr(){var e=Object(a.useState)(1),t=Object(I.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)(20),c=Object(I.a)(o,2),s=c[0],l=c[1],d=Object(a.useState)(1),u=Object(I.a)(d,2),b=u[0],f=u[1],j=Object(a.useState)([]),h=Object(I.a)(j,2),p=h[0],O=h[1],g=Object(a.useState)(!1),x=Object(I.a)(g,2),m=x[0],v=x[1],_=Object(a.useState)(!1),w=Object(I.a)(_,2),y=w[0],S=w[1],C=Object(a.useState)({}),k=Object(I.a)(C,2),A=k[0],T=k[1],E=Object(a.useState)([]),D=Object(I.a)(E,2),N=D[0],R=D[1],M=Object(a.useState)(!1),F=Object(I.a)(M,2),L=F[0],z=F[1];function G(){return Y.apply(this,arguments)}function Y(){return(Y=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return z(!0),e.next=3,tt(!0,{metodo:ct,page:n,limit:s}).then((function(e){var t=e.data;O(t.docs),f(t.totalDocs),z(!1)})).catch((function(e){z(!1),console.log(e)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(){return(H=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ar(!1,yt).then((function(e){var t=e.data;return R(t)})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){return(V=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,at(t).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){G(),function(){H.apply(this,arguments)}()}),[n,s]);var K=function(){return v(!m)},J=function(){return S(!y)},W=[{title:"#",width:50,render:function(e,t,n){return n+1}},{title:"Nombre",dataIndex:"nombre",width:150},{title:"Apellidos",dataIndex:"apellidos",width:150,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e,children:e})}},{title:"Email",dataIndex:"usuario",width:200,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e&&e.email,children:e&&e.email})}},{title:"Cargo",dataIndex:"usuario",width:150,render:function(e){return Object(r.jsx)(pr,{cargo:e.cargo})}},{title:"Contrata",dataIndex:"contrata",width:200,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e&&e.nombre,children:e&&e.nombre})}},{title:"Carnet",dataIndex:"carnet",width:150,render:function(e){return e?Object(r.jsx)(qr,{copyable:!0,children:e}):null}},{title:"Estado",dataIndex:"estado_empresa",width:150,render:function(e){return Object(r.jsx)(Or,{estado:e})}},{title:"Acciones",dataIndex:"_id",align:"center",width:100,render:function(e,t){return Object(r.jsx)(Ir,{id:e,empleado:t,listarEmpleados:G,listaContratas:N})}}];return Object(r.jsxs)(q,{children:[Object(r.jsx)(In.a,{rowKey:"_id",onRow:function(e){return{onDoubleClick:function(){return T(e),void J()}}},className:"tabla-personal",title:function(){return function(e,t,n,i,o){var c=Object(a.useState)("nombre"),s=Object(I.a)(c,2),l=s[0],d=s[1];function u(){return(u=Object(P.a)(B.a.mark((function e(r){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>1)){e.next=5;break}return e.next=3,nt(r,l).then((function(e){var t=e.data;t.length>0?(n(t),i(1),o(t.length)):n([])})).catch((function(e){return console.log(e)}));case 3:e.next=7;break;case 5:return e.next=7,t();case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.jsxs)("div",{className:"header-tabla",children:[Object(r.jsxs)("div",{className:"busqueda",children:[Object(r.jsxs)(Ze.a.Group,{onChange:function(e){return d(e.target.value)},value:l,style:{paddingTop:".22rem"},children:[Object(r.jsx)(Ze.a,{value:"nombre",children:"Nombre"}),Object(r.jsx)(Ze.a,{value:"numero_documento",children:"Documento"}),Object(r.jsx)(Ze.a,{value:"carnet",children:"Carnet"})]}),Object(r.jsx)(br,{placeholder:"Buscar personal",allowClear:!0,enterButton:!1,onSearch:function(e){return u.apply(this,arguments)},style:{width:200,margin:0}})]}),Object(r.jsx)("div",{className:"boton-agregar",children:Object(r.jsx)(U.a,{icon:Object(r.jsx)(ur.a,{}),onClick:e,children:"Agregar"})})]})}(K,G,O,i,f)},columns:W,dataSource:p,loading:L,size:"small",scroll:{x:"1250px",y:"65vh"},pagination:{current:n,total:b,defaultPageSize:s,pageSizeOptions:[10,20,50,100],onChange:function(e){return i(e)},onShowSizeChange:function(e,t){return l(t)}}}),Object(r.jsx)(vr,{accion:"crear",contratas:N,visible:m,setVisible:v,guardar:function(e){return V.apply(this,arguments)}}),Object(r.jsx)(Mr,{visible:y,abrirModal:J,empleado:A})]})}var Lr=n(667);var zr=function(e){var t=e.visible,n=e.setVisible,i=e.accion,o=e.guardar,c=e.contrata,s=void 0===c?{}:c,l=Object(a.useState)(null),d=Object(I.a)(l,2),u=d[0],b=d[1],f=Object(a.useState)(null),j=Object(I.a)(f,2),h=j[0],p=j[1],O=Object(a.useState)(null),g=Object(I.a)(O,2),x=g[0],m=g[1],v=Object(a.useState)(null),_=Object(I.a)(v,2),w=_[0],y=_[1];Object(a.useEffect)((function(){s.nombre&&(b(s.nombre),p(s.ruc),m(s.fecha_incorporacion),y(s.observacion))}),[s]);var S=function(){var e=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b(null),p(null),m(null),y(null),n(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o({nombre:u,ruc:h,fecha_incorporacion:x&&x,observacion:w&&w},s.id);case 2:S();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(kn.a,{width:270,cancelText:"Cancelar",okText:"Guardar",title:"crear"===i?"Crear Contrata":"Editar Contrata",visible:t,onOk:C,onCancel:S,destroyOnClose:!0,centered:!0,children:[Object(r.jsx)("p",{children:"Nombre de Contrata:"}),Object(r.jsx)(V.a,{placeholder:"Nombre de Contrata",defaultValue:u,onChange:function(e){return b(e.target.value)}}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("p",{children:"RUC:"}),Object(r.jsx)(V.a,{placeholder:"RUC",defaultValue:h,onChange:function(e){return p(e.target.value)}}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("p",{children:"Fecha de Incorporaci\xf3n:"}),Object(r.jsx)(We.a,{defaultValue:x&&Qe.a.utc(x),onChange:function(e,t){return m(t)}}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("p",{children:"Observacion:"}),Object(r.jsx)(V.a,{placeholder:"Observacion",defaultValue:w,onChange:function(e){return y(e.target.value)}}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{})]})};var Br=function(e){var t=e.visible,n=e.setVisible,i=e.guardar,o=e.contrata,c=void 0===o?{}:o,s=Object(a.useState)(!0),l=Object(I.a)(s,2),d=l[0],u=l[1],b=Object(a.useState)(null),f=Object(I.a)(b,2),j=f[0],h=f[1];function p(){return(p=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c._id){e.next=6;break}return e.next=3,i(c._id,{activo:d,fecha_baja:j});case 3:O(),e.next=7;break;case 6:console.log("objeto contrata vacio.");case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=function(){u(!0),h(null),n(!1)};return Object(r.jsx)(kn.a,{width:250,cancelText:"Cancelar",okText:"Guardar",title:"Desactivar Contrata",visible:t,onOk:function(){return p.apply(this,arguments)},onCancel:O,destroyOnClose:!0,centered:!0,children:Object(r.jsxs)(Je.b,{direction:"vertical",children:[Object(r.jsx)("p",{style:{fontSize:"13px",color:"rgba(0,0,0,.55)"},children:"*La contrata no se eliminar\xe1 de la base de datos, pero si dejar\xe1 de aparecer en las listas del sistema."}),"Seleccionar estado:",Object(r.jsxs)(Ze.a.Group,{onChange:function(e){return u(e.target.value)},value:d,children:[Object(r.jsx)(Ze.a,{value:!0,children:"Activo"}),Object(r.jsx)(Ze.a,{value:!1,children:"Inactivo"})]}),"Seleccionar fecha de baja:",Object(r.jsx)(We.a,{onChange:function(e,t){return h(t)}})]})})};function Pr(){var e=Object(a.useState)(!1),t=Object(I.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)([]),c=Object(I.a)(o,2),s=c[0],l=c[1],d=Object(a.useState)(!1),u=Object(I.a)(d,2),b=u[0],f=u[1],j=Object(a.useState)(!1),h=Object(I.a)(j,2),p=h[0],O=h[1],g=Object(a.useState)(!1),x=Object(I.a)(g,2),m=x[0],v=x[1],_=Object(a.useState)({}),w=Object(I.a)(_,2),y=w[0],S=w[1];function C(){return k.apply(this,arguments)}function k(){return(k=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.next=3,Ar(!0,wt).then((function(e){var t=e.data;i(!1),l(t&&t)})).catch((function(e){i(!1),console.log(e)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return(A=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tr(t).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){console.log(e),D()}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){return(T=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y._id){e.next=3;break}return e.next=3,Er(y._id,t).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){console.log(e),N()}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){return(E=Object(P.a)(B.a.mark((function e(t,n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Dr(t,n).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){console.log(e),R()}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){C()}),[]);var D=function(){return f(!b)},N=function(){return O(!p)},R=function(){return v(!m)},M=[{title:"#",width:50,render:function(e,t,n){return n+1}},{title:"Nombre",dataIndex:"nombre",width:250},{title:"Estado",dataIndex:"activo",width:150,render:function(e){return e?Object(r.jsx)(Cn.a,{color:"success",children:"Activo"}):Object(r.jsx)(Cn.a,{color:"error",children:"Inactivo"})}},{title:"Fecha Inicio",dataIndex:"fecha_incorporacion",width:150,render:function(e){return e?Qe()(e).format("DD-MM-YYYY"):"-"}},{title:"Fecha Baja",dataIndex:"fecha_baja",width:150,render:function(e){return e?Qe()(e).format("DD-MM-YYYY"):"-"}},{title:"Observaci\xf3n",dataIndex:"observacion"},{title:"Acciones",dataIndex:"_id",align:"center",width:100,render:function(e,t){return Object(r.jsxs)("span",{children:[Object(r.jsx)(gr.a,{title:"Editar",twoToneColor:tn.warning,style:{paddingRight:"8px",fontSize:"1.5rem"},onClick:function(){N(),S(t)}}),Object(r.jsx)(Lr.a,{title:"Configuraciones",twoToneColor:tn.error,style:{paddingRight:"8px",fontSize:"1.5rem"},onClick:function(){R(),S(t)}})]})}}];return Object(r.jsxs)(q,{children:[Object(r.jsx)(In.a,{rowKey:"_id",style:{marginBottom:"1rem"},className:"tabla-personal",title:function(){return Object(r.jsx)(U.a,{icon:Object(r.jsx)(ur.a,{}),onClick:D,children:"Agregar"})},columns:M,dataSource:s,loading:n,size:"small",scroll:{y:"65vh"},pagination:!1}),Object(r.jsx)(zr,{visible:b,setVisible:f,guardar:function(e){return A.apply(this,arguments)},accion:"crear"}),Object(r.jsx)(zr,{visible:p,setVisible:O,guardar:function(e){return T.apply(this,arguments)},contrata:y,accion:"editar"}),Object(r.jsx)(Br,{visible:m,setVisible:v,guardar:function(e,t){return E.apply(this,arguments)},contrata:y})]})}var Gr=[{path:p,exact:!0,component:function(){return Object(r.jsxs)("div",{children:[Object(r.jsx)(et,{titulo:"Lista de Personal",subtitulo:"Usuarios y Personal"}),Object(r.jsx)(Fr,{})]})},nivel:k.todos},{path:O,exact:!0,component:function(){return Object(r.jsxs)("div",{children:[Object(r.jsx)(et,{titulo:"Lista de Contratas",subtitulo:"Usuarios y Personal"}),Object(r.jsx)(Pr,{})]})},nivel:k.listaContratas}],Yr=n(668),Hr=n(310);function Vr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return[];var r=[],a=!1;try{return e.forEach((function(e){void 0!==e[t]&&null!==e[t]&&e[t]._id&&null!==e[t]._id?-1===r.findIndex((function(n){return n.value===e[t]._id}))&&r.push({text:n?e[t].nombre+" "+e[t].apellidos:e[t].nombre,value:e[t]._id}):a=!0})),a?[].concat(r,[{text:"-",value:"-"}]):r}catch(i){return console.log(i),[]}}function Ur(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(0===e.length)return[];var n=[];try{return e.forEach((function(e){void 0!==e[t]&&null!==e[t]&&(-1===n.findIndex((function(n){return n.value===e[t]}))&&n.push({text:e[t],value:e[t]}))})),n}catch(r){return console.log(r),[]}}var Kr=Ke.a.Option,Jr=V.a.Search,Wr={contrata:"Contrata",carnet:"Carnet",tecnico:"Tecnico",gestor:"Gestor",auditor:"auditor",tipo_negocio:"Negocio",sub_tipo_negocio:"Sub Negocio"};var Zr=function(e){var t=e.gestores,n=void 0===t?[]:t,i=e.loadingGestores,o=e.auditores,s=void 0===o?[]:o,l=e.loadingAuditores,d=Object(a.useState)([]),u=Object(I.a)(d,2),b=u[0],f=u[1],j=Object(a.useState)([]),h=Object(I.a)(j,2),p=h[0],O=h[1],g=Object(a.useState)(!1),x=Object(I.a)(g,2),m=x[0],v=x[1],_=Object(a.useState)(!1),w=Object(I.a)(_,2),y=w[0],S=w[1],C=Object(a.useState)(!1),k=Object(I.a)(C,2),A=k[0],T=k[1],E=Object(a.useState)(!1),D=Object(I.a)(E,2),N=D[0],q=D[1],F=Object(a.useState)(!1),L=Object(I.a)(F,2),z=L[0],G=L[1],Y=Object(a.useState)([]),H=Object(I.a)(Y,2),V=H[0],K=H[1],J=Object(a.useState)(null),W=Object(I.a)(J,2),Z=W[0],X=W[1],Q=Object(a.useState)(null),$=Object(I.a)(Q,2),ee=$[0],te=$[1],ne=Object(a.useState)(null),re=Object(I.a)(ne,2),ae=re[0],ie=re[1],oe=Object(a.useState)(null),ce=Object(I.a)(oe,2),se=ce[0],le=ce[1],de=Object(a.useState)([]),ue=Object(I.a)(de,2),be=ue[0],fe=ue[1],je=Object(a.useState)([]),he=Object(I.a)(je,2),pe=he[0],Oe=he[1],ge=Object(a.useState)([]),xe=Object(I.a)(ge,2),me=xe[0],ve=xe[1],_e=Object(a.useState)("nombre"),we=Object(I.a)(_e,2),ye=we[0],Se=we[1],Ce=Object(Hr.useJsonToCsv)().saveAsCsv;function ke(){return Ie.apply(this,arguments)}function Ie(){return(Ie=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(!0),e.next=3,tt(!0,{metodo:st}).then(function(){var e=Object(P.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=t.data)?(fe(Vr(n,"contrata")),Oe(Vr(n,"gestor",!0)),ve(Vr(n,"auditor",!0)),O(n),f(n)):(O([]),f([]));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log(e)})).finally((function(){return v(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ae(e){return Te.apply(this,arguments)}function Te(){return(Te=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("gestor"!==t){e.next=11;break}if(!(V.length>0)){e.next=7;break}return S(!0),e.next=5,rt(!0,{metodo:Ot,gestor:"-"===Z?null:Z,tecnicos:V}).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)})).finally((function(){return S(!1)}));case 5:e.next=8;break;case 7:console.log("no hay tecnicos seleccionado");case 8:e.next=39;break;case 11:if("auditor"!==t){e.next=21;break}if(!(ee&&V.length>0)){e.next=18;break}return T(!0),e.next=16,rt(!0,{metodo:gt,auditor:ee,tecnicos:V}).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)})).finally((function(){return T(!1)}));case 16:e.next=19;break;case 18:console.log("no hay tecnicos o auditor seleccionado");case 19:e.next=39;break;case 21:if("negocio"!==t){e.next=31;break}if(!(ae&&V.length>0)){e.next=28;break}return q(!0),e.next=26,rt(!0,{metodo:xt,negocio:ae,tecnicos:V}).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)})).finally((function(){return q(!1)}));case 26:e.next=29;break;case 28:console.log("no hay tecnicos o negocio seleccionado");case 29:e.next=39;break;case 31:if("subNegocio"!==t){e.next=39;break}if(!(se&&V.length>0)){e.next=38;break}return G(!0),e.next=36,rt(!0,{metodo:mt,subNegocio:se,tecnicos:V}).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)})).finally((function(){return G(!1)}));case 36:e.next=39;break;case 38:console.log("no hay tecnicos o sub negocio seleccionado");case 39:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){ke()}),[]);var Ee=function(){if(p&&p.length>0)return Ce({data:p.map((function(e){return Object(c.a)(Object(c.a)({},e),{},{tecnico:e.nombre&&e.apellidos?e.nombre+" "+e.apellidos:"-",gestor:e.gestor?e.gestor.nombre+" "+e.gestor.apellidos:"-",auditor:e.auditor&&e.auditor.nombre?e.auditor.nombre+" "+e.auditor.apellidos:"-",contrata:e.contrata?e.contrata.nombre:"-"})})),fields:Wr,filename:"data_personal_".concat(Qe()().format("DD_MM_YY_HH_mm"))})},De=function(e){var t=e.target.value;String(t).length>0&&ye&&b.length>0?O(b.filter((function(e){return 0===String(e[ye]).toLowerCase().indexOf(String(t).toLowerCase())}))):O(b)},Ne=[{title:"#",width:50,align:"center",render:function(e,t,n){return n+1}},{title:"Nombre",width:150,dataIndex:"nombre"},{title:"Apellidos",width:150,dataIndex:"apellidos"},{title:"Carnet",width:100,dataIndex:"carnet"},{title:"Contrata",width:150,dataIndex:"contrata",filters:be,onFilter:function(e,t){return"-"===e?!t.contrata:void 0!==t.contrata&&0===t.contrata._id.indexOf(e)},render:function(e){return e.nombre&&e.nombre}},{title:"Gestor",width:150,dataIndex:"gestor",filters:pe,onFilter:function(e,t){return"-"===e?!t.gestor:void 0!==t.gestor&&null!==t.gestor&&0===t.gestor._id.indexOf(e)},render:function(e){return e&&e.nombre&&e.apellidos?e.nombre+" "+e.apellidos:"-"}},{title:"Auditor",width:150,dataIndex:"auditor",filters:me,onFilter:function(e,t){return"-"===e?!t.auditor:void 0!==t.auditor&&0===t.auditor._id.indexOf(e)},render:function(e){return e&&e.nombre&&e.apellidos?e.nombre+" "+e.apellidos:"-"}},{title:"Negocio",width:150,dataIndex:"tipo_negocio",filters:xn,onFilter:function(e,t){return"-"===e?!t.tipo_negocio:void 0!==t.tipo_negocio&&0===t.tipo_negocio.indexOf(e)},render:function(e){return String(e).toUpperCase()}},{title:"Sub Negocio",width:150,dataIndex:"sub_tipo_negocio",filters:mn,onFilter:function(e,t){return"-"===e?!t.sub_tipo_negocio:void 0!==t.sub_tipo_negocio&&0===t.sub_tipo_negocio.indexOf(e)},render:function(e){return String(e).toUpperCase()}}];return Object(r.jsxs)("div",{children:[Object(r.jsxs)(R.a,{style:{marginBottom:".5rem",marginTop:".5rem"},children:[Object(r.jsxs)(M.a,{sm:12,children:[Object(r.jsx)("p",{children:"Asignar Gestor:"}),Object(r.jsx)(Ke.a,{showSearch:!0,placeholder:"Buscar por nombre",loading:i,defaultValue:Z,onChange:function(e){return X(e)},style:{width:300,marginBottom:".5rem",marginRight:".5rem"},filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},children:n.length>0?n.map((function(e,t){return Object(r.jsx)(Kr,{value:e._id,children:"".concat(e.nombre," ").concat(e.apellidos)},t)})):Object(r.jsx)(Kr,{children:"Sin data"})}),Object(r.jsx)(U.a,{icon:y?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)($t.a,{}),onClick:function(){return Ae("gestor")},children:"Asignar"}),Object(r.jsx)("p",{children:"Asignar Auditor:"}),Object(r.jsx)(Ke.a,{showSearch:!0,placeholder:"Buscar por nombre",loading:l,defaultValue:ee,onChange:function(e){return te(e)},style:{width:300,marginBottom:".5rem",marginRight:".5rem"},filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},children:s.length>0?s.map((function(e,t){return Object(r.jsx)(Kr,{value:e._id,children:"".concat(e.nombre," ").concat(e.apellidos)},t)})):Object(r.jsx)(Kr,{children:"Sin data"})}),Object(r.jsx)(U.a,{icon:A?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)($t.a,{}),onClick:function(){return Ae("auditor")},children:"Asignar"})]}),Object(r.jsxs)(M.a,{sm:12,children:[Object(r.jsx)("p",{children:"Asignar Tipo de Negocio:"}),Object(r.jsx)(Ke.a,{placeholder:"Buscar Tipo de Negocio",defaultValue:ae,onChange:function(e){return ie(e)},style:{width:300,marginBottom:".5rem",marginRight:".5rem"},children:xn.map((function(e){return Object(r.jsx)(Kr,{value:e.value,children:e.text},e.value)}))}),Object(r.jsx)(U.a,{icon:N?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)($t.a,{}),onClick:function(){return Ae("negocio")},children:"Asignar"}),Object(r.jsx)("p",{children:"Asignar Subtipo de Negocio:"}),Object(r.jsx)(Ke.a,{placeholder:"Buscar Subtipo de Negocio",defaultValue:se,onChange:function(e){return le(e)},style:{width:300,marginBottom:".5rem",marginRight:".5rem"},children:mn.map((function(e){return Object(r.jsx)(Kr,{value:e.value,children:e.text},e.value)}))}),Object(r.jsx)(U.a,{icon:z?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)($t.a,{}),onClick:function(){return Ae("subNegocio")},children:"Asignar"})]})]}),Object(r.jsx)(In.a,{title:function(){return Object(r.jsxs)("div",{children:[Object(r.jsxs)(Ze.a.Group,{size:"small",value:ye,onChange:function(e){return Se(e.target.value)},children:[Object(r.jsx)(Ze.a,{value:"nombre",children:"Nombre"}),Object(r.jsx)(Ze.a,{value:"apellidos",children:"Apellidos"}),Object(r.jsx)(Ze.a,{value:"carnet",children:"Carnet"})]}),Object(r.jsx)(Jr,{onChange:De,placeholder:"Buscar ".concat(Bn(ye)),allowClear:!0,size:"small",style:{width:200}})]})},rowKey:"_id",size:"small",dataSource:p,loading:m,columns:Ne,rowSelection:{columnWidth:30,selectedRowKeys:V,onChange:function(e){return K(e)}},pagination:{defaultPageSize:20,pageSizeOptions:[20,50,100]},scroll:{y:"60vh"},footer:function(){return Object(r.jsx)(U.a,{onClick:Ee,children:"Exportar"})}})]})};var Xr=n(673),Qr=n(674),$r=n(675),ea=n(671),ta=n(672),na=n(311),ra=n.n(na),aa=function(){var e=Object(P.a)(B.a.mark((function e(t){var n,r,a,i,o,c;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.metodo,r=t.tipo,a=t.page,i=t.limit,o=t.fecha_inicio,c=t.fecha_fin,e.abrupt("return",Q({url:"asistencia",method:"GET",params:{metodo:n,tipo:r,page:a,limit:i,fecha_inicio:o,fecha_fin:c}},!0));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ia=function(){var e=Object(P.a)(B.a.mark((function e(t){var n,r,a,i,o;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,r=t.tipo,a=t.estado,i=t.fecha,o=t.observacion,e.abrupt("return",Q({url:"asistencia",method:"POST",data:{id:n,tipo:r,estado:a,fecha:i,observacion:o}},!0));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oa=function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Q({url:"asistencia",method:"PATCH",data:t},!0));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function ca(){return sa.apply(this,arguments)}function sa(){return(sa=Object(P.a)(B.a.mark((function e(){var t,n=arguments;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:[],e.abrupt("return",new Promise((function(e,n){try{var r=[];return 0===t.length||t.forEach((function(e){if(r.length>0){var t=r.findIndex((function(t){return t.nombre===e.tecnico.nombre&&t.apellidos===e.tecnico.apellidos}));if(-1!==t&&e.fecha_registro){var n=r[t],a=Qe()(e.fecha_registro).format("DD-MM");r[t]=Object(c.a)(Object(c.a)({},n),{},Object(Ue.a)({},a,{_id:e._id,estado:e.estado,observacion:e.observacion,iniciado:e.iniciado,fecha_iniciado:e.fecha_iniciado}))}else{var i=Qe()(e.fecha_registro).format("DD-MM"),o=Object(Ue.a)({_id:e._id,estado_empresa:e.tecnico.estado_empresa,tipo_negocio:e.tecnico.tipo_negocio,sub_tipo_negocio:e.tecnico.sub_tipo_negocio,nombre:e.tecnico.nombre,apellidos:e.tecnico.apellidos,carnet:e.tecnico.carnet,dni:e.tecnico.numero_documento,tipo:e.tipo,idEmpleado:e.tecnico._id,gestor:{nombre:e.tecnico.gestor?e.tecnico.gestor.nombre:"-",apellidos:e.tecnico.gestor?e.tecnico.gestor.apellidos:"-",_id:e.tecnico.gestor?e.tecnico.gestor._id:"-"},auditor:{nombre:e.tecnico.auditor?e.tecnico.auditor.nombre:"-",apellidos:e.tecnico.auditor?e.tecnico.auditor.apellidos:"-",_id:e.tecnico.auditor?e.tecnico.auditor._id:"-"},contrata:{nombre:e.tecnico.contrata?e.tecnico.contrata.nombre:"-",_id:e.tecnico.contrata?e.tecnico.contrata._id:"-"},observacion:e.observacion},i,{_id:e._id,estado:e.estado,observacion:e.observacion,iniciado:e.iniciado,fecha_iniciado:e.fecha_iniciado});r.push(o)}}else{var s=Qe()(e.fecha_registro).format("DD-MM");r=[Object(Ue.a)({_id:e._id,estado_empresa:e.tecnico.estado_empresa,tipo_negocio:e.tecnico.tipo_negocio,sub_tipo_negocio:e.tecnico.sub_tipo_negocio,nombre:e.tecnico.nombre,apellidos:e.tecnico.apellidos,carnet:e.tecnico.carnet,dni:e.tecnico.numero_documento,tipo:e.tipo,idEmpleado:e.tecnico._id,gestor:{nombre:e.tecnico.gestor?e.tecnico.gestor.nombre:"-",apellidos:e.tecnico.gestor?e.tecnico.gestor.apellidos:"-",_id:e.tecnico.gestor?e.tecnico.gestor._id:"-"},auditor:{nombre:e.tecnico.auditor?e.tecnico.auditor.nombre:"-",apellidos:e.tecnico.auditor?e.tecnico.auditor.apellidos:"-",_id:e.tecnico.auditor?e.tecnico.auditor._id:"-"},contrata:{nombre:e.tecnico.contrata?e.tecnico.contrata.nombre:"-",_id:e.tecnico.contrata?e.tecnico.contrata._id:"-"},observacion:e.observacion},s,{_id:e._id,estado:e.estado,observacion:e.observacion,iniciado:e.iniciado,fecha_iniciado:e.fecha_iniciado})]}})),e(r)}catch(a){return n(a)}})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function la(){return da.apply(this,arguments)}function da(){return(da=Object(P.a)(B.a.mark((function e(){var t,n=arguments;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:[],e.abrupt("return",new Promise((function(e,n){try{var r=[];return 0===t.length||t.forEach((function(e){if(r.length>0){var t=r.findIndex((function(t){return t.nombre===e.gestor.nombre&&t.apellidos===e.gestor.apellidos}));if(-1!==t&&e.fecha_registro){var n=r[t],a=Qe()(e.fecha_registro).format("DD-MM");r[t]=Object(c.a)(Object(c.a)({},n),{},Object(Ue.a)({},a,{_id:e._id,estado:e.estado,observacion:e.observacion,iniciado:e.iniciado,fecha_iniciado:e.fecha_iniciado}))}else{var i=Qe()(e.fecha_registro).format("DD-MM"),o=Object(Ue.a)({_id:e._id,estado_empresa:e.gestor.estado_empresa,nombre:e.gestor.nombre,apellidos:e.gestor.apellidos,observacion:e.observacion,tipo:e.tipo,idEmpleado:e.gestor._id},i,{_id:e._id,estado:e.estado,observacion:e.observacion,iniciado:e.iniciado,fecha_iniciado:e.fecha_iniciado});r.push(o)}}else{var s=Qe()(e.fecha_registro).format("DD-MM");r=[Object(Ue.a)({_id:e._id,estado_empresa:e.gestor.estado_empresa,nombre:e.gestor.nombre,apellidos:e.gestor.apellidos,observacion:e.observacion,tipo:e.tipo,idEmpleado:e.gestor._id},s,{_id:e._id,estado:e.estado,observacion:e.observacion,iniciado:e.iniciado,fecha_iniciado:e.fecha_iniciado})]}})),e(r)}catch(a){return n(a)}})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ua(){return ba.apply(this,arguments)}function ba(){return(ba=Object(P.a)(B.a.mark((function e(){var t,n=arguments;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:[],e.abrupt("return",new Promise((function(e,n){try{var r=[];return 0===t.length||t.forEach((function(e){if(r.length>0){var t=r.findIndex((function(t){return t.nombre===e.auditor.nombre&&t.apellidos===e.auditor.apellidos}));if(-1!==t&&e.fecha_registro){var n=r[t],a=Qe()(e.fecha_registro).format("DD-MM");r[t]=Object(c.a)(Object(c.a)({},n),{},Object(Ue.a)({},a,{_id:e._id,estado:e.estado,observacion:e.observacion,iniciado:e.iniciado,fecha_iniciado:e.fecha_iniciado}))}else{var i=Qe()(e.fecha_registro).format("DD-MM"),o=Object(Ue.a)({_id:e._id,estado_empresa:e.auditor.estado_empresa,nombre:e.auditor.nombre,apellidos:e.auditor.apellidos,observacion:e.observacion,tipo:e.tipo,idEmpleado:e.auditor._id},i,{_id:e._id,estado:e.estado,observacion:e.observacion,iniciado:e.iniciado,fecha_iniciado:e.fecha_iniciado});r.push(o)}}else{var s=Qe()(e.fecha_registro).format("DD-MM");r=[Object(Ue.a)({_id:e._id,estado_empresa:e.auditor.estado_empresa,nombre:e.auditor.nombre,apellidos:e.auditor.apellidos,observacion:e.observacion,tipo:e.tipo,idEmpleado:e.auditor._id},s,{_id:e._id,estado:e.estado,observacion:e.observacion,iniciado:e.iniciado,fecha_iniciado:e.fecha_iniciado})]}})),e(r)}catch(a){return n(a)}})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var fa={FALTA:"F",ASISTIO:"A",TARDANZA:"T",DESCANSO:"D",PERMISO:"P",SUSPENDIDO:"S",DESCANSO_MEDICO:"DM",EXAMEN_MEDICO:"EM",VACACIONES:"V",BAJA:"BAJA",GUARDIA:"GUARDIA"},ja=n(669),ha=Ke.a.Option,pa=V.a.TextArea,Oa=Le.a.Text;var ga=function(e){var t=e.actualizar,n=e.row,i=e.fecha,o=e.visible,c=e.abrir,s=Object(a.useState)(!1),l=Object(I.a)(s,2),d=l[0],u=l[1],b=Object(a.useState)(null),f=Object(I.a)(b,2),j=f[0],h=f[1],p=Object(a.useState)(null),O=Object(I.a)(p,2),g=O[0],x=O[1];function m(){return(m=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Qe()(i).isValid()&&n.idEmpleado&&j)){e.next=7;break}return u(!0),e.next=4,ia({id:n.idEmpleado,tipo:n.tipo,estado:j,fecha:i,observacion:g}).catch((function(e){return console.log(e)})).finally((function(){u(!1),c(),t()}));case 4:return e.abrupt("return",e.sent);case 7:F.a.warn("No hay una fecha valida o no se encontr\xf3 el id",{position:"top-right"}),console.log(i,n);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){h(null),x(null)}),[]),Object(r.jsxs)(kn.a,{title:"Actualizar el estado de la asistencia",onCancel:c,visible:o,width:350,centered:!0,destroyOnClose:!0,footer:[Object(r.jsx)(U.a,{onClick:c,children:"Cancelar"},"back"),Object(r.jsx)(U.a,{icon:d?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ja.a,{}),disabled:d,type:"primary",onClick:function(){return m.apply(this,arguments)},children:"Aceptar"},"submit")],children:[Qe()(i).isValid()?Object(r.jsxs)(Oa,{type:"secondary",children:["Fecha: ",Qe()(i).format("DD-MM-YY")]}):Object(r.jsx)(Oa,{type:"danger",children:"Fecha Invalida."}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("p",{children:"Seleccionar Estado:"}),Object(r.jsxs)(Ke.a,{placeholder:"Estado",defaultValue:j,onChange:function(e){return h(e)},style:{width:300,marginBottom:".5rem",marginRight:".5rem"},children:[Object(r.jsx)(ha,{value:fa.ASISTIO,children:"Asisti\xf3"}),Object(r.jsx)(ha,{value:fa.FALTA,children:"Falta"}),Object(r.jsx)(ha,{value:fa.TARDANZA,children:"Tardanza"}),Object(r.jsx)(ha,{value:fa.DESCANSO,children:"Descanso"}),Object(r.jsx)(ha,{value:fa.GUARDIA,children:"Guardia"}),Object(r.jsx)(ha,{value:fa.PERMISO,children:"Permiso"}),Object(r.jsx)(ha,{value:fa.DESCANSO_MEDICO,children:"Descanso M\xe9dico"}),Object(r.jsx)(ha,{value:fa.EXAMEN_MEDICO,children:"Examen M\xe9dico"}),Object(r.jsx)(ha,{value:fa.SUSPENDIDO,children:"Suspendido"}),Object(r.jsx)(ha,{value:fa.VACACIONES,children:"Vacaciones"}),Object(r.jsx)(ha,{value:fa.BAJA,children:"Baja"})]}),Object(r.jsx)("p",{children:"Observaci\xf3n:"}),Object(r.jsx)(pa,{placeholder:"Observaci\xf3n...",rows:4,value:g,onChange:function(e){return x(e.target.value)}})]})};var xa=function(e){var t=e.actualizar,n=e.row,i=e.fecha,o=e.estado,c=Object(a.useState)(!1),s=Object(I.a)(c,2),l=s[0],d=s[1],u=function(){return d(!l)};switch(o){case fa.FALTA:return Object(r.jsx)(Cn.a,{color:"error",children:o});case fa.ASISTIO:return Object(r.jsx)(Cn.a,{color:"success",children:o});case fa.TARDANZA:return Object(r.jsx)(Cn.a,{color:"lime",children:o});case fa.DESCANSO:return Object(r.jsx)(Cn.a,{color:"gold",children:o});case fa.GUARDIA:return Object(r.jsx)(Cn.a,{color:"cyan",children:o});case fa.PERMISO:return Object(r.jsx)(Cn.a,{color:"blue",children:o});case fa.SUSPENDIDO:return Object(r.jsx)(Cn.a,{color:"warning",children:o});case fa.DESCANSO_MEDICO:return Object(r.jsx)(Cn.a,{color:"geekblue",children:o});case fa.EXAMEN_MEDICO:return Object(r.jsx)(Cn.a,{color:"purple",children:o});case fa.VACACIONES:return Object(r.jsx)(Cn.a,{color:"pink",children:o});case fa.BAJA:return Object(r.jsx)(Cn.a,{color:"volcano",children:o});default:return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Cn.a,{onClick:function(){return u()},style:{cursor:"pointer"},children:"-"}),Object(r.jsx)(ga,{actualizar:t,row:n,fecha:Qe()("".concat(i,"-2021"),"DD-MM-YYYY").toDate(),visible:l,abrir:u})]})}},ma=Ke.a.Option,va=V.a.TextArea;var _a=function(e){var t=e.visible,n=e.abrir,i=e.loadingActualizar,o=e.actualizar,c=Object(a.useState)(null),s=Object(I.a)(c,2),l=s[0],d=s[1],u=Object(a.useState)(null),b=Object(I.a)(u,2),f=b[0],j=b[1];function h(){return(h=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===l){e.next=5;break}return e.next=3,o(l,f);case 3:e.next=6;break;case 5:F.a.warn("No hay usuario seleccionado.",{position:"top-right"});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){d(null),j(null)}),[]),Object(r.jsxs)(kn.a,{title:"Actualizar el estado de la asistencia",visible:t,width:350,centered:!0,destroyOnClose:!0,footer:[Object(r.jsx)(U.a,{onClick:n,children:"Cancelar"},"back"),Object(r.jsx)(U.a,{icon:i?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ja.a,{}),type:"primary",onClick:function(){return h.apply(this,arguments)},children:"Aceptar"},"submit")],children:[Object(r.jsx)("p",{children:"Seleccionar Estado:"}),Object(r.jsxs)(Ke.a,{placeholder:"Estado",defaultValue:l,onChange:function(e){return d(e)},style:{width:300,marginBottom:".5rem",marginRight:".5rem"},children:[Object(r.jsx)(ma,{value:fa.ASISTIO,children:"Asisti\xf3"}),Object(r.jsx)(ma,{value:fa.TARDANZA,children:"Tardanza"}),Object(r.jsx)(ma,{value:fa.FALTA,children:"Falta"}),Object(r.jsx)(ma,{value:fa.DESCANSO,children:"Descanso"}),Object(r.jsx)(ma,{value:fa.GUARDIA,children:"Guardia"}),Object(r.jsx)(ma,{value:fa.PERMISO,children:"Permiso"}),Object(r.jsx)(ma,{value:fa.DESCANSO_MEDICO,children:"Descanso M\xe9dico"}),Object(r.jsx)(ma,{value:fa.EXAMEN_MEDICO,children:"Examen M\xe9dico"}),Object(r.jsx)(ma,{value:fa.SUSPENDIDO,children:"Suspendido"}),Object(r.jsx)(ma,{value:fa.VACACIONES,children:"Vacaciones"}),Object(r.jsx)(ma,{value:fa.BAJA,children:"Baja"})]}),Object(r.jsx)("p",{children:"Observaci\xf3n:"}),Object(r.jsx)(va,{placeholder:"Observaci\xf3n...",rows:4,value:f,onChange:function(e){return j(e.target.value)}})]})},wa=n(15),ya=n(670);var Sa=function(e){var t=e.data,n=void 0===t?[]:t,i=e.dias,o=void 0===i?[]:i,s=e.nombre,l=Object(a.useRef)(null),d=function(e){switch(e){case fa.FALTA:case"Inactivo":return{background:rr.red[1],color:rr.red.primary};case fa.ASISTIO:return{background:rr.green[1],color:rr.green.primary};case fa.TARDANZA:return{background:rr.lime[1],color:rr.lime.primary};case fa.DESCANSO:return{background:rr.gold[1],color:rr.gold.primary};case fa.PERMISO:return{background:rr.blue[1],color:rr.blue.primary};case fa.GUARDIA:return{background:rr.cyan[1],color:rr.cyan.primary};case fa.SUSPENDIDO:return{background:rr.yellow[1],color:rr.yellow.primary};case fa.DESCANSO_MEDICO:return{background:rr.geekblue[1],color:rr.geekblue.primary};case fa.EXAMEN_MEDICO:return{background:rr.purple[1],color:rr.purple.primary};case fa.VACACIONES:return{background:rr.orange[1],color:rr.orange.primary};case fa.BAJA:return{background:rr.volcano[1],color:rr.volcano.primary};default:return{background:"",color:""}}},u={background:"#5DADE2",bold:!0,fontSize:17,wrap:!1,autoWidth:!0};return Object(r.jsxs)("div",{children:[Object(r.jsx)(U.a,{icon:Object(r.jsx)(ya.a,{}),type:"primary",onClick:function(){!function(e){try{var t=e.workbookOptions(),n=t.sheets[0].rows,r=-1,a=[];n.forEach((function(e){"header"===e.type&&(r=e.cells.findIndex((function(e){return"Estado"===e.value})),e.cells.forEach((function(e,t){var n=Qe()("".concat(e.value,"-2021"),"DD-MM-YYYY");Qe()().isValid()&&(Qe()().diff(n,"days")>=0&&a.push(t))}))),"data"===e.type&&(r>-1&&"INACTIVO"===String(e.cells[r].value).toUpperCase()&&a.length>0&&a.forEach((function(t){e.cells[t].value||(e.cells[t].value="BAJA")})),e.cells.forEach((function(e){e.value=e.value?String(e.value).toUpperCase():e.value,e.background=d(e.value).background,e.color=d(e.value).color,e.borderBottom={size:1},e.borderLeft={size:1},e.borderRight={size:1},e.borderTop={size:1}})))})),e.save(t)}catch(i){console.log(i)}}(l.current)},children:"Exportar"}),Object(r.jsxs)(wa.a,{data:n.map((function(e){return Object(c.a)(Object(c.a)({},e),{},{cargo:Bn(s)})})),fileName:"asistencia_".concat(s,"_").concat(Qe()().format("DD_MM_YYYY"),".xlsx"),ref:l,children:[Object(r.jsx)(wa.b,{field:"nombre",title:"Nombre",locked:!0,width:170,headerCellOptions:u}),Object(r.jsx)(wa.b,{field:"apellidos",title:"Apellidos",locked:!0,width:150,headerCellOptions:u}),Object(r.jsx)(wa.b,{field:"carnet",title:"Carnet",locked:!0,width:150,headerCellOptions:u}),Object(r.jsx)(wa.b,{field:"dni",title:"DNI",width:150,headerCellOptions:u}),Object(r.jsx)(wa.b,{field:"estado_empresa",title:"Estado",width:90,headerCellOptions:u}),Object(r.jsx)(wa.b,{field:"cargo",title:"Cargo",width:90,headerCellOptions:u}),Object(r.jsx)(wa.b,{field:"contrata.nombre",title:"Contrata",width:170,headerCellOptions:u}),Object(r.jsx)(wa.b,{field:"auditor.apellidos",title:"Auditor",width:170,headerCellOptions:u}),Object(r.jsx)(wa.b,{field:"gestor.apellidos",title:"Gestor",width:170,headerCellOptions:u}),Object(r.jsx)(wa.b,{field:"tipo_negocio",title:"Negocio",width:90,headerCellOptions:u}),Object(r.jsx)(wa.b,{field:"sub_tipo_negocio",title:"Sub Negocio",width:90,headerCellOptions:u}),o&&o.length>0?o.map((function(e,t){return Object(r.jsx)(wa.b,{field:"".concat(e,".estado"),title:"".concat(e),width:60,headerCellOptions:u,cellOptions:{textAlign:"center"}},t)})):null]})]})},Ca=We.a.RangePicker;function ka(){var e=Object(a.useState)(Qe()().startOf("week")),t=Object(I.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)(Qe()().endOf("week")),s=Object(I.a)(o,2),l=s[0],d=s[1],u=Object(a.useState)([]),b=Object(I.a)(u,2),f=b[0],j=b[1],h=Object(a.useState)(null),p=Object(I.a)(h,2),O=p[0],g=p[1],x=Object(a.useState)([]),m=Object(I.a)(x,2),v=m[0],_=m[1],w=Object(a.useState)(!1),y=Object(I.a)(w,2),S=y[0],C=y[1],k=Object(a.useState)(!1),A=Object(I.a)(k,2),T=A[0],E=A[1],D=Object(a.useState)([]),N=Object(I.a)(D,2),q=N[0],L=N[1],z=Object(a.useState)([]),G=Object(I.a)(z,2),Y=G[0],H=G[1],K=Object(a.useState)([]),J=Object(I.a)(K,2),W=J[0],Z=J[1],X=Object(a.useState)({total:0,activas:0}),Q=Object(I.a)(X,2),$=Q[0],ee=Q[1],te=Object(a.useState)({total:0,activas:0}),ne=Object(I.a)(te,2),re=ne[0],ae=ne[1],ie=Object(a.useState)({total:0,activas:0}),oe=Object(I.a)(ie,2),ce=oe[0],se=oe[1],le=Object(a.useState)(!1),de=Object(I.a)(le,2),be=de[0],fe=de[1],je=Object(a.useState)(null),he=Object(I.a)(je,2),pe=he[0],Oe=he[1],ge=Object(a.useState)(""),xe=Object(I.a)(ge,2),me=xe[0],ve=xe[1],_e=Object(a.useState)(""),we=Object(I.a)(_e,2),ye=we[0],Se=we[1],Ce=Object(a.useRef)(null);function ke(){return Ie.apply(this,arguments)}function Ie(){return(Ie=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n||!l){e.next=6;break}return C(!0),e.next=4,aa({metodo:Ut,tipo:"tecnico",fecha_inicio:n.toDate(),fecha_fin:l.toDate()}).then(function(){var e=Object(P.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,e.next=3,ca(n.filter((function(e){return null!==e.tecnico})));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){e&&e.length>0?(_(e),L(Vr(e,"gestor",!0)),H(Vr(e,"auditor",!0)),Z(Vr(e,"contrata",!0)),ee(qe(e.filter((function(e){return e.estado_empresa===hr.ACTIVO&&"averias"===e.tipo_negocio&&["hfc","gpon"].includes(e.sub_tipo_negocio)})))),ae(qe(e.filter((function(e){return e.estado_empresa===hr.ACTIVO&&"altas"===e.tipo_negocio&&["hfc","gpon"].includes(e.sub_tipo_negocio)})))),se(qe(e.filter((function(e){return e.estado_empresa===hr.ACTIVO&&"gpon"===e.sub_tipo_negocio&&"altas"===e.tipo_negocio}))))):F.a.warn("No se encontraron registros.",{position:"top-right"})})).catch((function(e){return console.log(e)})).finally((function(){return C(!1)}));case 4:e.next=7;break;case 6:F.a.warn("Debes seleccionar un rango de fechas primero.",{position:"top-right"});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ae(){return(Ae=Object(P.a)(B.a.mark((function e(t,n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E(!0),e.next=3,oa({id:pe,estado:t,observacion:n}).catch((function(e){return console.log(e)})).finally((function(){E(!1),fe(!1),ke()}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){De([Qe()().startOf("week"),Qe()().endOf("week")])}),[]),Object(a.useEffect)((function(){ke()}),[n,l]),Object(a.useEffect)((function(){!function(){var e=Qe()().format("DD-MM");if(f.length>0){var t=[{title:"#",width:50,align:"center",render:function(e,t,n){return n+1}},Object(c.a)({title:"Tecnico",dataIndex:"nombre",width:250,ellipsis:!0},Ne("nombre")),{title:"Gestor",dataIndex:"gestor",filters:q,onFilter:function(e,t){return!(!t.gestor||!e)&&0===t.gestor._id.indexOf(e)},ellipsis:!0,width:200,render:function(e){return e.nombre?e.nombre+" "+e.apellidos:"-"}},{title:"Auditor",dataIndex:"auditor",filters:Y,onFilter:function(e,t){return!(!t.auditor||!e)&&0===t.auditor._id.indexOf(e)},ellipsis:!0,width:200,render:function(e){return e.nombre?e.nombre+" "+e.apellidos:"-"}},{title:"Contrata",dataIndex:"contrata",filters:W,onFilter:function(e,t){return!!(t&&t.contrata&&e)&&0===t.contrata._id.indexOf(e)},ellipsis:!0,width:200,render:function(e){return e&&e.nombre?e.nombre:"-"}},{title:"En Ruta",dataIndex:e,width:100,align:"center",filters:[{text:"Ok",value:!0},{text:"No",value:!1}],onFilter:function(t,n){return!!n[e]&&(!n[e].iniciado&&!t||n[e].iniciado===t)},render:function(e){return e?e.iniciado?Object(r.jsx)(Te.a,{content:e.fecha_iniciado?Qe()(e.fecha_iniciado).format("HH:mm"):"-",title:"Fecha Iniciado",trigger:"click",children:Object(r.jsx)("button",{className:"boton-none",children:Object(r.jsx)(Cn.a,{color:tn.success,children:Object(r.jsx)($t.a,{})})})}):Object(r.jsx)(Cn.a,{color:tn.error,children:Object(r.jsx)(jr.a,{})}):Object(r.jsx)(Cn.a,{color:"error",children:"BAJA"})}}],n=f.map((function(e){return{title:e,width:60,align:"center",dataIndex:e,render:function(t,n){return t&&t.estado&&t.observacion?Object(r.jsx)(Te.a,{content:Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:t.observacion}),Object(r.jsx)(U.a,{type:"primary",onClick:function(){return t=n[e]._id,Ee(),void Oe(t);var t},size:"small",children:"Editar"})]}),title:"Observaciones",placement:"topRight",trigger:"click",destroyTooltipOnHide:!0,children:Object(r.jsx)("button",{className:"boton-none",children:Object(r.jsx)(xa,{actualizar:ke,row:n,fecha:e,estado:t.estado})})}):Object(r.jsx)(xa,{actualizar:ke,row:n,fecha:e,estado:t&&t.estado_empresa?t.estado_empresa:n.estado_empresa===hr.INACTIVO?"BAJA":"-"})}}}));g([].concat(t,Object(ue.a)(n)))}else g([])}()}),[f,q]);var Ee=function(){return fe(!be)};function De(e){if(e&&e.length>1){var t=Qe()(e[1].toDate()).diff(e[0].toDate(),"days");i(e[0]),d(e[1]);for(var n=[],r=0;r<=t;r++)n.push(Qe()(e[0].toDate()).add(r,"days").format("DD-MM"));j(n)}else i(Qe()().startOf("week")),d(Qe()().endOf("week"))}var Ne=function(e){return{filterDropdown:function(t){var n=t.setSelectedKeys,a=t.selectedKeys,i=t.confirm,o=t.clearFilters;return Object(r.jsxs)("div",{style:{padding:8},children:[Object(r.jsx)(V.a,{ref:function(e){Ce=e},placeholder:"Buscar ".concat(e),value:a[0],onChange:function(e){return n(e.target.value?[e.target.value]:[])},onPressEnter:function(){return Re(a,i,e)},style:{width:188,marginBottom:8,display:"block"}}),Object(r.jsxs)(Je.b,{children:[Object(r.jsx)(U.a,{type:"primary",onClick:function(){return Re(a,i,e)},icon:Object(r.jsx)(ea.a,{}),size:"small",style:{width:90},children:"Buscar"}),Object(r.jsx)(U.a,{onClick:function(){return Me(o)},size:"small",style:{width:90},children:"Reiniciar"})]})]})},filterIcon:function(e){return Object(r.jsx)(ea.a,{style:{color:e?"#1890ff":void 0}})},onFilter:function(t,n){return n[e]?n[e].toString().toLowerCase().includes(t.toLowerCase()):""},onFilterDropdownVisibleChange:function(e){e&&setTimeout((function(){return Ce.select()}),100)},render:function(t,n){return ye===e?Object(r.jsx)(ra.a,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[me],autoEscape:!0,textToHighlight:t?t.toString()+" "+(n.apellidos?n.apellidos:""):""}):t+" "+(n.apellidos?n.apellidos:"")}}},Re=function(e,t,n){t(),ve(e[0]),Se(n)},Me=function(e){e(),ve("")};function qe(e){var t=0,n=0,r=Qe()().format("DD-MM");return e.length>0&&e.forEach((function(e){e[r]&&e[r].estado&&(t+=1,e[r].iniciado&&(n+=1))})),{total:t,activas:n}}return Object(r.jsxs)("div",{children:[Object(r.jsxs)(R.a,{children:[Object(r.jsxs)(M.a,{sm:24,style:{marginBottom:".5rem"},children:[Object(r.jsx)("p",{style:{color:"rgba(0,0,0,0.45)"},children:"Seleccionar Fecha:"}),Object(r.jsx)(Ca,{style:{marginRight:".5rem"},onChange:De,value:[Qe()(n),Qe()(l)]}),Object(r.jsx)(U.a,{disabled:S,icon:S?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ta.a,{}),onClick:ke,children:"Actualizar"})]}),Object(r.jsx)(M.a,{sm:6,style:{marginBottom:"1rem",marginRight:".5rem"},children:Object(r.jsx)(Qt.a,{title:"Semana selecionada",value:n&&l?"".concat(Qe()(n).format("DD-MM")," / ").concat(Qe()(l).format("DD-MM")):"-"})}),Object(r.jsx)(M.a,{sm:4,style:{marginBottom:"1rem",marginRight:".5rem"},children:Object(r.jsx)(Qt.a,{title:"Rutas Activas (Averias)",value:$.activas,suffix:"/ ".concat($.total)})}),Object(r.jsx)(M.a,{sm:4,style:{marginBottom:"1rem",marginRight:".5rem"},children:Object(r.jsx)(Qt.a,{title:"Rutas Activas (Altas)",value:re.activas,suffix:"/ ".concat(re.total)})}),Object(r.jsx)(M.a,{sm:4,style:{marginBottom:"1rem",marginRight:".5rem"},children:Object(r.jsx)(Qt.a,{title:"Rutas Activas (GPON)",value:ce.activas,suffix:"/ ".concat(ce.total)})})]}),Object(r.jsx)(In.a,{rowKey:"_id",size:"small",loading:S,columns:null!==O&&0!==O.length?O:[{title:"#",width:50,align:"center",render:function(e,t,n){return n+1}},{title:"Tecnico",width:200},{title:"Gestor",width:200},{title:"Fecha",width:100}],dataSource:v,pagination:{defaultPageSize:50},scroll:{x:"1100px",y:"70vh"},footer:function(){return Object(r.jsx)(Sa,{data:v,dias:f,nombre:"tecnico"})}}),Object(r.jsx)(_a,{visible:be,abrir:Ee,loadingActualizar:T,actualizar:function(e,t){return Ae.apply(this,arguments)}})]})}var Ia=function(e){var t=e.data,n=void 0===t?[]:t,i=e.dias,o=void 0===i?[]:i,s=e.nombre,l=Object(a.useRef)(null),d=function(e){switch(e){case fa.FALTA:case"Inactivo":return{background:rr.red[1],color:rr.red.primary};case fa.ASISTIO:return{background:rr.green[1],color:rr.green.primary};case fa.TARDANZA:return{background:rr.lime[1],color:rr.lime.primary};case fa.DESCANSO:return{background:rr.gold[1],color:rr.gold.primary};case fa.PERMISO:return{background:rr.blue[1],color:rr.blue.primary};case fa.GUARDIA:return{background:rr.cyan[1],color:rr.cyan.primary};case fa.SUSPENDIDO:return{background:rr.yellow[1],color:rr.yellow.primary};case fa.DESCANSO_MEDICO:return{background:rr.geekblue[1],color:rr.geekblue.primary};case fa.EXAMEN_MEDICO:return{background:rr.purple[1],color:rr.purple.primary};case fa.VACACIONES:return{background:rr.orange[1],color:rr.orange.primary};case fa.BAJA:return{background:rr.volcano[1],color:rr.volcano.primary};default:return{background:"",color:""}}},u={background:"#5DADE2",bold:!0,fontSize:17,wrap:!0,autoWidth:!0};return Object(r.jsxs)("div",{children:[Object(r.jsx)(U.a,{icon:Object(r.jsx)(ya.a,{}),type:"primary",onClick:function(){!function(e){try{var t=e.workbookOptions(),n=t.sheets[0].rows,r=-1,a=[];n.forEach((function(e){"header"===e.type&&(r=e.cells.findIndex((function(e){return"Estado"===e.value})),e.cells.forEach((function(e,t){var n=Qe()("".concat(e.value,"-2021"),"DD-MM-YYYY");Qe()().isValid()&&(Qe()().diff(n,"days")>=0&&a.push(t))}))),"data"===e.type&&(r>-1&&"INACTIVO"===String(e.cells[r].value).toUpperCase()&&a.length>0&&a.forEach((function(t){e.cells[t].value||(e.cells[t].value="BAJA")})),e.cells.forEach((function(e){e.value=e.value?String(e.value).toUpperCase():e.value,e.background=d(e.value).background,e.color=d(e.value).color,e.borderBottom={size:1},e.borderLeft={size:1},e.borderRight={size:1},e.borderTop={size:1}})))})),e.save(t)}catch(i){console.log(i)}}(l.current)},children:"Exportar"}),Object(r.jsxs)(wa.a,{data:n.map((function(e){return Object(c.a)(Object(c.a)({},e),{},{cargo:Bn(s)})})),fileName:"asistencia_".concat(s,"_").concat(Qe()().format("DD_MM_YYYY"),".xlsx"),ref:l,children:[Object(r.jsx)(wa.b,{field:"nombre",title:"Nombre",locked:!0,width:170,headerCellOptions:u}),Object(r.jsx)(wa.b,{field:"apellidos",title:"Apellidos",locked:!0,headerCellOptions:u}),Object(r.jsx)(wa.b,{field:"estado_empresa",title:"Estado",width:90,headerCellOptions:u}),Object(r.jsx)(wa.b,{field:"cargo",title:"Cargo",width:90,headerCellOptions:u}),o&&o.length>0?o.map((function(e,t){return Object(r.jsx)(wa.b,{field:"".concat(e,".estado"),title:"".concat(e),width:60,headerCellOptions:u,cellOptions:{textAlign:"center"}},t)})):null]})]})},Aa=We.a.RangePicker;function Ta(){var e=Object(a.useState)(Qe()().startOf("week")),t=Object(I.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)(Qe()().endOf("week")),c=Object(I.a)(o,2),s=c[0],l=c[1],d=Object(a.useState)([]),u=Object(I.a)(d,2),b=u[0],f=u[1],j=Object(a.useState)(null),h=Object(I.a)(j,2),p=h[0],O=h[1],g=Object(a.useState)([]),x=Object(I.a)(g,2),m=x[0],v=x[1],_=Object(a.useState)(!1),w=Object(I.a)(_,2),y=w[0],S=w[1],C=Object(a.useState)(!1),k=Object(I.a)(C,2),A=k[0],T=k[1],E=Object(a.useState)(!1),D=Object(I.a)(E,2),N=D[0],q=D[1],F=Object(a.useState)(null),L=Object(I.a)(F,2),z=L[0],G=L[1];function Y(){return H.apply(this,arguments)}function H(){return(H=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n||!s){e.next=4;break}return S(!0),e.next=4,aa({metodo:Ut,tipo:"gestor",fecha_inicio:n.toDate(),fecha_fin:s.toDate()}).then(function(){var e=Object(P.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,e.next=3,la(n.filter((function(e){return null!==e.gestor})));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){e&&e.length>0&&v(e)})).catch((function(e){return console.log(e)})).finally((function(){return S(!1)}));case 4:case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){return(V=Object(P.a)(B.a.mark((function e(t,n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T(!0),e.next=3,oa({id:z,estado:t,observacion:n}).catch((function(e){return console.log(e)})).finally((function(){T(!1),q(!1),Y()}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){J([Qe()().startOf("week"),Qe()().endOf("week")])}),[]),Object(a.useEffect)((function(){Y()}),[n,s]),Object(a.useEffect)((function(){!function(){if(b.length>0){var e=[{title:"#",width:50,align:"center",render:function(e,t,n){return n+1}},{title:"Gestor",dataIndex:"gestor",width:450,render:function(e,t){return t.nombre+" "+t.apellidos}}],t=b.map((function(e){return{title:e,width:100,align:"center",dataIndex:e,render:function(t,n){return t&&t.estado&&t.observacion?Object(r.jsx)(Te.a,{content:Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:t.observacion}),Object(r.jsx)(U.a,{type:"primary",onClick:function(){return t=n[e]._id,K(),void G(t);var t},size:"small",children:"Editar"})]}),title:"Observaciones",placement:"topRight",trigger:"click",destroyTooltipOnHide:!0,children:Object(r.jsx)("button",{className:"boton-none",children:Object(r.jsx)(xa,{actualizar:Y,row:n,fecha:e,estado:t.estado})})}):Object(r.jsx)(xa,{actualizar:Y,row:n,fecha:e,estado:t&&t.estado?t.estado:"-"})}}}));O([].concat(e,Object(ue.a)(t)))}else O([])}()}),[b]);var K=function(){return q(!N)};function J(e){if(e&&e.length>1){var t=Qe()(e[1].toDate()).diff(e[0].toDate(),"days");i(e[0]),l(e[1]);for(var n=[],r=0;r<=t;r++)n.push(Qe()(e[0].toDate()).add(r,"days").format("DD-MM"));f(n)}else i(Qe()().startOf("week")),l(Qe()().endOf("week"))}return Object(r.jsxs)("div",{children:[Object(r.jsxs)(R.a,{children:[Object(r.jsxs)(M.a,{sm:24,style:{marginBottom:".5rem"},children:[Object(r.jsx)("p",{style:{color:"rgba(0,0,0,0.45)"},children:"Seleccionar Fecha:"}),Object(r.jsx)(Aa,{style:{marginRight:".5rem"},onChange:J,value:[Qe()(n),Qe()(s)]}),Object(r.jsx)(U.a,{disabled:y,icon:y?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ta.a,{}),onClick:Y,children:"Actualizar"})]}),Object(r.jsx)(M.a,{sm:6,style:{marginBottom:"1rem",marginRight:".5rem"},children:Object(r.jsx)(Qt.a,{title:"Semana selecionada",value:n&&s?"".concat(Qe()(n).format("DD-MM")," / ").concat(Qe()(s).format("DD-MM")):"-"})})]}),Object(r.jsx)(In.a,{rowKey:"_id",size:"small",loading:y,columns:null!==p&&0!==p.length?p:[{title:"#",width:50,align:"center",render:function(e,t,n){return n+1}},{title:"Gestor",width:200},{title:"Fecha",width:100}],dataSource:m,pagination:!1,footer:function(){return Object(r.jsx)(Ia,{data:m,dias:b,nombre:"gestor"})},scroll:{y:"60vh"}}),Object(r.jsx)(_a,{visible:N,abrir:K,loadingActualizar:A,actualizar:function(e,t){return V.apply(this,arguments)}})]})}var Ea=We.a.RangePicker;function Da(){var e=Object(a.useState)(Qe()().startOf("week")),t=Object(I.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)(Qe()().endOf("week")),c=Object(I.a)(o,2),s=c[0],l=c[1],d=Object(a.useState)([]),u=Object(I.a)(d,2),b=u[0],f=u[1],j=Object(a.useState)(null),h=Object(I.a)(j,2),p=h[0],O=h[1],g=Object(a.useState)([]),x=Object(I.a)(g,2),m=x[0],v=x[1],_=Object(a.useState)(!1),w=Object(I.a)(_,2),y=w[0],S=w[1],C=Object(a.useState)(!1),k=Object(I.a)(C,2),A=k[0],T=k[1],E=Object(a.useState)(!1),D=Object(I.a)(E,2),N=D[0],q=D[1],F=Object(a.useState)(null),L=Object(I.a)(F,2),z=L[0],G=L[1];function Y(){return H.apply(this,arguments)}function H(){return(H=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n||!s){e.next=4;break}return S(!0),e.next=4,aa({metodo:Ut,tipo:"auditor",fecha_inicio:n.toDate(),fecha_fin:s.toDate()}).then(function(){var e=Object(P.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,e.next=3,ua(n.filter((function(e){return null!==e.auditor})));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){e&&e.length>0&&v(e)})).catch((function(e){return console.log(e)})).finally((function(){return S(!1)}));case 4:case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){return(V=Object(P.a)(B.a.mark((function e(t,n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T(!0),e.next=3,oa({id:z,estado:t,observacion:n}).catch((function(e){return console.log(e)})).finally((function(){T(!1),q(!1),Y()}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){J([Qe()().startOf("week"),Qe()().endOf("week")])}),[]),Object(a.useEffect)((function(){Y()}),[n,s]),Object(a.useEffect)((function(){!function(){if(b.length>0){var e=[{title:"#",width:50,align:"center",render:function(e,t,n){return n+1}},{title:"Auditor",dataIndex:"auditor",width:450,render:function(e,t){return t.nombre+" "+t.apellidos}}],t=b.map((function(e){return{title:e,width:100,align:"center",dataIndex:e,render:function(t,n){return t&&t.estado&&t.observacion?Object(r.jsx)(Te.a,{content:Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:t.observacion}),Object(r.jsx)(U.a,{type:"primary",onClick:function(){return t=n[e]._id,K(),void G(t);var t},size:"small",children:"Editar"})]}),title:"Observaciones",placement:"topRight",trigger:"click",destroyTooltipOnHide:!0,children:Object(r.jsx)("button",{className:"boton-none",children:Object(r.jsx)(xa,{actualizar:Y,row:n,fecha:e,estado:t.estado})})}):Object(r.jsx)(xa,{actualizar:Y,row:n,fecha:e,estado:t&&t.estado?t.estado:"-"})}}}));O([].concat(e,Object(ue.a)(t)))}else O([])}()}),[b]);var K=function(){return q(!N)};function J(e){if(e&&e.length>1){var t=Qe()(e[1].toDate()).diff(e[0].toDate(),"days");i(e[0]),l(e[1]);for(var n=[],r=0;r<=t;r++)n.push(Qe()(e[0].toDate()).add(r,"days").format("DD-MM"));f(n)}else i(Qe()().startOf("week")),l(Qe()().endOf("week"))}return Object(r.jsxs)("div",{style:{marginBottom:"1rem"},children:[Object(r.jsxs)(R.a,{children:[Object(r.jsxs)(M.a,{sm:24,style:{marginBottom:".5rem"},children:[Object(r.jsx)("p",{style:{color:"rgba(0,0,0,0.45)"},children:"Seleccionar Fecha:"}),Object(r.jsx)(Ea,{style:{marginRight:".5rem"},onChange:J,value:[Qe()(n),Qe()(s)]}),Object(r.jsx)(U.a,{disabled:y,icon:y?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ta.a,{}),onClick:Y,children:"Actualizar"})]}),Object(r.jsx)(M.a,{sm:6,style:{marginBottom:"1rem",marginRight:".5rem"},children:Object(r.jsx)(Qt.a,{title:"Semana selecionada",value:n&&s?"".concat(Qe()(n).format("DD-MM")," / ").concat(Qe()(s).format("DD-MM")):"-"})})]}),Object(r.jsx)(In.a,{rowKey:"_id",size:"small",loading:y,columns:null!==p&&0!==p.length?p:[{title:"#",width:50,align:"center",render:function(e,t,n){return n+1}},{title:"Auditor",width:200},{title:"Fecha",width:100}],dataSource:m,pagination:!1,footer:function(){return Object(r.jsx)(Ia,{data:m,dias:b,nombre:"auditor"})},scroll:{y:"60vh"}}),Object(r.jsx)(_a,{visible:N,abrir:K,loadingActualizar:A,actualizar:function(e,t){return V.apply(this,arguments)}})]})}var Na=Nn.a.TabPane;var Ra=[{path:g,exact:!0,component:function(){var e=Object(a.useState)([]),t=Object(I.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)(!1),c=Object(I.a)(o,2),s=c[0],l=c[1],d=Object(a.useState)([]),u=Object(I.a)(d,2),b=u[0],f=u[1],j=Object(a.useState)(!1),h=Object(I.a)(j,2),p=h[0],O=h[1];function g(){return(g=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.next=3,tt(!1,{metodo:lt}).then((function(e){var t=e.data;t&&i([].concat(Object(ue.a)(t),[{_id:"-",nombre:"-",apellidos:""}]))})).catch((function(e){return console.log(e)})).finally((function(){return l(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return(x=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.next=3,tt(!1,{metodo:dt}).then((function(e){var t=e.data;t&&f(t)})).catch((function(e){return console.log(e)})).finally((function(){return O(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){!function(){g.apply(this,arguments)}(),function(){x.apply(this,arguments)}()}),[]),Object(r.jsxs)("div",{children:[Object(r.jsx)(et,{titulo:"Asignar Rutas",subtitulo:"Lista Rutas"}),Object(r.jsx)(q,{children:Object(r.jsx)(Zr,{gestores:n,loadingGestores:s,auditores:b,loadingAuditores:p})})]})},nivel:k.administrarOrdenes},{path:x,exact:!0,component:function(){return Object(r.jsxs)("div",{children:[Object(r.jsx)(et,{titulo:"Lista de Rutas",subtitulo:"Operativa"}),Object(r.jsx)(q,{children:Object(r.jsxs)(Nn.a,{style:{paddingLeft:"1rem"},animated:!1,children:[Object(r.jsx)(Na,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(Xr.a,{}),"Auditores"]}),children:Object(r.jsx)(Da,{})},"1"),Object(r.jsx)(Na,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(Qr.a,{}),"Gestores"]}),children:Object(r.jsx)(Ta,{})},"2"),Object(r.jsx)(Na,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)($r.a,{}),"Tecnicos"]}),children:Object(r.jsx)(ka,{})},"3")]})})]})},nivel:k.administrarOrdenes}],Ma=[{title:"#",width:50,align:"center",render:function(e,t,n){return n+1}},{title:"Tecnico",dataIndex:"tecnico",width:200},{title:"Gestor",dataIndex:"gestor",width:200},{title:"Fecha",dataIndex:"fecha",width:100}];var qa=n(681),Fa=n(682),La=n(133),za=n(679),Ba=n(680),Pa=[{cabecera:"desdtt",propiedad:"distrito"},{cabecera:"codreq",cabecera_2:"codreqatn",propiedad:"codigo_requerimiento"},{cabecera:"codordtrab",propiedad:"codigo_trabajo"},{cabecera:"cod_peticion",cabecera_2:"codpeticion",propiedad:"codigo_peticion"},{cabecera:"codofcadm",propiedad:"codigo_zonal"},{cabecera:"codcli",propiedad:"codigo_cliente"},{cabecera:"nomcli",propiedad:"nombre_cliente"},{cabecera:"codctr",propiedad:"codigo_ctr"},{cabecera:"desnomctr",propiedad:"descripcion_ctr"},{cabecera:"codnod",propiedad:"codigo_nodo"},{cabecera:"nroplano",propiedad:"codigo_troba"},{cabecera:"fec_regist",cabecera_2:"fechorreg",fecha:!0,propiedad:"fecha_registro"},{cabecera:"codmotv",propiedad:"codigo_motivo"},{cabecera:"desmotv",propiedad:"detalle_motivo"},{cabecera:"tipreqfin",propiedad:"tipo_requerimiento"},{cabecera:"desobsordtrab",propiedad:"detalle_trabajo"},{cabecera:"telefono",cabecera_2:"tel_cont_cc",propiedad:"telefono_contacto"},{cabecera:"tel_cont_ref_cc",propiedad:"telefono_referencia"},{cabecera:"numaverei",cabecera_2:"numaveind",propiedad:"numero_reiterada"},{cabecera:"tiptecnologia",propiedad:"tipo_tecnologia"}],Ga=[{cabecera:"destipvia",espacio:" "},{cabecera:"desnomvia",espacio:" "},{cabecera:"numvia",espacio:" "},{cabecera:"despis",espacio:" "},{cabecera:"desint",espacio:" Int. "},{cabecera:"desmzn",espacio:" Mz. "},{cabecera:"deslot",espacio:" Lt. "},{cabecera:"destipurb",espacio:" "},{cabecera:"desurb",espacio:" "}],Ya=[{cabecera:"desdtt",cabecera_2:"distrito",propiedad:"distrito"},{cabecera:"codreq",cabecera_2:"numreq",cabecera_3:"requerimiento",propiedad:"codigo_requerimiento"},{cabecera:"codofcadm",propiedad:"codigo_zonal"},{cabecera:"codcli",propiedad:"codigo_cliente"},{cabecera:"codordtrab",cabecera_2:"ordtrab",propiedad:"codigo_trabajo"},{cabecera:"cod_peticion",cabecera_2:"codpeticion",propiedad:"codigo_peticion"},{cabecera:"codinc",propiedad:"codigo_incidencia"},{cabecera:"codctr",cabecera_2:"codres",propiedad:"codigo_ctr"},{cabecera:"desnomctr",propiedad:"descripcion_ctr"},{cabecera:"codsegmento",propiedad:"codigo_segmento"},{cabecera:"tipreq",propiedad:"tipo_requerimiento"},{cabecera:"codmotv",propiedad:"codigo_motivo"},{cabecera:"desmotv",propiedad:"detalle_motivo"},{cabecera:"desobsordtrab",propiedad:"detalle_trabajo"},{cabecera:"fecest",fecha:!0,propiedad:"fecha_asignado"},{cabecera:"fechorasig",cabecera_2:"fecasig",hora:"horasig",fecha:!0,propiedad:"fecha_registro"},{cabecera:"codnod",propiedad:"codigo_nodo"},{cabecera:"nroplano",propiedad:"codigo_troba"},{cabecera:"indpai",cabecera_2:"estado pai",propiedad:"indicador_pai"},{cabecera:"telefono_voip",propiedad:"telefono_contacto"},{cabecera:"tiptecnologia",propiedad:"tipo_tecnologia"},{cabecera:"movistar_total",propiedad:"movistar_total"}],Ha=[{cabecera:"codreq",cabecera_2:"codreqatn",cabecera_3:"numreq",propiedad:"codigo_requerimiento"},{cabecera:"codctr",cabecera_2:"codres",propiedad:"codigo_ctr"},{cabecera:"codnod",propiedad:"codigo_nodo"},{cabecera:"desnomctr",propiedad:"descripcion_ctr"},{cabecera:"fec_liquid",cabecera_2:"fechorliq",fecha:!0,propiedad:"fecha_liquidado"},{cabecera:"tipave",propiedad:"tipo_averia"},{cabecera:"codtecliq",propiedad:"carnet_liquidado"},{cabecera:"nomtec",propiedad:"nombre_liquidado"},{cabecera:"codusr",propiedad:"usuario_liquidado"},{cabecera:"desobsordtrab",propiedad:"observacion_liquidado"},{cabecera:"des_cod_liq",propiedad:"descripcion_codigo_liquidado"}],Va=[{text:"MA MAGDALENA 01",value:"BK_SV_MA_MAGDALENA_01"},{text:"SM MAGDALENA 02",value:"BK_MA_SM_MAGDALENA_02"},{text:"SJ MARANGA",value:"BK_MR_SM_PN_SJ_MARANGA"},{text:"SJ SAN JOSE",value:"BK_SJ_SAN_JOSE"},{text:"MA VENEZUELA",value:"BK_VN_MA_VENEZUELA"}],Ua="pendiente",Ka="agendado",Ja="asignado",Wa="iniciado",Za="liquidado",Xa="suspendido",Qa="cancelado",$a="no_realizado",ei="masivo",ti="pext",ni="remedy",ri=["02","2","03","3","06","6","07","7","10","1C","1D","1H","1I","1N","1P","1Q","1S","1O","1T","1U","1L","G1","G3","G4","G5","2A","2B","2C","2D","2E","2F","2G","2H","HC","H0","H1","H2","H3","H4","H5","H6","H8","H9","HA","HB","HC","HD"],ai=["1V","1W","71","77","78","79","7B","7C","7D","7E","7F","21","93","R1","R2","H7","D1","D2","D3","D4","D5","S1","S2","S3","S4","S5","S6","Z1"],ii=["21","22","23","24","25","26","28","31","32","33","34","35","41","42","43","47","48","49","51","53","81","82","83","84","91","92","B8"],oi=n(676);var ci=function(e){var t=e.estado;switch(String(t).toLowerCase()){case"cancelado":return Object(r.jsx)(Cn.a,{children:Bn(t)});case"completado":case Za:return Object(r.jsx)(Cn.a,{color:"success",children:Bn(t)});case Ka:return Object(r.jsx)(Cn.a,{color:"blue",children:Bn(t)});case Ja:return Object(r.jsx)(Cn.a,{color:"cyan",children:Bn(t)});case"iniciado":return Object(r.jsx)(Cn.a,{color:"geekblue",children:Bn(t)});case"no realizada":return Object(r.jsx)(Cn.a,{color:"magenta",children:Bn(t)});case Ua:return Object(r.jsx)(Cn.a,{color:"orange",children:Bn(t)});case Xa:case ni:return Object(r.jsx)(Cn.a,{color:"red",children:Bn(t)});case ti:case ei:return Object(r.jsx)(Cn.a,{color:"purple",children:String(t).toUpperCase()});case"efectiva":return Object(r.jsx)(Cn.a,{color:"green",children:Bn(t)});case"inefectiva":case"anulado":return Object(r.jsx)(Cn.a,{color:"red",children:Bn(t)});default:return Object(r.jsx)(Cn.a,{children:"-"})}},si=n(622),li=function(){var e=Object(P.a)(B.a.mark((function e(t,n){var r,a,i,o,c,s,l,d;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.metodo,a=n.tipo,i=n.codigo_cliente,o=n.id,c=n.todo,s=n.id_ordenes,l=n.fechaInicio,d=n.fechaFin,e.abrupt("return",Q({url:"ordenes",method:"GET",params:{metodo:r,tipo:a,todo:c,codigo_cliente:i,id:o,id_ordenes:s,fechaInicio:l,fechaFin:d},headers:{"Content-Type":"application/json"}},t));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),di=function(){var e=Object(P.a)(B.a.mark((function e(t){var n,r,a,i;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.metodo,r=t.ordenes,a=t.ordenesExternas,i=t.orden,e.abrupt("return",Q({url:"ordenes",method:"POST",data:{ordenes:r,ordenesExternas:a,metodo:n,orden:i}},!0));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ui=function(){var e=Object(P.a)(B.a.mark((function e(t){var n,r;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.metodo,r=t.ordenes,e.abrupt("return",Q({url:"ordenes",method:"PUT",data:{ordenes:r,metodo:n}},!0));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),bi=function(){var e=Object(P.a)(B.a.mark((function e(t){var n,r,a,i,o,c,s,l,d,u,b;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.metodo,r=t.id,a=t.ordenes,i=t.bucket,o=t.tecnico,c=t.auditor,s=t.gestor,l=t.contrata,d=t.fecha_cita,u=t.estado,b=t.observacion,e.abrupt("return",Q({url:"ordenes",method:"PATCH",data:{metodo:n,id:r,ordenes:a,bucket:i,tecnico:o,auditor:c,gestor:s,contrata:l,fecha_cita:d,estado:u,observacion:b}},!0));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fi=function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Q({url:"ordenes",method:"PATCH",data:t,headers:{"Content-Type":"multipart/form-data"}},!0));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var ji=function(e){var t=e.row,n=e.listarOrdenes,i=Object(a.useState)(null),o=Object(I.a)(i,2),c=o[0],s=o[1],l=Object(a.useState)(!1),d=Object(I.a)(l,2),u=d[0],b=d[1];function f(){return(f=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=5;break}return e.next=3,bi({metodo:Vt,id:t._id,observacion:c}).then((function(){j(),n()})).catch((function(e){return console.log(e)}));case 3:e.next=6;break;case 5:b(!1);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var j=function(){s(null),b(!1)};return Object(r.jsx)(si.a,{visible:u,placement:"leftTop",title:function(){return Object(r.jsxs)("div",{children:[Object(r.jsxs)("p",{children:["Observacion - ",Object(r.jsx)("strong",{children:t.codigo_requerimiento})]}),Object(r.jsx)(V.a,{value:c,onChange:function(e){return s(e.target.value)},placeholder:"Observacion",size:"small",style:{width:250}})]})},icon:Object(r.jsx)(gr.a,{twoToneColor:"#EB984E"}),onConfirm:function(){return f.apply(this,arguments)},onCancel:j,children:Object(r.jsx)(gr.a,{style:{fontSize:"1.5rem"},twoToneColor:"#EB984E",onClick:function(){return b(!u)}})})};var hi=function(e){var t=e.fecha,n=e.tipo,a=e.tipoAgenda,i=Qe()().diff(t,"hours");return a&&t?Object(r.jsx)(Cn.a,{color:"blue",children:i}):!a&&t?n===jn?Object(r.jsx)(Cn.a,{color:i>=72?"error":i<72&&i>=24?"warning":i<24?"success":"",children:i}):n===fn?Object(r.jsx)(Cn.a,{color:i>=24?"error":i<24&&i>=12?"warning":i<12?"success":"",children:i}):Object(r.jsx)(Cn.a,{children:"-"}):Object(r.jsx)(Cn.a,{color:"blue",children:"-"})},pi=Le.a.Text;function Oi(e){var t=e.filtroTipo,n=void 0===t?[]:t,a=e.filtroTimeSlot,i=void 0===a?[]:a,o=e.abrirRegistro,c=e.listarOrdenes;return[{title:"#",width:50,fixed:"left",render:function(e,t,n){return n+1}},{title:"Tipo",dataIndex:"tipo",width:100,fixed:"left",filters:n||[],onFilter:function(e,t){return 0===t.tipo.indexOf(e)},render:function(e){return e?Bn(e):"-"}},{title:"Requerimiento",dataIndex:"codigo_requerimiento",width:140,fixed:"left",render:function(e,t){return t.subtipo_actividad&&un.includes(t.subtipo_actividad)?Object(r.jsx)(pi,{copyable:!0,strong:!0,style:{color:"#003055"},children:Object(r.jsx)(Cn.a,{color:"#108ee9",style:{fontSize:"1rem"},children:e})}):Object(r.jsx)(pi,{copyable:!0,strong:!0,children:e})}},{title:"Codigo Cliente",dataIndex:"codigo_cliente",width:120,fixed:"left",render:function(e){return Object(r.jsx)(pi,{copyable:!0,children:e})}},{averias:!0,altas:!0,title:"Time Slot",dataIndex:"tipo_agenda",width:100,align:"center",fixed:"right",filters:i?i.filter((function(e){return e.text})):[],onFilter:function(e,t){return!(!t.tipo_agenda||!e)&&0===t.tipo_agenda.indexOf(e)},render:function(e){return e?Object(r.jsx)(Cn.a,{color:"#f50",children:e}):void 0}},{title:"Horas",dataIndex:"fecha_registro",width:80,align:"center",fixed:"right",sorter:function(e,t){return Qe()().diff(e.fecha_registro,"hours")<Qe()().diff(t.fecha_registro,"hours")?-1:Qe()().diff(e.fecha_registro,"hours")>Qe()().diff(t.fecha_registro,"hours")?1:0},render:function(e,t){return Object(r.jsx)(hi,{fecha:e,tipo:t.tipo,tipoAgenda:t.tipo_agenda})}},{title:"Acciones",dataIndex:"_id",width:80,align:"center",fixed:"right",render:function(e,t){return Object(r.jsxs)("div",{children:[Object(r.jsx)(oi.a,{style:{fontSize:"1.5rem",marginRight:".5rem"},onClick:function(){return o(e)}}),Object(r.jsx)(ji,{row:t,listarOrdenes:c})]})}}]}function gi(e){var t=e.filtroDistrito,n=void 0===t?[]:t,a=e.filtroBucket,i=void 0===a?[]:a,o=e.filtroEstadoToa,c=void 0===o?[]:o,s=e.filtroEstadoGestor,l=void 0===s?[]:s,d=e.filtroContrata,u=void 0===d?[]:d,b=e.filtroTecnico,f=void 0===b?[]:b,j=e.filtroTecnicoAsignado,h=void 0===j?[]:j,p=e.filtroTipoRequerimiento,O=void 0===p?[]:p,g=e.filtroTipoTecnologia,x=void 0===g?[]:g,m=e.filtroCtr,v=void 0===m?[]:m,_=e.filtroNodo,w=void 0===_?[]:_,y=e.filtroTroba,S=void 0===y?[]:y,C=e.abrirReiterada,k=e.abrirInfancia;return[{key:"tipo_requerimiento",title:"Tipo Req.",dataIndex:"tipo_requerimiento",width:120,align:"center",filters:O||[],onFilter:function(e,t){return 0===t.tipo_requerimiento.indexOf(e)}},{key:"tipo_tecnologia",title:"Tecnologia",dataIndex:"tipo_tecnologia",width:120,filters:x||[],onFilter:function(e,t){return 0===t.tipo_tecnologia.indexOf(e)}},{key:"codigo_trabajo",title:"Orden Trabajo",dataIndex:"codigo_trabajo",width:120,render:function(e){return Object(r.jsx)(pi,{copyable:!0,children:e})}},{key:"codigo_peticion",title:"Peticion",dataIndex:"codigo_peticion",width:120,render:function(e){return Object(r.jsx)(pi,{copyable:!0,children:e})}},{key:"codigo_ctr",title:"CTR",dataIndex:"codigo_ctr",width:60,filters:v||[],onFilter:function(e,t){return 0===String(t.codigo_ctr).indexOf(String(e))}},{key:"codigo_nodo",title:"Nodo",dataIndex:"codigo_nodo",width:75,filters:w||[],onFilter:function(e,t){return 0===String(t.codigo_nodo).indexOf(String(e))}},{key:"codigo_troba",title:"Troba",dataIndex:"codigo_troba",width:90,filters:S||[],onFilter:function(e,t){return 0===String(t.codigo_troba).indexOf(String(e))},sorter:function(e,t){return e.codigo_troba<t.codigo_troba?-1:e.codigo_troba>t.codigo_troba?1:0}},{key:"numero_reiterada",title:"Reiterada",dataIndex:"numero_reiterada",width:100,align:"center",sorter:function(e,t){return e.numero_reiterada-t.numero_reiterada},render:function(e,t){return e&&"0"!==e&&"-"!==e?Object(r.jsx)(Cn.a,{color:"#E5302F",onClick:function(){return C(t.codigo_cliente)},style:{cursor:"pointer"},children:e}):"-"}},{key:"infancia",title:"Infancia",dataIndex:"infancia",width:100,align:"center",filters:[{text:"Si",value:!0},{text:"No",value:!1}],onFilter:function(e,t){return e?t.infancia:!t.infancia},render:function(e){return e&&e.codigo_requerimiento?Object(r.jsx)(Cn.a,{color:"blue",onClick:function(){return k(e)},style:{cursor:"pointer"},children:"Si"}):"-"}},{key:"distrito",title:"Distrito",dataIndex:"distrito",width:160,filters:n||[],onFilter:function(e,t){return 0===t.distrito.indexOf(e)}},{key:"direccion",title:"Direcci\xf3n",dataIndex:"direccion",width:250,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e,children:e})}},{key:"bucket",title:"Bucket",dataIndex:"bucket",width:200,ellipsis:{showTitle:!1},filters:i||[],onFilter:function(e,t){return 0===t.bucket.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e,children:e})}},{key:"estado_toa",title:"Estado Toa",dataIndex:"estado_toa",width:150,align:"center",filters:c||[],onFilter:function(e,t){return 0===t.estado_toa.indexOf(e)},render:function(e){return Object(r.jsx)(ci,{estado:e})}},{key:"estado_gestor",title:"Estado Gestor",dataIndex:"estado_gestor",width:150,align:"center",filters:l||[],onFilter:function(e,t){return 0===t.estado_gestor.indexOf(e)},render:function(e){return Object(r.jsx)(ci,{estado:e})}},{key:"contrata",title:"Contrata",dataIndex:"contrata",width:200,ellipsis:{showTitle:!1},filters:u||[],onFilter:function(e,t){return"-"===e?!t.contrata:void 0!==t.contrata&&0===t.contrata._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre:"-",children:e?e.nombre:"-"})}},{key:"tecnico",title:"Tecnico TOA",dataIndex:"tecnico",width:200,ellipsis:{showTitle:!1},filters:f||[],onFilter:function(e,t){return"-"===e?!t.tecnico:void 0!==t.tecnico&&0===t.tecnico._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre+" "+e.apellidos:"-",children:e?e.nombre+" "+e.apellidos:"-"})}},{key:"tecnico_liteyca",title:"Tecnico Asignado",dataIndex:"tecnico_liteyca",width:200,ellipsis:{showTitle:!1},filters:h||[],onFilter:function(e,t){return"-"===e?!t.tecnico_liteyca:void 0!==t.tecnico_liteyca&&0===t.tecnico_liteyca._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre+" "+e.apellidos:"-",children:e?e.nombre+" "+e.apellidos:"-"})}},{key:"observacion_gestor",title:"Observacion Gestor",dataIndex:"observacion_gestor",width:250,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsxs)(yn.a,{placement:"topLeft",title:e,children:[e," "]})}},{key:"tipo_agenda",title:"Time Slot",dataIndex:"tipo_agenda",width:100},{key:"fecha_cita",title:"Fecha Cita",dataIndex:"fecha_cita",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY"):"-"}},{key:"fecha_asignado",title:"Fecha Asignado",dataIndex:"fecha_asignado",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}},{key:"fecha_registro",title:"Fecha Registro",dataIndex:"fecha_registro",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}}]}var xi=Le.a.Text;var mi=function(e){var t=e.visible,n=e.abrir,i=e.orden,o=e.tipo,c=Object(a.useState)({}),s=Object(I.a)(c,2),l=s[0],d=s[1],u=Object(a.useState)(!1),b=Object(I.a)(u,2),f=b[0],j=b[1];function h(){return(h=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.next=3,li(!1,{metodo:Bt,id:i}).then((function(e){var t=e.data;d(t||{})})).catch((function(e){return console.log(e)})).finally((function(){return j(!1)}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){String(i).length>4&&function(){h.apply(this,arguments)}()}),[i]),o===fn?Object(r.jsx)(kn.a,{title:"Detalle Orden",visible:t,onCancel:n,onOk:n,width:"70vw",destroyOnClose:!0,centered:!0,children:f?Object(r.jsx)(le.a,{spinning:!0}):Object(r.jsxs)(Nr.a,{bordered:!0,size:"small",children:[Object(r.jsx)(Nr.a.Item,{label:"Requerimiento",children:l&&l.codigo_requerimiento?l.codigo_requerimiento:"-"}),Object(r.jsx)(Nr.a.Item,{label:"Codigo Cliente",children:l&&l.codigo_cliente?l.codigo_cliente:"-"}),Object(r.jsx)(Nr.a.Item,{label:"Nodo",children:l&&l.codigo_nodo?l.codigo_nodo:"-"}),Object(r.jsx)(Nr.a.Item,{label:"Distrito",children:l&&l.distrito?l.distrito:""}),Object(r.jsx)(Nr.a.Item,{label:"Telefono",children:l&&l.telefono_contacto?l.telefono_contacto:""}),Object(r.jsx)(Nr.a.Item,{label:"Referencia",children:l&&l.telefono_referencia?l.telefono_referencia:""}),Object(r.jsx)(Nr.a.Item,{label:"Tecnolog\xeda",children:l&&l.tipo_tecnologia?l.tipo_tecnologia:""}),Object(r.jsx)(Nr.a.Item,{label:"Fecha Cita",children:l&&l.fecha_cita?Qe()(l.fecha_cita).format("DD/MM/YY"):"-"}),Object(r.jsx)(Nr.a.Item,{label:"Fecha Registro",children:l&&l.fecha_registro?Qe()(l.fecha_registro).format("DD/MM/YY HH:mm"):"-"}),Object(r.jsx)(Nr.a.Item,{label:"Horas",children:l&&l.fecha_registro?Object(r.jsx)(hi,{fecha:l.fecha_registro,tipo:l.tipo,tipoAgenda:l.tipo_agenda}):"-"}),Object(r.jsx)(Nr.a.Item,{label:"Cliente",span:2,children:l&&l.nombre_cliente?l.nombre_cliente:""}),Object(r.jsx)(Nr.a.Item,{label:"Direcci\xf3n",span:3,children:l&&l.direccion?l.direccion:""}),Object(r.jsx)(Nr.a.Item,{label:"Detalle Trabajo",span:3,children:l&&l.detalle_trabajo?l.detalle_trabajo:""}),Object(r.jsx)(Nr.a.Item,{label:"Observacion Gestor",span:3,children:l&&l.observacion_gestor?l.observacion_gestor:""}),Object(r.jsx)(Nr.a.Item,{label:"Observacion Toa",span:3,children:l&&l.observacion_toa?l.observacion_toa:""})]})}):Object(r.jsx)(kn.a,{title:"Detalle Orden",visible:t,onCancel:n,onOk:n,width:"70vw",destroyOnClose:!0,centered:!0,children:f?Object(r.jsx)(le.a,{spinning:!0}):Object(r.jsxs)(Nr.a,{bordered:!0,size:"small",children:[Object(r.jsx)(Nr.a.Item,{label:"Requerimiento",children:l&&l.codigo_requerimiento?l.codigo_requerimiento:"-"}),Object(r.jsx)(Nr.a.Item,{label:"Codigo Cliente",children:l&&l.codigo_cliente?l.codigo_cliente:"-"}),Object(r.jsx)(Nr.a.Item,{label:"Codigo Peticion",children:l&&l.codigo_peticion?l.codigo_peticion:"-"}),Object(r.jsx)(Nr.a.Item,{label:"Orden Trabajo",children:l&&l.codigo_trabajo?l.codigo_trabajo:"-"}),Object(r.jsx)(Nr.a.Item,{label:"Tipo de Actividad",children:l&&l.subtipo_actividad?l.subtipo_actividad:"-"}),Object(r.jsx)(Nr.a.Item,{label:"Tecnolog\xeda",children:l&&l.tipo_tecnologia?l.tipo_tecnologia:""}),Object(r.jsx)(Nr.a.Item,{label:"Fecha Cita",children:l&&l.fecha_cita?Qe()(l.fecha_cita).format("DD/MM/YY"):"-"}),Object(r.jsx)(Nr.a.Item,{label:"Cliente",span:2,children:l&&l.nombre_cliente?l.nombre_cliente:""}),Object(r.jsx)(Nr.a.Item,{label:"Detalle Trabajo",span:3,children:l&&l.detalle_trabajo?l.detalle_trabajo:""}),Object(r.jsx)(Nr.a.Item,{label:"Observacion Gestor",span:3,children:l&&l.observacion_gestor?l.observacion_gestor:""}),Object(r.jsx)(Nr.a.Item,{label:"Observacion Toa",span:3,children:l&&l.observacion_toa?l.observacion_toa:""})]})})},vi=n(632);var _i=function(e){var t=e.visible,n=e.abrir,i=e.columnasBase,o=e.columnasUsuario,c=void 0===o?[]:o,s=e.guardar,l=Object(a.useState)([]),d=Object(I.a)(l,2),u=d[0],b=d[1];Object(a.useEffect)((function(){c&&c.length>0&&b(c)}),[c]);var f=function(){var e=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(u);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(kn.a,{title:"Configurar Columnas",visible:t,width:550,onCancel:n,onOk:f,centered:!0,children:[Object(r.jsx)("p",{children:"Seleccionar columnas"}),Object(r.jsx)(vi.a,{dataSource:i,targetKeys:u,titles:["Disponibles","Usuario"],listStyle:{width:300,height:600},onChange:function(e){return b(e)},render:function(e){return e.title}})]})};var wi=function(e){var t=e.asignadas,n=void 0!==t&&t,i=e.data,o=e.loading,c=e.ordenesSeleccionadas,s=e.setOrdenesSeleccionadas,l=e.abrirReiterada,d=e.abrirInfancia,u=e.abrirRegistro,b=e.listarOrdenes,f=Object(a.useState)([]),j=Object(I.a)(f,2),h=j[0],p=j[1],O=Object(a.useState)([]),g=Object(I.a)(O,2),x=g[0],m=g[1],v=Object(a.useState)([]),_=Object(I.a)(v,2),w=_[0],y=_[1],S=Object(a.useState)([]),C=Object(I.a)(S,2),k=C[0],A=C[1],T=Object(a.useState)([]),E=Object(I.a)(T,2),D=E[0],N=E[1],R=Object(a.useState)([]),M=Object(I.a)(R,2),q=M[0],F=M[1],L=Object(a.useState)([]),z=Object(I.a)(L,2),G=z[0],Y=z[1],H=Object(a.useState)([]),V=Object(I.a)(H,2),K=V[0],J=V[1],W=Object(a.useState)([]),Z=Object(I.a)(W,2),X=Z[0],Q=Z[1],$=Object(a.useState)([]),ee=Object(I.a)($,2),te=ee[0],ne=ee[1],re=Object(a.useState)([]),ae=Object(I.a)(re,2),ie=ae[0],oe=ae[1],ce=Object(a.useState)([]),se=Object(I.a)(ce,2),le=se[0],de=se[1],be=Object(a.useState)([]),fe=Object(I.a)(be,2),je=fe[0],he=fe[1],pe=Object(a.useState)([]),Oe=Object(I.a)(pe,2),ge=Oe[0],xe=Oe[1],me=Object(a.useState)([]),ve=Object(I.a)(me,2),_e=ve[0],we=ve[1],ye=Object(a.useState)(null),Se=Object(I.a)(ye,2),Ce=Se[0],ke=Se[1],Ie=Object(a.useState)(!1),Ae=Object(I.a)(Ie,2),Te=Ae[0],Ee=Ae[1],De=Object(a.useState)(!1),Ne=Object(I.a)(De,2),Re=Ne[0],Me=Ne[1],qe=Object(a.useState)(null),Fe=Object(I.a)(qe,2),Le=Fe[0],Be=Fe[1];function Pe(){return Ge.apply(this,arguments)}function Ge(){return(Ge=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt(!0,{metodo:ut}).then((function(e){var t=e.data;t&&t.columnas&&p(t.columnas)})).catch((function(e){return console.log(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ye(){return(Ye=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Me(!1),e.next=3,rt(!0,{columnas:t,metodo:vt}).then((function(){return Pe()}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){Pe()}),[]),Object(a.useEffect)((function(){h&&h.length>0&&Ke()}),[h]),Object(a.useEffect)((function(){Ue(i)}),[i]);var He=function(){return Ee(!Te)},Ve=function(){return Me(!Re)},Ue=function(e){e&&e.length>0&&(m(Ur(e,"distrito")),y(Ur(e,"bucket")),A(Ur(e,"estado_toa")),N(Ur(e,"estado_gestor")),ne(Ur(e,"tipo_requerimiento")),oe(Ur(e,"tipo_tecnologia")),de(Ur(e,"codigo_ctr")),he(Ur(e,"codigo_nodo")),xe(Ur(e,"codigo_troba")),we(Ur(e,"tipo_agenda")),F(Vr(e,"contrata")),Y(Vr(e,"tecnico")),J(Vr(e,"tecnico_liteyca")),Q(Ur(e,"tipo",!0)))},Ke=function(){return n?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=t.filtroTipo,r=void 0===n?[]:n,a=t.filtroDistrito,i=void 0===a?[]:a,o=t.filtroBucket,c=void 0===o?[]:o,s=t.filtroEstadoToa,l=void 0===s?[]:s,d=t.filtroEstadoGestor,u=void 0===d?[]:d,b=t.filtroContrata,f=void 0===b?[]:b,j=t.filtroTecnico,h=void 0===j?[]:j,p=t.filtroTecnicoAsignado,O=void 0===p?[]:p,g=t.filtroTipoRequerimiento,x=void 0===g?[]:g,m=t.filtroTipoTecnologia,v=void 0===m?[]:m,_=t.filtroCtr,w=void 0===_?[]:_,y=t.filtroNodo,S=void 0===y?[]:y,C=t.filtroTroba,k=void 0===C?[]:C,I=t.filtroTimeSlot,A=void 0===I?[]:I,T=t.abrirReiterada,E=t.abrirInfancia,D=t.abrirRegistro,N=t.listarOrdenes;if(e&&e.length>0){var R=[];e.forEach((function(e){var t=gi({filtroDistrito:i,filtroBucket:c,filtroEstadoToa:l,filtroEstadoGestor:u,filtroContrata:f,filtroTecnico:h,filtroTecnicoAsignado:O,filtroTipoRequerimiento:x,filtroTipoTecnologia:v,filtroCtr:w,filtroNodo:S,filtroTroba:k,abrirReiterada:T,abrirInfancia:E}).findIndex((function(t){return t.dataIndex===e}));t>-1&&R.push(gi({filtroDistrito:i,filtroBucket:c,filtroEstadoToa:l,filtroEstadoGestor:u,filtroContrata:f,filtroTecnico:h,filtroTecnicoAsignado:O,filtroTipoRequerimiento:x,filtroTipoTecnologia:v,filtroCtr:w,filtroNodo:S,filtroTroba:k,abrirReiterada:T,abrirInfancia:E})[t])}));var M=R.filter((function(e){return e})),q=Oi({filtroTipo:r,filtroTimeSlot:A,abrirRegistro:D,listarOrdenes:N});return q.splice.apply(q,[4,0].concat(Object(ue.a)(M))),q}var F=Oi({filtroTipo:r,filtroTimeSlot:A,abrirRegistro:D,listarOrdenes:N});return F.splice.apply(F,[4,0].concat(Object(ue.a)(gi({filtroDistrito:i,filtroBucket:c,filtroEstadoToa:l,filtroEstadoGestor:u,filtroContrata:f,filtroTecnico:h,filtroTecnicoAsignado:O,filtroTipoRequerimiento:x,filtroTipoTecnologia:v,filtroCtr:w,filtroNodo:S,filtroTroba:k,abrirReiterada:T,abrirInfancia:E})))),F}(h,{filtroDistrito:x,filtroTipo:X,filtroBucket:w,filtroEstadoToa:k,filtroEstadoGestor:D,filtroContrata:q,filtroTecnico:G,filtroTecnicoAsignado:K,filtroTipoRequerimiento:te,filtroTipoTecnologia:ie,filtroCtr:le,filtroNodo:je,filtroTimeSlot:_e,filtroTroba:ge,abrirReiterada:l,abrirInfancia:d,abrirRegistro:u,listarOrdenes:b}):function(){var e=arguments.length>13&&void 0!==arguments[13]?arguments[13]:[],t=arguments.length>14?arguments[14]:void 0,n=arguments.length>15?arguments[15]:void 0,a=arguments.length>16?arguments[16]:void 0,i=arguments.length>17?arguments[17]:void 0;return[{title:"#",width:50,fixed:"left",render:function(e,t,n){return n+1}},{title:"Tipo",dataIndex:"tipo",width:100,fixed:"left",filters:(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[])||[],onFilter:function(e,t){return 0===t.tipo.indexOf(e)},render:function(e){return e?Bn(e):"-"}},{title:"Requerimiento",dataIndex:"codigo_requerimiento",width:120,fixed:"left",render:function(e,t){return t.subtipo_actividad&&un.includes(t.subtipo_actividad)?{props:{style:{background:"#CCE9FF"}},children:Object(r.jsx)(xi,{copyable:!0,strong:!0,style:{color:"#003055"},children:e})}:Object(r.jsx)(xi,{copyable:!0,strong:!0,children:e})}},{title:"Codigo Cliente",dataIndex:"codigo_cliente",width:120,fixed:"left",render:function(e){return Object(r.jsx)(xi,{copyable:!0,children:e})}},{title:"Tipo Req.",dataIndex:"tipo_requerimiento",width:120,align:"center",filters:(arguments.length>8&&void 0!==arguments[8]?arguments[8]:[])||[],onFilter:function(e,t){return 0===t.tipo_requerimiento.indexOf(e)}},{title:"Tecnologia",dataIndex:"tipo_tecnologia",width:120,filters:(arguments.length>9&&void 0!==arguments[9]?arguments[9]:[])||[],onFilter:function(e,t){return 0===t.tipo_tecnologia.indexOf(e)}},{title:"Orden Trabajo",dataIndex:"codigo_trabajo",width:120,render:function(e){return Object(r.jsx)(xi,{copyable:!0,children:e})}},{title:"Peticion",dataIndex:"codigo_peticion",width:120,render:function(e){return Object(r.jsx)(xi,{copyable:!0,children:e})}},{title:"CTR",dataIndex:"codigo_ctr",width:60,filters:(arguments.length>10&&void 0!==arguments[10]?arguments[10]:[])||[],onFilter:function(e,t){return 0===String(t.codigo_ctr).indexOf(String(e))}},{title:"Nodo",dataIndex:"codigo_nodo",width:75,filters:(arguments.length>11&&void 0!==arguments[11]?arguments[11]:[])||[],onFilter:function(e,t){return 0===String(t.codigo_nodo).indexOf(String(e))}},{title:"Troba",dataIndex:"codigo_troba",width:90,filters:(arguments.length>12&&void 0!==arguments[12]?arguments[12]:[])||[],onFilter:function(e,t){return 0===String(t.codigo_troba).indexOf(String(e))},sorter:function(e,t){return e.codigo_troba<t.codigo_troba?-1:e.codigo_troba>t.codigo_troba?1:0}},{title:"Reiterada",dataIndex:"numero_reiterada",width:100,align:"center",sorter:function(e,t){return e.numero_reiterada-t.numero_reiterada},render:function(e,n){return e&&"0"!==e&&"-"!==e?Object(r.jsx)(Cn.a,{color:"#E5302F",onClick:function(){return t(n.codigo_cliente)},style:{cursor:"pointer"},children:e}):"-"}},{title:"Infancia",dataIndex:"infancia",width:100,align:"center",filters:[{text:"Si",value:!0},{text:"No",value:!1}],onFilter:function(e,t){return e?t.infancia:!t.infancia},render:function(e){return e&&e.codigo_requerimiento?Object(r.jsx)(Cn.a,{color:"blue",onClick:function(){return n(e)},style:{cursor:"pointer"},children:"Si"}):"-"}},{title:"Distrito",dataIndex:"distrito",width:160,filters:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[])||[],onFilter:function(e,t){return 0===t.distrito.indexOf(e)}},{title:"Bucket",dataIndex:"bucket",width:200,ellipsis:{showTitle:!1},filters:(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[])||[],onFilter:function(e,t){return 0===t.bucket.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e,children:e})}},{title:"Estado Toa",dataIndex:"estado_toa",width:150,align:"center",filters:(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[])||[],onFilter:function(e,t){return 0===t.estado_toa.indexOf(e)},render:function(e){return Object(r.jsx)(ci,{estado:e})}},{title:"Estado Gestor",dataIndex:"estado_gestor",width:150,align:"center",filters:(arguments.length>4&&void 0!==arguments[4]?arguments[4]:[])||[],onFilter:function(e,t){return 0===t.estado_gestor.indexOf(e)},render:function(e){return Object(r.jsx)(ci,{estado:e})}},{title:"Contrata",dataIndex:"contrata",width:200,ellipsis:{showTitle:!1},filters:(arguments.length>5&&void 0!==arguments[5]?arguments[5]:[])||[],onFilter:function(e,t){return"-"===e?!t.contrata:void 0!==t.contrata&&0===t.contrata._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre:"-",children:e?e.nombre:"-"})}},{title:"Tecnico TOA",dataIndex:"tecnico",width:200,ellipsis:{showTitle:!1},filters:(arguments.length>6&&void 0!==arguments[6]?arguments[6]:[])||[],onFilter:function(e,t){return"-"===e?!t.tecnico:void 0!==t.tecnico&&0===t.tecnico._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre+" "+e.apellidos:"-",children:e?e.nombre+" "+e.apellidos:"-"})}},{title:"Tecnico Asignado",dataIndex:"tecnico_liteyca",width:200,ellipsis:{showTitle:!1},filters:(arguments.length>7&&void 0!==arguments[7]?arguments[7]:[])||[],onFilter:function(e,t){return"-"===e?!t.tecnico_liteyca:void 0!==t.tecnico_liteyca&&0===t.tecnico_liteyca._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre+" "+e.apellidos:"-",children:e?e.nombre+" "+e.apellidos:"-"})}},{title:"Observacion Gestor",dataIndex:"observacion_gestor",width:250,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsxs)(yn.a,{placement:"topLeft",title:e,children:[e," "]})}},{title:"Fecha Cita",dataIndex:"fecha_cita",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY"):"-"}},{title:"Fecha Asignado",dataIndex:"fecha_asignado",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}},{title:"Fecha Registro",dataIndex:"fecha_registro",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}},{title:"Time Slot",dataIndex:"tipo_agenda",width:100,align:"center",fixed:"right",filters:e?e.filter((function(e){return e.text})):[],onFilter:function(e,t){return!(!t.tipo_agenda||!e)&&0===t.tipo_agenda.indexOf(e)},render:function(e){return e?Object(r.jsx)(Cn.a,{color:"#f50",children:e}):void 0}},{title:"Horas",dataIndex:"fecha_registro",width:80,align:"center",fixed:"right",sorter:function(e,t){return Qe()().diff(e.fecha_registro,"hours")<Qe()().diff(t.fecha_registro,"hours")?-1:Qe()().diff(e.fecha_registro,"hours")>Qe()().diff(t.fecha_registro,"hours")?1:0},render:function(e,t){return Object(r.jsx)(hi,{fecha:e,tipo:t.tipo,tipoAgenda:t.tipo_agenda})}},{title:"Acciones",dataIndex:"_id",width:80,align:"center",fixed:"right",render:function(e,t){return Object(r.jsxs)("div",{children:[Object(r.jsx)(oi.a,{style:{fontSize:"1.5rem",marginRight:".5rem"},onClick:function(){return a(e)}}),Object(r.jsx)(ji,{row:t,listarOrdenes:i})]})}}]}(x,X,w,k,D,q,G,K,te,ie,le,je,ge,_e,l,d,u,b)};return Object(r.jsxs)("div",{children:[Object(r.jsx)(In.a,{rowKey:"_id",onRow:function(e){return{onDoubleClick:function(){return function(e,t){ke(e),Be(t),He()}(e._id,e.tipo)}}},rowSelection:{columnWidth:50,selectedRowKeys:c,onChange:function(e){return s(e)}},columns:Ke(),dataSource:i,loading:o,size:"small",scroll:{y:"65vh"},pagination:{defaultPageSize:50,pageSizeOptions:[50,100,200]},footer:function(){return n?Object(r.jsx)(U.a,{icon:Object(r.jsx)(ze.a,{}),onClick:Ve,type:"primary",children:"Preferencias"}):null}}),Object(r.jsx)(mi,{visible:Te,abrir:He,orden:Ce,tipo:Le}),Object(r.jsx)(_i,{visible:Re,abrir:Ve,columnasBase:gi({filtroContrata:q,filtroEstadoGestor:D,filtroEstadoToa:k,filtroBucket:w,filtroDistrito:x,filtroCtr:le,filtroNodo:je,filtroTroba:ge,filtroTecnico:G,filtroTecnicoAsignado:K,filtroTipoRequerimiento:te,filtroTipoTecnologia:ie}),columnasUsuario:h,guardar:function(e){return Ye.apply(this,arguments)}})]})},yi=n(677);var Si=function(e){var t=e.visible,n=e.abrir,i=e.loading,o=e.registros,c=Object(a.useState)(!1),s=Object(I.a)(c,2),l=s[0],d=s[1],u=Object(a.useState)(""),b=Object(I.a)(u,2),f=b[0],j=b[1],h=function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&(d(!0),j(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=[{title:"#",width:50,render:function(e,t,n){return n+1}},{title:"Usuario",dataIndex:"usuario_entrada",width:180,render:function(e){return e?e.nombre+" "+e.apellidos:"-"}},{title:"Estado Orden",dataIndex:"estado_orden",width:120,render:function(e){return Object(r.jsx)(ci,{estado:e})}},{title:"Empleado Modificado",dataIndex:"empleado_modificado",width:200,render:function(e){return e?e.nombre+" "+e.apellidos:"-"}},{title:"Empleado Tipo",dataIndex:"empleado_modificado",width:150,render:function(e){return e&&e.usuario&&e.usuario.cargo?Object(r.jsx)(pr,{cargo:e.usuario.cargo}):"-"}},{title:"Contrata Modificado",dataIndex:"contrata_modificado",width:150,render:function(e){return e?e.nombre:"-"}},{title:"Observacion",dataIndex:"observacion",width:300},{title:"Fecha Entrada",dataIndex:"fecha_entrada",width:150,render:function(e){return e?Qe()(e).format("DD-MM-YYYY HH:mm"):"-"}},{title:"Imagenes",dataIndex:"imagenes",width:100,render:function(e){if(e&&e.length>0)return e.map((function(e,t){return Object(r.jsx)(yi.a,{onClick:function(){return h(e.url)},style:{marginRight:".5rem",marginBottom:".5rem",fontSize:"1.2rem"}},t)}))}}];return Object(r.jsxs)(kn.a,{title:"Historial de Notas",visible:t,onCancel:n,onOk:n,width:"90vw",destroyOnClose:!0,centered:!0,children:[Object(r.jsx)(In.a,{rowKey:"_id",columns:p,dataSource:o,loading:i,size:"small",pagination:!1,scroll:{x:"80vw"}}),Object(r.jsx)(kn.a,{visible:l,footer:null,onCancel:function(){return d(!l)},children:Object(r.jsx)("img",{alt:"example",style:{width:"100%"},src:f})})]})},Ci=Le.a.Text;var ki=function(e){var t=e.visible,n=e.abrir,a=e.loading,i=e.orden,o=[{title:"Requerimiento",dataIndex:"codigo_requerimiento",width:120,render:function(e){return e?Object(r.jsx)(Ci,{copyable:!0,children:e}):"-"}},{title:"CTR",dataIndex:"codigo_ctr",width:80},{title:"Tecnico",dataIndex:"tecnico_liquidado",width:180,render:function(e,t){return e?e.nombre+" "+e.apellidos:t.carnet_liquidado?t.carnet_liquidado:"-"}},{title:"Carnet",dataIndex:"tecnico_liquidado",width:180,render:function(e){return e?Object(r.jsx)(Ci,{copyable:!0,children:e.carnet}):"-"}},{title:"Gestor",dataIndex:"tecnico_liquidado",width:180,render:function(e){return e&&e.gestor&&e.gestor.nombre?e.gestor.nombre+" "+e.gestor.apellidos:"-"}},{title:"Estado Gestor",dataIndex:"estado_gestor",width:120,render:function(e){return Object(r.jsx)(ci,{estado:e})}},{title:"Fecha Registro",dataIndex:"fecha_registro",width:150,render:function(e){return e?Qe()(e).format("DD-MM-YYYY HH:mm"):"-"}},{title:"Fecha Liquidado",dataIndex:"fecha_liquidado",width:150,render:function(e){return e?Qe()(e).format("DD-MM-YYYY HH:mm"):"-"}}];return Object(r.jsx)(kn.a,{title:"Orden de Infancia",visible:t,onCancel:n,onOk:n,width:"90vw",destroyOnClose:!0,centered:!0,children:Object(r.jsx)(In.a,{rowKey:"_id",columns:o,dataSource:i,loading:a,size:"small",pagination:!1,scroll:{x:"80vw"}})})},Ii=Le.a.Text;var Ai=function(e){var t=e.abrir,n=e.visible,i=e.codigo_cliente,o=Object(a.useState)(!1),c=Object(I.a)(o,2),s=c[0],l=c[1],d=Object(a.useState)([]),u=Object(I.a)(d,2),b=u[0],f=u[1];function j(){return(j=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.next=3,li(!0,{metodo:Ft,codigo_cliente:i}).then((function(e){var t=e.data;t&&f(t)})).catch((function(e){return console.log(e)})).finally((function(){return l(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){i&&function(){j.apply(this,arguments)}()}),[i]);var h=[{title:"#",width:50,render:function(e,t,n){return n+1}},{title:"Requerimiento",dataIndex:"codigo_requerimiento",width:120,render:function(e){return Object(r.jsx)(Ii,{copyable:!0,children:e})}},{title:"CTR",dataIndex:"codigo_ctr",width:70},{title:"Descripcion CTR",dataIndex:"descripcion_ctr",width:180,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e,children:e})}},{title:"Cliente",dataIndex:"nombre_cliente",width:200,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e,children:e})}},{title:"Contrata",dataIndex:"tecnico_liquidado",width:200,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e&&e.contrata?e.contrata.nombre:"-",children:e&&e.contrata?e.contrata.nombre:"-"})}},{title:"Gestor",dataIndex:"tecnico_liquidado",width:200,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e&&e.gestor?e.gestor.nombre+" "+e.gestor.apellidos:"-",children:e?e.gestor.nombre+" "+e.gestor.apellidos:"-"})}},{title:"Tecnico",dataIndex:"tecnico_liquidado",width:200,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre+" "+e.apellidos:"-",children:e?e.nombre+" "+e.apellidos:"-"})}},{title:"Fecha Registro",dataIndex:"fecha_registro",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}},{title:"Fecha Liquidacion",dataIndex:"fecha_liquidado",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}},{title:"Estado Liquidado",dataIndex:"estado_liquidado",width:150,render:function(e){return Object(r.jsx)(ci,{estado:e})}}];return Object(r.jsx)(kn.a,{title:"Lista de Reiteradas",visible:n,onCancel:t,onOk:t,width:"90vw",centered:!0,children:Object(r.jsx)(In.a,{rowKey:"_id",dataSource:b,columns:h,loading:s,size:"small",scroll:{y:"65vh"},pagination:{defaultPageSize:50}})})},Ti=n(628),Ei=n(678);function Di(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return t(r.result)},r.onerror=function(e){return n(e)}}))}var Ni=Ke.a.Option,Ri=V.a.TextArea;var Mi=function(e){var t=e.visible,n=e.abrir,i=e.actualizarEstado,o=Object(a.useState)(null),c=Object(I.a)(o,2),s=c[0],l=c[1],d=Object(a.useState)(null),u=Object(I.a)(d,2),b=u[0],f=u[1],j=Object(a.useState)([]),h=Object(I.a)(j,2),p=h[0],O=h[1],g=Object(a.useState)(!1),x=Object(I.a)(g,2),m=x[0],v=x[1],_=Object(a.useState)(""),w=Object(I.a)(_,2),y=w[0],S=w[1];function C(){return(C=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(s,b,p);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){l(null),f(null),O([])}),[]);var k=function(){var e=Object(P.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Di(t.originFileObj);case 3:n=e.sent,v(!0),S(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)(kn.a,{title:"Editar estado de la orden",visible:t,onOk:function(){return C.apply(this,arguments)},onCancel:n,width:300,afterClose:function(){return f(null)},destroyOnClose:!0,centered:!0,children:[Object(r.jsxs)(Ke.a,{placeholder:"Seleccionar estado",defaultValue:s,onChange:function(e){return l(e)},style:{width:250,marginBottom:".5rem"},children:[Object(r.jsx)(Ni,{value:Ua,children:Bn(Ua)}),Object(r.jsx)(Ni,{value:Ja,children:Bn(Ja)}),Object(r.jsx)(Ni,{value:Ka,children:Bn(Ka)}),Object(r.jsx)(Ni,{value:Wa,children:Bn(Wa)}),Object(r.jsx)(Ni,{value:Za,children:Bn(Za)}),Object(r.jsx)(Ni,{value:Xa,children:Bn(Xa)}),Object(r.jsx)(Ni,{value:Qa,children:Bn(Qa)}),Object(r.jsx)(Ni,{value:$a,children:Bn($a)}),Object(r.jsx)(Ni,{value:ti,children:Bn(ti)}),Object(r.jsx)(Ni,{value:ni,children:Bn(ni)})]}),Object(r.jsx)(Ri,{placeholder:"Observacion",value:b,rows:4,onChange:function(e){return f(e.target.value)},style:{marginBottom:".5rem"}}),Object(r.jsx)("div",{style:{marginBottom:".5rem"},children:"Adjuntar im\xe1genes:"}),Object(r.jsxs)(Ti.a,{accept:".jpg,.png,.jpeg",listType:"picture-card",beforeUpload:function(e){var t=p;return e.status="done",t.push(e),O(t),!1},onRemove:function(e){var t=p.filter((function(t){return t.uid!==e.uid}));O(t)},onPreview:k,multiple:!0,children:[Object(r.jsx)(Ei.a,{})," ","Imagen"]}),Object(r.jsx)(kn.a,{visible:m,footer:null,onCancel:function(){return v(!m)},children:Object(r.jsx)("img",{alt:"example",style:{width:"100%"},src:y})})]})},qi=Ke.a.Option,Fi=V.a.TextArea;var Li=function(e){var t=e.visible,n=e.abrir,i=e.buckets,o=void 0===i?[]:i,c=e.tecnicos,s=void 0===c?[]:c,l=e.agendar,d=Object(a.useState)(null),u=Object(I.a)(d,2),b=u[0],f=u[1],j=Object(a.useState)(null),h=Object(I.a)(j,2),p=h[0],O=h[1],g=Object(a.useState)(null),x=Object(I.a)(g,2),m=x[0],v=x[1],_=Object(a.useState)(null),w=Object(I.a)(_,2),y=w[0],S=w[1],C=Object(a.useState)(null),k=Object(I.a)(C,2),A=k[0],T=k[1],E=Object(a.useState)(!1),D=Object(I.a)(E,2),N=D[0],R=D[1];Object(a.useEffect)((function(){f(null),O(null),v(null),S(null),T(null)}),[]);var M=function(){var e=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R(!0),e.next=3,l(b,p,m,y,A);case 3:R(!1),n();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(kn.a,{title:"Agendar Orden",width:400,visible:t,onCancel:n,onOk:M,confirmLoading:!0,destroyOnClose:!0,centered:!0,footer:[Object(r.jsx)(U.a,{onClick:n,children:"Cancelar"},"back"),Object(r.jsx)(U.a,{type:"primary",loading:N,onClick:M,children:"Aceptar"},"submit")],children:[Object(r.jsx)(Ke.a,{placeholder:"Seleccionar Bucket",style:{width:300,marginBottom:".5rem"},onChange:function(e){return f(e)},defaultValue:b,children:o&&o.length>0?o.map((function(e,t){return Object(r.jsx)(qi,{value:e.value,children:e.text},t)})):Object(r.jsx)(qi,{children:"Sin data"})}),Object(r.jsx)(Ke.a,{showSearch:!0,placeholder:"Seleccionar Tecnico",style:{width:300,marginBottom:".5rem"},onChange:function(e){return O(s[t=e].contrata._id),void v(s[t]._id);var t},defaultValue:m,filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},children:s&&s.length>0?s.map((function(e,t){return Object(r.jsx)(qi,{value:t,children:e&&e.nombre+" "+e.apellidos},t)})):Object(r.jsx)(qi,{children:"Sin data"})}),Object(r.jsx)(We.a,{placeholder:"Seleccionar fecha de cita",style:{width:300,marginBottom:".5rem"},onChange:function(e){return S(e.utc().format("YYYY-MM-DD HH:mm"))}}),Object(r.jsx)(Fi,{rows:4,style:{width:300},defaultValue:A,placeholder:"Observacion",onChange:function(e){return T(e.target.value)}})]})},zi=n(633),Bi=Ke.a.Option,Pi=V.a.TextArea;var Gi=function(e){var t=e.tipo,n=void 0!==t&&t,i=e.visible,o=e.abrir,c=e.contratas,s=void 0===c?[]:c,l=e.gestores,d=void 0===l?[]:l,u=e.tecnicos,b=void 0===u?[]:u,f=e.asignar,j=Object(a.useState)(null),h=Object(I.a)(j,2),p=h[0],O=h[1],g=Object(a.useState)(null),x=Object(I.a)(g,2),m=x[0],v=x[1],_=Object(a.useState)(null),w=Object(I.a)(_,2),y=w[0],S=w[1],C=Object(a.useState)([]),k=Object(I.a)(C,2),A=k[0],T=k[1],E=Object(a.useState)(null),D=Object(I.a)(E,2),N=D[0],R=D[1],M=Object(a.useState)(1),q=Object(I.a)(M,2),L=q[0],z=q[1];Object(a.useEffect)((function(){O(null),v(null),S(null),R(null)}),[]),Object(a.useEffect)((function(){Y()}),[b]),Object(a.useEffect)((function(){v(null),S(null)}),[]),Object(a.useEffect)((function(){v(null),S(null)}),[L]);var G=function(){var e=Object(P.a)(B.a.mark((function e(){var t,r,a,i;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=16;break}if(1!==L||!m){e.next=6;break}return e.next=4,f({gestor:m,observacion:N});case 4:e.next=14;break;case 6:if(!(2===L&&null!==y&&void 0!==y&&b.length>0&&y>=0)){e.next=13;break}return r={tecnico:b[t=y]?b[t]._id:null,auditor:b[t]&&b[t].auditor?b[t].auditor._id:null,gestor:b[t]&&b[t].gestor?b[t].gestor._id:null,contrata:b[t]&&b[t].contrata?b[t].contrata._id:null,observacion:N},e.next=11,f(r);case 11:e.next=14;break;case 13:F.a.warn("Error asignando (cliente/gestor).",{position:"top-right"});case 14:e.next=34;break;case 16:if(1!==L||!p){e.next=21;break}return e.next=19,f({contrata:p,observacion:N});case 19:e.next=34;break;case 21:if(2!==L||!m){e.next=26;break}return e.next=24,f({gestor:m,observacion:N});case 24:e.next=34;break;case 26:if(!(2===L&&y&&b.length>0&&y>=0)){e.next=33;break}return i={tecnico_liteyca:b[a=y]?b[a]._id:null,auditor:b[a]&&b[a].auditor?b[a].auditor._id:null,gestor_liteyca:b[a]&&b[a].gestor?b[a].gestor._id:null,contrata:b[a]&&b[a].contrata?b[a].contrata._id:null,observacion:N},e.next=31,f(i);case 31:e.next=34;break;case 33:F.a.warn("Error asignando (cliente/lider).",{position:"top-right"});case 34:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=function(){if(b&&b.length>0){var e=[],t=[];b.forEach((function(t){t&&t.gestor&&t.gestor.nombre&&!e.includes(t.gestor.nombre+" "+t.gestor.apellidos)&&e.push(t.gestor.nombre+" "+t.gestor.apellidos)})),e.filter((function(e){return e})).forEach((function(e){var n=b.filter((function(t){return t.gestor&&t.gestor.nombre&&t.gestor.nombre+" "+t.gestor.apellidos===e}));t.push({value:e,label:e,children:n.map((function(e){return{value:b.findIndex((function(t){return t._id===e._id})),label:e.nombre+" "+e.apellidos}}))})})),T(t.filter((function(e){return e})))}};return n?Object(r.jsxs)(kn.a,{title:"Asignar Orden",visible:i,onCancel:o,onOk:G,width:550,afterClose:function(){return R(null)},destroyOnClose:!0,centered:!0,children:[Object(r.jsx)("p",{children:"Asignar por Gestor o T\xe9cnico:"}),Object(r.jsxs)(Ze.a.Group,{onChange:function(e){return z(e.target.value)},defaultValue:L,style:{marginBottom:"1rem"},children:[Object(r.jsx)(Ze.a,{value:1,children:"Gestor"}),Object(r.jsx)(Ze.a,{value:2,children:"Tecnico"})]}),1===L?Object(r.jsx)(Ke.a,{showSearch:!0,value:m,placeholder:"Seleccionar Gestor",style:{width:350,marginBottom:".5rem"},onChange:function(e){return v(e)},filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},children:d&&d.length>0?d.map((function(e){return Object(r.jsx)(Bi,{value:e._id,children:"".concat(e.nombre," ").concat(e.apellidos)},e._id)})):Object(r.jsx)(Bi,{children:"No data"})}):Object(r.jsx)(zi.a,{options:A,onChange:function(e,t){return S(t&&t[1]?t[1].value:null)},placeholder:"Seleccionar Tecnico",style:{width:500,marginBottom:".5rem"},showSearch:{filter:function(e,t){return t.some((function(t){return t.label.toLowerCase().indexOf(e.toLowerCase())>-1}))}}}),Object(r.jsx)(Pi,{placeholder:"Observaci\xf3n",value:N,onChange:function(e){return R(e.target.value)},rows:5,style:{width:500}})]}):Object(r.jsxs)(kn.a,{title:"Asignar Orden",visible:i,onCancel:o,onOk:G,width:500,destroyOnClose:!0,centered:!0,children:[Object(r.jsx)("p",{children:"Asignar por Contrata, Gestor o T\xe9cnico:"}),Object(r.jsxs)(Ze.a.Group,{onChange:function(e){return z(e.target.value)},defaultValue:L,style:{marginBottom:"1rem"},children:[Object(r.jsx)(Ze.a,{value:1,children:"Contrata"}),Object(r.jsx)(Ze.a,{value:2,children:"Gestor"}),Object(r.jsx)(Ze.a,{value:3,children:"Tecnico"})]}),1===L?Object(r.jsx)(Ke.a,{showSearch:!0,value:p,placeholder:"Seleccionar Contrata",style:{width:350,marginBottom:".5rem"},onChange:function(e){return O(e)},filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},children:s&&s.length>0?s.map((function(e){return Object(r.jsx)(Bi,{value:e._id,children:e.nombre},e._id)})):Object(r.jsx)(Bi,{children:"No data"})}):2===L?Object(r.jsx)(Ke.a,{showSearch:!0,value:m,placeholder:"Seleccionar Gestor",style:{width:350,marginBottom:".5rem"},onChange:function(e){return v(e)},filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},children:d&&d.length>0?d.map((function(e){return Object(r.jsx)(Bi,{value:e._id,children:"".concat(e.nombre," ").concat(e.apellidos)},e._id)})):Object(r.jsx)(Bi,{children:"No data"})}):Object(r.jsx)(Ke.a,{showSearch:!0,value:y,placeholder:"Seleccionar Tecnico",style:{width:350,marginBottom:".5rem"},onChange:function(e){return S(e)},filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},children:b&&b.length>0?b.map((function(e,t){return Object(r.jsx)(Bi,{value:t,children:"".concat(e.nombre," ").concat(e.apellidos)},e._id)})):Object(r.jsx)(Bi,{children:"No data"})}),Object(r.jsx)(Pi,{placeholder:"Observaci\xf3n",onChange:function(e){return R(e.target.value)},rows:4,style:{width:350}})]})},Yi=function(e){switch(e){case"cancelado":return{background:rr.grey[1],color:rr.grey.primary};case"completado":case Za:return{background:rr.green[1],color:rr.green.primary};case Ka:return{background:rr.blue[1],color:rr.blue.primary};case Ja:return{background:rr.cyan[1],color:rr.cyan.primary};case"iniciado":return{background:rr.geekblue[1],color:rr.geekblue.primary};case"no realizada":return{background:rr.magenta[1],color:rr.magenta.primary};case Ua:return{background:rr.orange[1],color:rr.orange.primary};case Xa:case ni:return{background:rr.red[1],color:rr.red.primary};case ti:case ei:return{background:rr.purple[1],color:rr.purple.primary};case"efectiva":return{background:rr.green[1],color:rr.green.primary};case"inefectiva":return{background:rr.red[1],color:rr.red.primary};case"no_corresponde":return{background:"#DBDBDB",color:rr.grey.primary};default:return{background:"",color:""}}},Hi=function(e,t,n){return n&&"-"!==n?{background:rr.blue[1],color:rr.blue.primary}:t===fn?Number(e)<12?{background:rr.green[1],color:rr.green.primary}:Number(e)>=12&&Number(e)<24?{background:rr.orange[1],color:rr.orange.primary}:Number(e)>=24?{background:rr.red[1],color:rr.red.primary}:{background:"",color:""}:t===jn?Number(e)<24?{background:rr.green[1],color:rr.green.primary}:Number(e)>=24&&Number(e)<72?{background:rr.orange[1],color:rr.orange.primary}:Number(e)>=72?{background:rr.red[1],color:rr.red.primary}:{background:"",color:""}:{background:"",color:""}},Vi=function(e,t){return t&&"-"!==t?{background:rr.blue[1],color:rr.blue.primary}:Number(e)<1?{background:rr.green[1],color:rr.green.primary}:Number(e)>=1&&Number(e)<5?{background:rr.orange[1],color:rr.orange.primary}:Number(e)>=5?{background:rr.red[1],color:rr.red.primary}:{background:"",color:""}};var Ui=function(e){var t=e.metodo,n=e.tipo,i=e.setLoading,o=e.ordenesSeleccionadas,s=void 0===o?[]:o,l=Object(a.useState)([]),d=Object(I.a)(l,2),u=d[0],b=d[1],f=Object(a.useRef)(null);function j(e){return h.apply(this,arguments)}function h(){return(h=Object(P.a)(B.a.mark((function e(r){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r||!(s.length<=0)){e.next=2;break}return e.abrupt("return");case 2:return i(!0),e.next=5,li(!0,{metodo:t,todo:r,tipo:n,id_ordenes:s}).then(function(){var e=Object(P.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=t.data)&&n.length>0)){e.next=5;break}return e.next=4,b(n.map((function(e){return Object(c.a)(Object(c.a)({},e),{},{infancia_registro:e.infancia&&e.infancia.fecha_registro?Qe()(e.infancia.fecha_registro).format("DD/MM/YY HH:mm"):"-",infancia_liquidado:e.infancia&&e.infancia.fecha_liquidado?Qe()(e.infancia.fecha_liquidado).format("DD/MM/YY HH:mm"):"-",fecha_cita:e.fecha_cita?Qe()(e.fecha_cita).format("DD/MM/YY"):"-",fecha_registro:e.fecha_registro?Qe()(e.fecha_registro).format("DD/MM/YY HH:mm"):"-",fecha_asignado:e.fecha_asignado?Qe()(e.fecha_asignado).format("DD/MM/YY HH:mm"):"-",horas_registro:e.fecha_registro?Qe()().diff(e.fecha_registro,"hours"):"-",horas_asignado:e.fecha_asignado?Qe()().diff(e.fecha_asignado,"hours"):"-",dias_asignado:e.fecha_asignado?Qe()().diff(e.fecha_asignado,"days"):"-"})})));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log(e)})).finally((function(){return i(!1)}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){u&&u.length>0&&function(e){try{var t=e.workbookOptions(),n=t.sheets[0].rows,r=-1,a=-1,i=-1,o=-1,c=-1,s=-1,l=-1;n.forEach((function(e){"header"===e.type&&(r=e.cells.findIndex((function(e){return"Negocio"===e.value})),a=e.cells.findIndex((function(e){return"Estado Toa"===e.value})),i=e.cells.findIndex((function(e){return"Estado Gestor"===e.value})),o=e.cells.findIndex((function(e){return"Horas Registro"===e.value})),c=e.cells.findIndex((function(e){return"Horas Asignado"===e.value})),s=e.cells.findIndex((function(e){return"Dias Asignado"===e.value})),l=e.cells.findIndex((function(e){return"Time Slot"===e.value}))),"data"===e.type&&(e.cells.forEach((function(e){e.borderBottom={size:.5},e.borderLeft={size:.5},e.borderRight={size:.5},e.borderTop={size:.5}})),a>-1&&(e.cells[a].background=Yi(e.cells[a].value).background,e.cells[a].color=Yi(e.cells[a].value).color,e.cells[a].value=Bn(e.cells[a].value),e.cells[a].textAlign="center"),i>-1&&(e.cells[i].background=Yi(e.cells[i].value).background,e.cells[i].color=Yi(e.cells[i].value).color,e.cells[i].value=Bn(e.cells[i].value),e.cells[i].textAlign="center"),o>-1&&l>-1&&r>-1&&(e.cells[o].background=Hi(e.cells[o].value,e.cells[r].value,e.cells[l].value).background,e.cells[o].color=Hi(e.cells[o].value,e.cells[r].value,e.cells[l].value).color,e.cells[o].textAlign="center"),c>-1&&l>-1&&r>-1&&(e.cells[c].background=Hi(e.cells[c].value,e.cells[r].value,e.cells[l].value).background,e.cells[c].color=Hi(e.cells[c].value,e.cells[r].value,e.cells[l].value).color,e.cells[c].textAlign="center"),s>-1&&l>-1&&(e.cells[s].background=Vi(e.cells[s].value,e.cells[l].value).background,e.cells[s].color=Vi(e.cells[s].value,e.cells[l].value).color,e.cells[s].textAlign="center"))})),e.save(t)}catch(d){console.log(d)}}(f.current)}),[u]);var p={background:"#F3C775",bold:!0,fontSize:17,autoWidth:!0};return Object(r.jsxs)(ge.a,{children:[Object(r.jsx)(ge.a.Item,{style:{margin:0,heigth:"2.1rem"},onClick:function(){return j(!0)},children:"Todo"},1),Object(r.jsx)(ge.a.Item,{style:{margin:0,heigth:"2.1rem"},onClick:function(){return j(!1)},children:"Seleccionado"},2),Object(r.jsxs)(wa.a,{data:u,fileName:"pendientes_".concat(n,"_").concat(Qe()().format("DD_MM_YYYY"),".xlsx"),ref:f,children:["gestor"===n?Object(r.jsx)(wa.b,{field:"tipo",title:"Negocio",locked:!0,width:90,headerCellOptions:p}):null,Object(r.jsx)(wa.b,{field:"codigo_requerimiento",title:"Requerimiento",locked:!0,width:90,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"codigo_cliente",title:"Codigo Cliente",headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"nombre_cliente",title:"Cliente",width:340,headerCellOptions:p}),"gestor"===n||n===jn?Object(r.jsx)(wa.b,{field:"codigo_trabajo",title:"Orden Trabajo",width:90,headerCellOptions:p}):null,"gestor"===n||n===jn?Object(r.jsx)(wa.b,{field:"codigo_peticion",title:"Petici\xf3n",width:90,headerCellOptions:p}):null,"gestor"===n||n===jn?Object(r.jsx)(wa.b,{field:"tipo_requerimiento",title:"Tipo Req.",width:90,headerCellOptions:p}):null,Object(r.jsx)(wa.b,{field:"tipo_tecnologia",title:"Tecnolog\xeda",width:90,headerCellOptions:p}),"gestor"===n||n===jn?Object(r.jsx)(wa.b,{field:"indicador_pai",title:"PAI",width:90,headerCellOptions:p}):null,Object(r.jsx)(wa.b,{field:"codigo_ctr",title:"CTR",width:60,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"codigo_nodo",title:"Nodo",width:60,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"codigo_troba",title:"Troba",width:60,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"subtipo_actividad",title:"Subtipo Actividad",width:170,headerCellOptions:p}),"gestor"===n||n===fn?Object(r.jsx)(wa.b,{field:"numero_reiterada",title:"Reiterada",width:90,headerCellOptions:p}):null,"gestor"===n||n===fn?Object(r.jsx)(wa.b,{field:"infancia.codigo_requerimiento",title:"Infancia Req.",width:90,headerCellOptions:p}):null,"gestor"===n||n===fn?Object(r.jsx)(wa.b,{field:"infancia.codigo_ctr",title:"Infancia CTR",width:120,headerCellOptions:p}):null,"gestor"===n||n===fn?Object(r.jsx)(wa.b,{field:"infancia.tecnico_liquidado.apellidos",title:"Infancia Tecnico",width:200,headerCellOptions:p}):null,"gestor"===n||n===fn?Object(r.jsx)(wa.b,{field:"infancia.tecnico_liquidado.carnet",title:"Infancia Carnet",width:120,headerCellOptions:p}):null,"gestor"===n||n===fn?Object(r.jsx)(wa.b,{field:"infancia_registro",title:"Infancia Registro",width:120,headerCellOptions:p}):null,"gestor"===n||n===fn?Object(r.jsx)(wa.b,{field:"infancia_liquidado",title:"Infancia Liquidado",width:120,headerCellOptions:p}):null,Object(r.jsx)(wa.b,{field:"distrito",title:"Distrito",width:200,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"direccion",title:"Direcci\xf3n",width:300,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"bucket",title:"Bucket",width:200,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"contrata.nombre",title:"Contrata",width:250,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"gestor_liteyca.nombre",title:"Gestor Asignado",width:250,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"auditor.nombre",title:"Auditor",width:250,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"tecnico.nombre",title:"Tecnico Nombre",width:200,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"tecnico.apellidos",title:"Tecnico Apellidos",width:200,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"tecnico.carnet",title:"Tecnico Carnet",width:120,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"estado_toa",title:"Estado Toa",width:120,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"estado_gestor",title:"Estado Gestor",width:120,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"tipo_agenda",title:"Time Slot",width:100,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"fecha_cita",title:"Fecha Cita",width:100,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"fecha_registro",title:"Fecha Registro",width:150,headerCellOptions:p}),"gestor"===n||n===jn?Object(r.jsx)(wa.b,{field:"fecha_asignado",title:"Fecha Asignado",width:150,headerCellOptions:p}):null,"gestor"===n||n===fn?Object(r.jsx)(wa.b,{field:"horas_registro",title:"Horas Registro",width:90,headerCellOptions:p}):null,"gestor"===n||n===jn?Object(r.jsx)(wa.b,{field:"horas_asignado",title:"Horas Asignado",width:90,headerCellOptions:p}):null,"gestor"===n||n===jn?Object(r.jsx)(wa.b,{field:"dias_asignado",title:"Dias Asignado",width:90,headerCellOptions:p}):null,Object(r.jsx)(wa.b,{field:"detalle_trabajo",title:"Detalle Ttrabajo",width:340,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"observacion_gestor",title:"Observacion Gestor",width:340,headerCellOptions:p}),Object(r.jsx)(wa.b,{field:"observacion_toa",title:"Observacion Toa",width:340,headerCellOptions:p}),"gestor"!==n?Object(r.jsx)(wa.b,{field:"tipo",title:"Negocio",locked:!0,width:90,headerCellOptions:p}):null]})]})},Ki=V.a.Search;var Ji=function(e){var t=e.gestores,n=void 0===t?[]:t,i=e.tecnicos,o=void 0===i?[]:i,s=Object(a.useState)([]),l=Object(I.a)(s,2),d=l[0],u=l[1],b=Object(a.useState)([]),f=Object(I.a)(b,2),j=f[0],h=f[1],p=Object(a.useState)(!1),O=Object(I.a)(p,2),g=O[0],x=O[1],m=Object(a.useState)([]),v=Object(I.a)(m,2),_=v[0],w=v[1],y=Object(a.useState)([]),S=Object(I.a)(y,2),C=S[0],k=S[1],A=Object(a.useState)([]),T=Object(I.a)(A,2),E=T[0],D=T[1],N=Object(a.useState)(!1),R=Object(I.a)(N,2),M=R[0],q=R[1],L=Object(a.useState)(!1),z=Object(I.a)(L,2),G=z[0],Y=z[1],H=Object(a.useState)(!1),V=Object(I.a)(H,2),K=V[0],J=V[1],W=Object(a.useState)(!1),Z=Object(I.a)(W,2),X=Z[0],Q=Z[1],$=Object(a.useState)(!1),ee=Object(I.a)($,2),te=ee[0],ne=ee[1],re=Object(a.useState)(!1),ae=Object(I.a)(re,2),ie=ae[0],oe=ae[1],ce=Object(a.useState)(!1),se=Object(I.a)(ce,2),le=se[0],de=se[1],ue=Object(a.useState)(!1),be=Object(I.a)(ue,2),fe=be[0],je=be[1],he=Object(a.useState)(!1),pe=Object(I.a)(he,2),ge=pe[0],xe=pe[1],me=Object(a.useState)(!1),ve=Object(I.a)(me,2),_e=ve[0],we=ve[1],ye=Object(a.useState)(!1),Se=Object(I.a)(ye,2),Ce=Se[0],ke=Se[1],Ie=Object(a.useState)(null),Ae=Object(I.a)(Ie,2),Te=Ae[0],Ee=Ae[1];function De(){return Ne.apply(this,arguments)}function Ne(){return(Ne=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),e.next=3,li(!0,{metodo:qt,todo:!0}).then((function(e){var t=e.data;t&&u(t)})).catch((function(e){return console.log(e)})).finally((function(){return x(!1)}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Re(e){return Me.apply(this,arguments)}function Me(){return(Me=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k([t]);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qe(e){return Fe.apply(this,arguments)}function Fe(){return(Fe=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return J(!0),e.next=3,li(!0,{metodo:zt,id:t}).then((function(e){var t=e.data;t&&t.length>0&&w(t)})).catch((function(e){return console.log(e)})).finally((function(){return J(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Le(){return(Le=Object(P.a)(B.a.mark((function e(t,n,r,a,i){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(E&&E.length>0)){e.next=4;break}return q(!0),e.next=4,bi({metodo:Gt,ordenes:E,bucket:t,contrata:n,tecnico:r,fecha_cita:a,observacion:i}).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,De();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)})).finally((function(){return q(!1)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ze(){return(ze=Object(P.a)(B.a.mark((function e(t,n){var r,a,i=arguments;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>2&&void 0!==i[2]?i[2]:[],!(E&&E.length>0)){e.next=12;break}return(a=new FormData).append("metodo",Ht),a.append("ordenes",JSON.stringify(E)),a.append("estado",t),a.append("observacion",n),r.forEach((function(e){a.append("files",e)})),Y(!0),Ye(),e.next=12,fi(a).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,De();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)})).finally((function(){return Y(!1)}));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){De()}),[]),Object(a.useEffect)((function(){d.length>0&&h(d)}),[d]);var Be=function(){return oe(!ie)},Pe=function(){return de(!le)},Ge=function(){return je(!fe)},Ye=function(){return xe(!ge)},He=function(){return we(!_e)},Ve=function(){return ke(!Ce)},Ue=function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ge(),e.next=3,Re(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ke=function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return He(),e.next=3,qe(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Je(){return(Je=Object(P.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(E&&E.length>0)){e.next=8;break}return n=t,Q(!0),Ve(),e.next=6,bi(Object(c.a)({metodo:Yt,ordenes:E},n)).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,De();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)})).finally((function(){return Q(!1)}));case 6:e.next=9;break;case 8:F.a.warn("No hay ordenes seleccionadas.",{position:"top-right"});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.jsxs)("div",{style:{marginBottom:".5rem",marginTop:"1rem"},children:[Object(r.jsxs)("div",{children:[Object(r.jsx)(U.a,{type:"primary",icon:g?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ta.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},onClick:De,children:"Actualizar"}),Object(r.jsx)(U.a,{icon:M?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(Oe.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},disabled:0===E.length,onClick:Be,children:"Agendar"}),Object(r.jsx)(U.a,{icon:X?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(za.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},disabled:0===E.length,onClick:Ve,children:"Asignar"}),Object(r.jsx)(U.a,{icon:G?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(Ba.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},disabled:0===E.length,onClick:Ye,children:"Estado"}),Object(r.jsx)(Ki,{placeholder:"Requerimiento...",onSearch:function(e){e&&e.length>1?h(d.filter((function(t){return String(t.codigo_requerimiento).includes(e)}))):h(d)},style:{width:180,marginRight:".5rem"},allowClear:!0}),Object(r.jsx)(La.a,{overlay:Object(r.jsx)(Ui,{metodo:Mt,tipo:"gestor",setLoading:ne,ordenesSeleccionadas:E}),placement:"bottomLeft",trigger:["click"],arrow:!0,children:Object(r.jsx)(U.a,{icon:te?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ya.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},children:"Exportar"})})]}),Object(r.jsx)(wi,{asignadas:!0,data:j,loading:g,ordenesSeleccionadas:E,setOrdenesSeleccionadas:D,abrirReiterada:function(e){Ee(e),Pe()},abrirInfancia:Ue,abrirRegistro:Ke}),Object(r.jsx)(Gi,{tipo:!0,visible:Ce,abrir:Ve,gestores:n,tecnicos:o,asignar:function(e){return Je.apply(this,arguments)}}),Object(r.jsx)(Li,{visible:ie,abrir:Be,buckets:Va,tecnicos:o,agendar:function(e,t,n,r,a){return Le.apply(this,arguments)}}),Object(r.jsx)(Mi,{visible:ge,abrir:Ye,actualizarEstado:function(e,t){return ze.apply(this,arguments)}}),Object(r.jsx)(Ai,{visible:le,abrir:Pe,codigo_cliente:Te}),Object(r.jsx)(ki,{visible:fe,abrir:Ge,loading:!1,orden:C}),Object(r.jsx)(Si,{visible:_e,abrir:He,loading:K,registros:_})]})},Wi=Le.a.Text;var Zi=function(e){var t=e.tipo,n=e.setLoading,i=e.ordenesSeleccionadas,o=void 0===i?[]:i,s=e.fechaInicio,l=e.fechaFin,d=Object(a.useState)([]),u=Object(I.a)(d,2),b=u[0],f=u[1],j=Object(a.useRef)(null);function h(e){return p.apply(this,arguments)}function p(){return(p=Object(P.a)(B.a.mark((function e(r){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(2===r&&o.length<=0)){e.next=4;break}return e.abrupt("return",F.a.warn("Debes seleccionar algunas ordenes primero.",{position:"top-right"}));case 4:if(3!==r||s){e.next=8;break}return e.abrupt("return",F.a.warn("Debes seleccionar la fecha de inicio.",{position:"top-right"}));case 8:if(3!==r||l){e.next=12;break}return e.abrupt("return",F.a.warn("Debes seleccionar la fecha de fin.",{position:"top-right"}));case 12:return n(!0),e.next=15,li(!0,{metodo:Rt,todo:1===r,tipo:t,id_ordenes:o,fechaInicio:3===r?s:null,fechaFin:3===r?l:null}).then(function(){var e=Object(P.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,e.next=3,g(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){return O(j.current)})).catch((function(e){return console.log(e)})).finally((function(){return n(!1)}));case 15:return e.abrupt("return",e.sent);case 16:case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e){try{var t=e.workbookOptions(),n=t.sheets[0].rows,r=-1,a=-1,i=-1,o=-1,c=-1,s=-1,l=-1;n.forEach((function(e){"header"===e.type&&(r=e.cells.findIndex((function(e){return"Negocio"===e.value})),a=e.cells.findIndex((function(e){return"Estado Toa"===e.value})),i=e.cells.findIndex((function(e){return"Estado Gestor"===e.value})),o=e.cells.findIndex((function(e){return"Estado Liquidado"===e.value})),c=e.cells.findIndex((function(e){return"Horas Registro"===e.value})),s=e.cells.findIndex((function(e){return"Horas Asignado"===e.value})),l=e.cells.findIndex((function(e){return"Time Slot"===e.value}))),"data"===e.type&&(e.cells.forEach((function(e){e.borderBottom={size:.5},e.borderLeft={size:.5},e.borderRight={size:.5},e.borderTop={size:.5}})),a>-1&&(e.cells[a].background=Yi(e.cells[a].value).background,e.cells[a].color=Yi(e.cells[a].value).color,e.cells[a].value=Bn(e.cells[a].value),e.cells[a].textAlign="center"),i>-1&&(e.cells[i].background=Yi(e.cells[i].value).background,e.cells[i].color=Yi(e.cells[i].value).color,e.cells[i].value=Bn(e.cells[i].value),e.cells[i].textAlign="center"),o>-1&&(e.cells[o].background=Yi(e.cells[o].value).background,e.cells[o].color=Yi(e.cells[o].value).color,e.cells[o].value=Bn(e.cells[o].value),e.cells[o].textAlign="center"),c>-1&&l>-1&&r>-1&&(e.cells[c].background=Hi(e.cells[c].value,e.cells[r].value,e.cells[l].value).background,e.cells[c].color=Hi(e.cells[c].value,e.cells[r].value,e.cells[l].value).color,e.cells[c].textAlign="center"),s>-1&&l>-1&&r>-1&&(e.cells[s].background=Hi(e.cells[s].value,e.cells[r].value,e.cells[l].value).background,e.cells[s].color=Hi(e.cells[s].value,e.cells[r].value,e.cells[l].value).color,e.cells[s].textAlign="center"))})),e.save(t)}catch(d){console.log(d)}}function g(e){return x.apply(this,arguments)}function x(){return(x=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&t.length>0)){e.next=6;break}return e.next=3,f(t.map((function(e){return Object(c.a)(Object(c.a)({},e),{},{fecha_cita:e.fecha_cita?Qe()(e.fecha_cita).format("DD/MM/YY"):"-",fecha_registro:e.fecha_registro?Qe()(e.fecha_registro).format("DD/MM/YY HH:mm"):"-",fecha_asignado:e.fecha_asignado?Qe()(e.fecha_asignado).format("DD/MM/YY HH:mm"):"-",fecha_liquidado:e.fecha_liquidado?Qe()(e.fecha_liquidado).format("DD/MM/YY HH:mm"):"-",horas_registro:e.fecha_registro?Qe()(e.fecha_liquidado).diff(e.fecha_registro,"hours"):"-",horas_asignado:e.fecha_asignado?Qe()(e.fecha_liquidado).diff(e.fecha_asignado,"hours"):"-"})})));case 3:return e.abrupt("return",e.sent);case 6:f([]);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m={background:"#60CE48",bold:!0,fontSize:17,autoWidth:!0};return Object(r.jsxs)(ge.a,{children:[Object(r.jsx)(ge.a.Item,{style:{margin:0,heigth:"2.1rem"},onClick:function(){return h(1)},children:"Hoy"},1),Object(r.jsx)(ge.a.Item,{style:{margin:0,heigth:"2.1rem"},onClick:function(){return h(2)},children:"Seleccionado"},2),Object(r.jsx)(ge.a.Item,{style:{margin:0,heigth:"2.1rem"},onClick:function(){return h(3)},children:"Fechas"},3),Object(r.jsxs)(wa.a,{data:b,fileName:"liquidadas_".concat(t,"_").concat(Qe()().format("DD_MM_YYYY"),".xlsx"),ref:j,children:["gestor"===t?Object(r.jsx)(wa.b,{field:"tipo",title:"Negocio",locked:!0,width:90,headerCellOptions:m}):null,Object(r.jsx)(wa.b,{field:"codigo_requerimiento",title:"Requerimiento",locked:!0,width:90,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"tipo_averia",title:"Tipo Averia",locked:!0,width:90,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"codigo_cliente",title:"Codigo Cliente",headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"nombre_cliente",title:"Cliente",width:340,headerCellOptions:m}),"gestor"===t||t===jn?Object(r.jsx)(wa.b,{field:"codigo_trabajo",title:"Orden Trabajo",width:90,headerCellOptions:m}):null,"gestor"===t||t===jn?Object(r.jsx)(wa.b,{field:"codigo_peticion",title:"Petici\xf3n",width:90,headerCellOptions:m}):null,"gestor"===t||t===jn?Object(r.jsx)(wa.b,{field:"tipo_requerimiento",title:"Tipo Req.",width:90,headerCellOptions:m}):null,Object(r.jsx)(wa.b,{field:"tipo_tecnologia",title:"Tecnolog\xeda",width:90,headerCellOptions:m}),"gestor"===t||t===jn?Object(r.jsx)(wa.b,{field:"indicador_pai",title:"PAI",width:90,headerCellOptions:m}):null,Object(r.jsx)(wa.b,{field:"codigo_ctr",title:"CTR",width:60,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"codigo_nodo",title:"Nodo",width:60,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"codigo_troba",title:"Troba",width:60,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"subtipo_actividad",title:"Subtipo Actividad",width:170,headerCellOptions:m}),"gestor"===t||t===fn?Object(r.jsx)(wa.b,{field:"numero_reiterada",title:"Reiterada",width:90,headerCellOptions:m}):null,"gestor"===t||t===fn?Object(r.jsx)(wa.b,{field:"infancia.codigo_requerimiento",title:"Infancia Req.",width:90,headerCellOptions:m}):null,"gestor"===t||t===fn?Object(r.jsx)(wa.b,{field:"infancia.codigo_ctr",title:"Infancia CTR",width:120,headerCellOptions:m}):null,Object(r.jsx)(wa.b,{field:"distrito",title:"Distrito",width:200,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"bucket",title:"Bucket",width:200,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"contrata.nombre",title:"Contrata",width:250,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"gestor.nombre",title:"Gestor",width:250,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"auditor.nombre",title:"Auditor",width:250,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"tecnico.nombre",title:"Tecnico Nombre",width:200,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"tecnico.apellidos",title:"Tecnico Apellidos",width:200,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"tecnico.carnet",title:"Tecnico Carnet",width:120,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"estado_toa",title:"Estado Toa",width:120,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"estado_gestor",title:"Estado Gestor",width:120,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"estado_liquidado",title:"Estado Liquidado",width:120,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"tipo_agenda",title:"Time Slot",width:100,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"fecha_cita",title:"Fecha Cita",width:100,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"fecha_registro",title:"Fecha Registro",width:150,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"fecha_liquidado",title:"Fecha Liquidado",width:150,headerCellOptions:m}),"gestor"===t||t===jn?Object(r.jsx)(wa.b,{field:"fecha_asignado",title:"Fecha Asignado",width:150,headerCellOptions:m}):null,"gestor"===t||t===fn?Object(r.jsx)(wa.b,{field:"horas_registro",title:"Horas Registro",width:90,headerCellOptions:m}):null,"gestor"===t||t===jn?Object(r.jsx)(wa.b,{field:"horas_asignado",title:"Horas Asignado",width:90,headerCellOptions:m}):null,Object(r.jsx)(wa.b,{field:"observacion_gestor",title:"Observacion Gestor",width:340,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"observacion_toa",title:"Observacion Toa",width:340,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"observacion_liquidado",title:"Observacion Liquidado",width:340,headerCellOptions:m}),Object(r.jsx)(wa.b,{field:"descripcion_codigo_liquidado",title:"Descripci\xf3n Liquidado",width:150,headerCellOptions:m}),"gestor"!==t?Object(r.jsx)(wa.b,{field:"tipo",title:"Negocio",locked:!0,width:90,headerCellOptions:m}):null]})]})},Xi=Le.a.Text;var Qi=We.a.RangePicker;var $i=function(e){var t=e.tipo,n=e.gestor,i=Object(a.useState)([]),o=Object(I.a)(i,2),c=o[0],s=o[1],l=Object(a.useState)([]),d=Object(I.a)(l,2),u=d[0],b=d[1],f=Object(a.useState)([]),j=Object(I.a)(f,2),h=j[0],p=j[1],O=Object(a.useState)(!1),g=Object(I.a)(O,2),x=g[0],m=g[1],v=Object(a.useState)(!1),_=Object(I.a)(v,2),w=_[0],y=_[1],S=Object(a.useState)(!1),C=Object(I.a)(S,2),k=C[0],A=C[1],T=Object(a.useState)(!1),E=Object(I.a)(T,2),D=E[0],N=E[1],R=Object(a.useState)(!1),M=Object(I.a)(R,2),q=M[0],L=M[1],z=Object(a.useState)([]),G=Object(I.a)(z,2),Y=G[0],H=G[1],V=Object(a.useState)([]),K=Object(I.a)(V,2),J=K[0],W=K[1],Z=Object(a.useState)([]),X=Object(I.a)(Z,2),Q=X[0],$=X[1],ee=Object(a.useState)([]),te=Object(I.a)(ee,2),ne=te[0],re=te[1],ae=Object(a.useState)([]),ie=Object(I.a)(ae,2),oe=ie[0],ce=ie[1],se=Object(a.useState)([]),le=Object(I.a)(se,2),de=le[0],ue=le[1],be=Object(a.useState)([]),fe=Object(I.a)(be,2),je=fe[0],he=fe[1],pe=Object(a.useState)([]),Oe=Object(I.a)(pe,2),ge=Oe[0],xe=Oe[1],me=Object(a.useState)([]),ve=Object(I.a)(me,2),_e=ve[0],we=ve[1],ye=Object(a.useState)([]),Se=Object(I.a)(ye,2),Ce=Se[0],ke=Se[1],Ie=Object(a.useState)(!1),Ae=Object(I.a)(Ie,2),Te=Ae[0],Ee=Ae[1],De=Object(a.useState)(null),Ne=Object(I.a)(De,2),Re=Ne[0],Me=Ne[1],qe=Object(a.useState)(null),Fe=Object(I.a)(qe,2),Le=Fe[0],ze=Fe[1];function Be(){return Pe.apply(this,arguments)}function Pe(){return(Pe=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),m(!0),p([]),e.next=5,li(!0,{metodo:Tt,tipo:t,fechaInicio:null,fechaFin:null}).then((function(e){var t=e.data;t&&t.length>0?Je(t):Ke()})).catch((function(e){return console.log(e)})).finally((function(){y(!1),m(!1)}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ge(){return(Ge=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Re||!Le){e.next=8;break}return y(!0),A(!0),p([]),e.next=6,li(!0,{metodo:Tt,tipo:t,fechaInicio:Re,fechaFin:Le}).then((function(e){var t=e.data;t&&t.length>0?Je(t):Ke()})).catch((function(e){return console.log(e)})).finally((function(){y(!1),A(!1)}));case 6:e.next=9;break;case 8:F.a.warn("Debes seleccionar un rango de fechas.",{position:"top-right"});case 9:case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){Be()}),[]);var Ye=function(){return Ee(!Te)};function He(e){return Ve.apply(this,arguments)}function Ve(){return(Ve=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(!0),e.next=3,li(!0,{metodo:zt,id:t}).then((function(e){var t=e.data;t&&t.length>0&&b(t)})).catch((function(e){return console.log(e)})).finally((function(){return L(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ue=function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ye(),e.next=3,He(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ke=function(){s([]),H([]),W([]),$([]),he([]),xe([]),re([])},Je=function(e){s(e),H(Ur(e,"distrito")),W(Ur(e,"estado_toa")),$(Ur(e,"estado_gestor")),he(Ur(e,"tipo_tecnologia")),xe(Ur(e,"codigo_nodo")),we(Ur(e,"codigo_ctr")),ke(Ur(e,"tipo_agenda")),re(Vr(e,"contrata")),ce(Vr(e,"gestor",!0)),ue(Vr(e,"tecnico_liquidado"))};return Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{children:[Object(r.jsx)(U.a,{type:"primary",icon:x?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ta.a,{}),disabled:x,style:{marginBottom:"1rem",marginRight:".5rem"},onClick:Be,children:"Actualizar"}),Object(r.jsx)(La.a,{overlay:Object(r.jsx)(Zi,{tipo:n?"gestor":t,setLoading:N,ordenesSeleccionadas:h,fechaInicio:Re,fechaFin:Le}),placement:"bottomLeft",trigger:["click"],arrow:!0,children:Object(r.jsx)(U.a,{icon:D?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ya.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},disabled:D,children:"Exportar"})}),Object(r.jsx)(Qi,{onChange:function(e){e?(Me(e[0].format("YYYY/MM/DD")),ze(e[1].format("YYYY/MM/DD"))):(Me(null),ze(null))},style:{marginBottom:"1rem",marginRight:".5rem"}}),Object(r.jsx)(U.a,{type:"primary",icon:k?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ea.a,{}),disabled:k,onClick:function(){return Ge.apply(this,arguments)},children:"Buscar"})]}),Object(r.jsx)(In.a,{rowKey:"_id",rowSelection:{columnWidth:50,selectedRowKeys:h,onChange:function(e){return p(e)}},columns:n?function(){var e=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[],t=arguments.length>9?arguments[9]:void 0,n=arguments.length>10?arguments[10]:void 0;return[{title:"#",width:50,fixed:"left",render:function(e,t,n){return n+1}},{title:"Negocio",dataIndex:"tipo",width:100,fixed:"left"},{title:"Requerimiento",dataIndex:"codigo_requerimiento",width:120,fixed:"left",render:function(e){return Object(r.jsx)(Xi,{copyable:!0,children:e})}},{title:"Codigo Cliente",dataIndex:"codigo_cliente",width:120,render:function(e){return Object(r.jsx)(Xi,{copyable:!0,children:e})}},{title:"Tecnologia",dataIndex:"tipo_tecnologia",align:"center",width:120,filters:(arguments.length>4&&void 0!==arguments[4]?arguments[4]:[])||[],onFilter:function(e,t){return 0===t.tipo_tecnologia.indexOf(e)}},{title:"CTR",dataIndex:"codigo_ctr",width:60,filters:(arguments.length>6&&void 0!==arguments[6]?arguments[6]:[])||[],onFilter:function(e,t){return 0===String(t.codigo_ctr).indexOf(String(e))}},{title:"Nodo",dataIndex:"codigo_nodo",width:70,filters:(arguments.length>5&&void 0!==arguments[5]?arguments[5]:[])||[],onFilter:function(e,t){return 0===t.codigo_nodo.indexOf(e)}},{title:"Troba",dataIndex:"codigo_troba",width:70,sorter:function(e,t){return e.codigo_troba<t.codigo_troba?-1:e.codigo_troba>t.codigo_troba?1:0}},{title:"Distrito",dataIndex:"distrito",width:160,filters:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[])||[],onFilter:function(e,t){return 0===t.distrito.indexOf(e)}},{title:"Estado Toa",dataIndex:"estado_toa",width:150,align:"center",filters:(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[])||[],onFilter:function(e,t){return 0===t.estado_toa.indexOf(e)},render:function(e){return Object(r.jsx)(ci,{estado:e})}},{title:"Estado Gestor",dataIndex:"estado_gestor",width:150,align:"center",filters:(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[])||[],onFilter:function(e,t){return 0===t.estado_gestor.indexOf(e)},render:function(e){return Object(r.jsx)(ci,{estado:e})}},{title:"Estado Liquidado",dataIndex:"estado_liquidado",width:150,align:"center",render:function(e){return Object(r.jsx)(ci,{estado:e})}},{title:"Contrata",dataIndex:"contrata",width:200,ellipsis:{showTitle:!1},filters:(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[])||[],onFilter:function(e,t){return"-"===e?!t.contrata:void 0!==t.contrata&&0===t.contrata._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre:"-",children:e?e.nombre:"-"})}},{title:"Tecnico Liquidado",dataIndex:"tecnico_liquidado",width:200,ellipsis:{showTitle:!1},filters:(arguments.length>7&&void 0!==arguments[7]?arguments[7]:[])||[],onFilter:function(e,t){return"-"===e?!t.tecnico_liquidado:!!t.tecnico_liquidado&&0===t.tecnico_liquidado._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre+" "+e.apellidos:"-",children:e?e.nombre+" "+e.apellidos:"-"})}},{title:"Usuario Liquidado",dataIndex:"codigo_usuario_liquidado",width:150},{title:"Tipo Averia",dataIndex:"tipo_averia",width:150},{title:"Descripci\xf3n Liquidado",dataIndex:"descripcion_codigo_liquidado",width:250},{title:"Observaci\xf3n Gestor",dataIndex:"observacion_gestor",width:250},{title:"Observaci\xf3n Liquidado",dataIndex:"observacion_liquidado",width:250},{title:"Fecha Registro",dataIndex:"fecha_registro",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}},{title:"Fecha Liquidado",dataIndex:"fecha_liquidado",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}},{title:"Time Slot",dataIndex:"tipo_agenda",width:100,align:"center",fixed:"right",filters:e?e.filter((function(e){return e.text})):[],onFilter:function(e,t){return!(!t.tipo_agenda||!e)&&0===t.tipo_agenda.indexOf(e)},render:function(e){return e?Object(r.jsx)(Cn.a,{color:"#f50",children:e}):void 0}},{title:"Horas",dataIndex:"fecha_registro",width:80,align:"center",fixed:"right",sorter:function(e,t){return Qe()().diff(e.fecha_registro,"hours")<Qe()().diff(t.fecha_registro,"hours")?-1:Qe()().diff(e.fecha_registro,"hours")>Qe()().diff(t.fecha_registro,"hours")?1:0},render:function(e,t){if(!t.fecha_cita&&e){if(t.tipo===jn&&t.fecha_asignado){var n=Qe()().diff(t.fecha_asignado,"hours");return Object(r.jsx)(Cn.a,{color:n>=72?"error":n<72&&n>=24?"warning":n<24?"success":"",children:n})}if(t.tipo===fn){var a=Qe()().diff(e,"hours");return Object(r.jsx)(Cn.a,{color:a>=24?"error":a<24&&a>=12?"warning":a<12?"success":"",children:a})}return Object(r.jsx)(Cn.a,{children:"-"})}return Object(r.jsx)(Cn.a,{color:"blue",children:Qe()().diff(e,"hours")})}},{title:"Acciones",dataIndex:"_id",width:100,align:"center",fixed:"right",render:function(e,a){return Object(r.jsxs)("div",{children:[Object(r.jsx)(oi.a,{style:{fontSize:"1.5rem",marginRight:".5rem"},onClick:function(){return t(e)}}),Object(r.jsx)(ji,{row:a,listarOrdenes:n})]})}}]}(Y,J,Q,ne,je,ge,_e,de,Ce,Ue,Be):function(e){var t=arguments.length>10&&void 0!==arguments[10]?arguments[10]:[],n=arguments.length>11?arguments[11]:void 0,a=arguments.length>12?arguments[12]:void 0,i=[{averias:!0,altas:!0,title:"#",width:50,fixed:"left",render:function(e,t,n){return n+1}},{averias:!0,altas:!0,title:"Requerimiento",dataIndex:"codigo_requerimiento",width:120,fixed:"left",render:function(e){return Object(r.jsx)(Wi,{copyable:!0,children:e})}},{averias:!1,altas:!0,title:"Orden Trabajo",dataIndex:"codigo_trabajo",width:120,render:function(e){return Object(r.jsx)(Wi,{copyable:!0,children:e})}},{averias:!1,altas:!0,title:"Peticion",dataIndex:"codigo_peticion",width:120,render:function(e){return Object(r.jsx)(Wi,{copyable:!0,children:e})}},{averias:!0,altas:!0,title:"Codigo Cliente",dataIndex:"codigo_cliente",width:120,render:function(e){return Object(r.jsx)(Wi,{copyable:!0,children:e})}},{averias:!0,altas:!0,title:"Tecnologia",dataIndex:"tipo_tecnologia",align:"center",width:120,filters:(arguments.length>7&&void 0!==arguments[7]?arguments[7]:[])||[],onFilter:function(e,t){return 0===t.tipo_tecnologia.indexOf(e)}},{averias:!0,altas:!0,title:"CTR",dataIndex:"codigo_ctr",width:60,filters:(arguments.length>9&&void 0!==arguments[9]?arguments[9]:[])||[],onFilter:function(e,t){return 0===String(t.codigo_ctr).indexOf(String(e))}},{averias:!0,altas:!0,title:"Nodo",dataIndex:"codigo_nodo",width:70,filters:(arguments.length>8&&void 0!==arguments[8]?arguments[8]:[])||[],onFilter:function(e,t){return 0===t.codigo_nodo.indexOf(e)}},{averias:!0,altas:!0,title:"Troba",dataIndex:"codigo_troba",width:70,sorter:function(e,t){return e.codigo_troba<t.codigo_troba?-1:e.codigo_troba>t.codigo_troba?1:0}},{averias:!0,altas:!0,title:"Distrito",dataIndex:"distrito",width:160,filters:(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[])||[],onFilter:function(e,t){return 0===t.distrito.indexOf(e)}},{averias:!0,altas:!0,title:"Estado Toa",dataIndex:"estado_toa",width:150,align:"center",filters:(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[])||[],onFilter:function(e,t){return 0===t.estado_toa.indexOf(e)},render:function(e){return Object(r.jsx)(ci,{estado:e})}},{averias:!0,altas:!0,title:"Estado Gestor",dataIndex:"estado_gestor",width:150,align:"center",filters:(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[])||[],onFilter:function(e,t){return 0===t.estado_gestor.indexOf(e)},render:function(e){return Object(r.jsx)(ci,{estado:e})}},{averias:!0,altas:!0,title:"Estado Liquidado",dataIndex:"estado_liquidado",width:150,align:"center",render:function(e){return Object(r.jsx)(ci,{estado:e})}},{averias:!0,altas:!0,title:"Contrata",dataIndex:"contrata",width:200,ellipsis:{showTitle:!1},filters:(arguments.length>4&&void 0!==arguments[4]?arguments[4]:[])||[],onFilter:function(e,t){return"-"===e?!t.contrata:void 0!==t.contrata&&0===t.contrata._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre:"-",children:e?e.nombre:"-"})}},{averias:!0,altas:!0,title:"Gestor",dataIndex:"gestor",width:200,ellipsis:{showTitle:!1},filters:(arguments.length>5&&void 0!==arguments[5]?arguments[5]:[])||[],onFilter:function(e,t){return"-"===e?!t.gestor:void 0!==t.gestor&&0===t.gestor._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre+" "+e.apellidos:"-",children:e?e.nombre+" "+e.apellidos:"-"})}},{averias:!0,altas:!0,title:"Tecnico Liquidado",dataIndex:"tecnico_liquidado",width:200,ellipsis:{showTitle:!1},filters:(arguments.length>6&&void 0!==arguments[6]?arguments[6]:[])||[],onFilter:function(e,t){return"-"===e?!t.tecnico_liquidado:!!t.tecnico_liquidado&&0===t.tecnico_liquidado._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre+" "+e.apellidos:"-",children:e?e.nombre+" "+e.apellidos:"-"})}},{averias:!0,altas:!1,title:"Usuario Liquidado",dataIndex:"codigo_usuario_liquidado",width:150},{averias:!0,altas:!1,title:"Tipo Averia",dataIndex:"tipo_averia",width:150},{averias:!0,altas:!1,title:"Descripci\xf3n Liquidado",dataIndex:"descripcion_codigo_liquidado",width:250},{averias:!0,altas:!0,title:"Observaci\xf3n Gestor",dataIndex:"observacion_gestor",width:250},{averias:!0,altas:!0,title:"Observaci\xf3n Liquidado",dataIndex:"observacion_liquidado",width:250},{averias:!0,altas:!0,title:"Fecha Registro",dataIndex:"fecha_registro",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}},{averias:!0,altas:!0,title:"Fecha Liquidado",dataIndex:"fecha_liquidado",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}},{averias:!0,altas:!0,title:"Time Slot",dataIndex:"tipo_agenda",width:100,align:"center",fixed:"right",filters:t?t.filter((function(e){return e.text})):[],onFilter:function(e,t){return!(!t.tipo_agenda||!e)&&0===t.tipo_agenda.indexOf(e)},render:function(e){return e?Object(r.jsx)(Cn.a,{color:"#f50",children:e}):void 0}},{averias:!0,altas:!1,title:"Plazo 24h",dataIndex:"fecha_registro",width:100,align:"center",fixed:"right",sorter:function(e,t){return Qe()(e.fecha_liquidado).diff(e.fecha_registro,"hours")<Qe()(e.fecha_liquidado).diff(t.fecha_registro,"hours")?-1:Qe()(e.fecha_liquidado).diff(e.fecha_registro,"hours")>Qe()(e.fecha_liquidado).diff(t.fecha_registro,"hours")?1:0},render:function(e,t){return Object(r.jsx)(hi,{fecha:e,tipo:t.tipo,tipoAgenda:t.tipo_agenda})}},{averias:!1,altas:!0,title:"Plazo 72h",dataIndex:"fecha_registro",width:100,align:"center",fixed:"right",sorter:function(e,t){return Qe()(e.fecha_liquidado).diff(e.fecha_registro,"hours")<Qe()(e.fecha_liquidado).diff(t.fecha_registro,"hours")?-1:Qe()(e.fecha_liquidado).diff(e.fecha_registro,"hours")>Qe()(e.fecha_liquidado).diff(t.fecha_registro,"hours")?1:0},render:function(e,t){if(e){var n=Qe()(t.fecha_liquidado).diff(e,"hours");return Object(r.jsx)(Cn.a,{color:t.fecha_cita?"geekblue":n<72&&!t.fecha_cita?"success":72!==n||t.fecha_cita?"error":"warning",children:n})}return Object(r.jsx)(Cn.a,{children:"-"})}},{averias:!0,altas:!0,title:"Acciones",dataIndex:"_id",width:100,align:"center",fixed:"right",render:function(e,t){return Object(r.jsxs)("div",{children:[Object(r.jsx)(oi.a,{style:{fontSize:"1.5rem",marginRight:".5rem"},onClick:function(){return n(e)}}),Object(r.jsx)(ji,{row:t,listarOrdenes:a})]})}}],o=i.filter((function(e){return e.averias})),c=i.filter((function(e){return e.altas}));switch(e){case fn:return o;case jn:return c}}(t,Y,J,Q,ne,oe,de,je,ge,_e,Ce,Ue,Be),dataSource:c,loading:w,size:"small",scroll:{y:"65vh"},pagination:{defaultPageSize:50,pageSizeOptions:[50,100,200]}}),Object(r.jsx)(Si,{visible:Te,abrir:Ye,loading:q,registros:u})]})},eo=V.a.Search;var to=function(e){var t=e.gestores,n=void 0===t?[]:t,i=e.tecnicos,o=void 0===i?[]:i,s=Object(a.useState)([]),l=Object(I.a)(s,2),d=l[0],u=l[1],b=Object(a.useState)([]),f=Object(I.a)(b,2),j=f[0],h=f[1],p=Object(a.useState)(!1),O=Object(I.a)(p,2),g=O[0],x=O[1],m=Object(a.useState)([]),v=Object(I.a)(m,2),_=v[0],w=v[1],y=Object(a.useState)([]),S=Object(I.a)(y,2),C=S[0],k=S[1],A=Object(a.useState)([]),T=Object(I.a)(A,2),E=T[0],D=T[1],N=Object(a.useState)(!1),R=Object(I.a)(N,2),M=R[0],q=R[1],L=Object(a.useState)(!1),z=Object(I.a)(L,2),G=z[0],Y=z[1],H=Object(a.useState)(!1),V=Object(I.a)(H,2),K=V[0],J=V[1],W=Object(a.useState)(!1),Z=Object(I.a)(W,2),X=Z[0],Q=Z[1],$=Object(a.useState)(!1),ee=Object(I.a)($,2),te=ee[0],ne=ee[1],re=Object(a.useState)(!1),ae=Object(I.a)(re,2),ie=ae[0],oe=ae[1],ce=Object(a.useState)(null),se=Object(I.a)(ce,2),le=se[0],de=se[1];function ue(){return be.apply(this,arguments)}function be(){return(be=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),e.next=3,li(!0,{metodo:qt,todo:!1}).then((function(e){var t=e.data;t&&u(t)})).catch((function(e){return console.log(e)})).finally((function(){return x(!1)}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fe(e){return je.apply(this,arguments)}function je(){return(je=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k([t]);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(e){return pe.apply(this,arguments)}function pe(){return(pe=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return q(!0),e.next=3,li(!0,{metodo:zt,id:t}).then((function(e){var t=e.data;t&&t.length>0&&w(t)})).catch((function(e){return console.log(e)})).finally((function(){return q(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){ue()}),[]),Object(a.useEffect)((function(){d.length>0&&h(d)}),[d]);var Oe=function(){return J(!K)},ge=function(){return Q(!X)},xe=function(){return ne(!te)},me=function(){return oe(!ie)},ve=function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ge(),e.next=3,fe(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_e=function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return xe(),e.next=3,he(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function we(){return(we=Object(P.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(E&&E.length>0)){e.next=8;break}return n=t,Y(!0),me(),e.next=6,bi(Object(c.a)({metodo:Yt,ordenes:E},n)).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)})).finally((function(){return Y(!1)}));case 6:e.next=9;break;case 8:F.a.warn("No hay ordenes seleccionadas.",{position:"top-right"});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.jsxs)("div",{style:{marginBottom:".5rem",marginTop:"1rem"},children:[Object(r.jsxs)("div",{children:[Object(r.jsx)(U.a,{type:"primary",icon:g?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ta.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},onClick:ue,children:"Actualizar"}),Object(r.jsx)(U.a,{icon:G?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(za.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},disabled:0===E.length,onClick:me,children:"Asignar"}),Object(r.jsx)(eo,{placeholder:"Requerimiento...",onSearch:function(e){e&&e.length>1?h(d.filter((function(t){return String(t.codigo_requerimiento).includes(e)}))):h(d)},style:{width:180,marginRight:".5rem"},allowClear:!0})]}),Object(r.jsx)(wi,{data:j,loading:g,ordenesSeleccionadas:E,setOrdenesSeleccionadas:D,abrirReiterada:function(e){de(e),Oe()},abrirInfancia:ve,abrirRegistro:_e}),Object(r.jsx)(Gi,{tipo:!0,visible:ie,abrir:me,gestores:n,tecnicos:o,asignar:function(e){return we.apply(this,arguments)}}),Object(r.jsx)(Ai,{visible:K,abrir:Oe,codigo_cliente:le}),Object(r.jsx)(ki,{visible:X,abrir:ge,loading:!1,orden:C}),Object(r.jsx)(Si,{visible:te,abrir:xe,loading:M,registros:_})]})},no=Nn.a.TabPane;var ro=[{path:y,exact:!0,component:function(){var e=Object(a.useState)([]),t=Object(I.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)(!1),c=Object(I.a)(o,2),s=c[0],l=c[1],d=Object(a.useState)(!1),u=Object(I.a)(d,2),b=u[0],f=u[1],j=Object(a.useState)(null),h=Object(I.a)(j,2),p=h[0],O=h[1],g=Object(a.useState)([]),x=Object(I.a)(g,2),m=x[0],v=x[1],_=Object(a.useState)(null),w=Object(I.a)(_,2),y=w[0],S=w[1],C=Object(a.useState)(null),k=Object(I.a)(C,2),A=k[0],T=k[1],E=Object(a.useState)([]),D=Object(I.a)(E,2),N=D[0],F=D[1],L=Object(a.useState)([]),z=Object(I.a)(L,2),G=z[0],Y=z[1],H=Object(a.useState)(!1),V=Object(I.a)(H,2),K=V[0],J=V[1],W=Object(a.useState)(null),Z=Object(I.a)(W,2),X=Z[0],Q=Z[1];function $(){return($=Object(P.a)(B.a.mark((function e(t,n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),console.log(t),e.next=4,oa({id:X,estado:t,observacion:n}).catch((function(e){return console.log(e)})).finally((function(){f(!1),J(!1),te()}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){re(Qe()())}),[]),Object(a.useEffect)((function(){te()}),[y,A]),Object(a.useEffect)((function(){!function(){var e=Qe()().format("DD-MM");if(m.length>0){var t=[{title:"#",width:50,align:"center",render:function(e,t,n){return n+1}},{title:"Tecnico",dataIndex:"nombre",width:300,render:function(e,t){return t.nombre+" "+t.apellidos}},{title:"Gestor",dataIndex:"gestor",filters:N,onFilter:function(e,t){return!(!t.gestor||!e)&&0===t.gestor._id.indexOf(e)},width:250,render:function(e){return e.nombre?e.nombre+" "+e.apellidos:"-"}},{title:"Auditor",dataIndex:"auditor",filters:G,onFilter:function(e,t){return!(!t.auditor||!e)&&0===t.auditor._id.indexOf(e)},width:250,render:function(e){return e.nombre?e.nombre+" "+e.apellidos:"-"}},{title:"En Ruta",dataIndex:e,width:150,align:"center",filters:[{text:"Ok",value:!0},{text:"No",value:!1}],onFilter:function(t,n){return!!n[e]&&(!n[e].iniciado&&!t||n[e].iniciado===t)},render:function(e){return e?e.iniciado?Object(r.jsx)(Te.a,{content:e.fecha_iniciado?Qe()(e.fecha_iniciado).format("HH:mm"):"-",title:"Observaciones",trigger:"click",children:Object(r.jsx)("button",{className:"boton-none",children:Object(r.jsx)(Cn.a,{color:tn.success,children:Object(r.jsx)($t.a,{})})})}):Object(r.jsx)(Cn.a,{color:tn.error,children:Object(r.jsx)(jr.a,{})}):Object(r.jsx)(Cn.a,{color:tn.error,children:"No"})}}],n=m.map((function(e){return{title:e,width:100,align:"center",dataIndex:e,render:function(t,n){return t&&t.estado&&t.observacion?Object(r.jsx)(Te.a,{content:Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:t.observacion}),Object(r.jsx)(U.a,{type:"primary",onClick:function(){return t=n[e]._id,ee(),void Q(t);var t},size:"small",children:"Editar"})]}),title:"Observaciones",placement:"topRight",trigger:"click",destroyTooltipOnHide:!0,children:Object(r.jsx)("button",{className:"boton-none",children:Object(r.jsx)(xa,{estado:t.estado})})}):Object(r.jsx)(xa,{estado:t&&t.estado?t.estado:"-"})}}}));O([].concat(t,Object(ue.a)(n)))}else O([])}()}),[m,N]);var ee=function(){return J(!K)};function te(){return ne.apply(this,arguments)}function ne(){return(ne=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y||!A){e.next=4;break}return l(!0),e.next=4,aa({metodo:Kt,fecha_inicio:y,fecha_fin:A}).then(function(){var e=Object(P.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,e.next=3,ca(n.filter((function(e){return null!==e.tecnico})));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){e&&e.length>0&&(i(e),F(Vr(e,"gestor",!0)),Y(Vr(e,"auditor",!0)))})).catch((function(e){return console.log(e)})).finally((function(){return l(!1)}));case 4:case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e){if(e){var t=e.clone().startOf("week"),n=e.clone().endOf("week");S(Qe()(t).format("YYYY-MM-DD")),T(Qe()(n).format("YYYY-MM-DD"));for(var r=[],a=0;a<=6;a++)r.push(Qe()(t).add(a,"days").format("DD-MM"));v(r)}else S(null),T(null)}return Object(r.jsxs)("div",{children:[Object(r.jsx)(et,{titulo:"Asistencia",subtitulo:"Gestion de Rutas"}),Object(r.jsxs)(q,{children:[Object(r.jsxs)(R.a,{style:{marginTop:"1rem",marginBottom:".5rem"},children:[Object(r.jsx)("h1",{children:Object(r.jsx)("p",{children:"Tabla de Asistencias:"})}),Object(r.jsxs)(M.a,{sm:24,style:{marginBottom:".5rem"},children:[Object(r.jsx)("p",{style:{color:"rgba(0,0,0,0.45)"},children:"Seleccionar Fecha:"}),Object(r.jsx)(We.a,{onChange:re,picker:"week",style:{marginRight:".5rem"}}),Object(r.jsx)(U.a,{disabled:s,icon:s?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ta.a,{}),onClick:te,children:"Actualizar"})]})]}),Object(r.jsx)(In.a,{rowKey:"_id",size:"small",loading:s,columns:null!==p&&0!==p.length?p:Ma,dataSource:n,pagination:!1,scroll:{x:"80vw"},style:{marginBottom:".5rem"}})]}),Object(r.jsx)(_a,{visible:K,abrir:ee,loadingActualizar:b,actualizar:function(e,t){return $.apply(this,arguments)}})]})},nivel:k.gestion},{path:S,exact:!0,component:function(){var e=Object(a.useState)([]),t=Object(I.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)([]),c=Object(I.a)(o,2),s=c[0],l=c[1];function d(){return(d=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt(!1,{metodo:lt}).then((function(e){var t=e.data;return i(t||[])})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(){return(u=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt(!1,{metodo:st}).then((function(e){var t=e.data;t&&l(t)})).catch((function(e){return console.log(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){!function(){d.apply(this,arguments)}(),function(){u.apply(this,arguments)}()}),[]),Object(r.jsxs)("div",{children:[Object(r.jsx)(et,{titulo:"Lista de Ordenes",subtitulo:"Gestionar Ordenes"}),Object(r.jsx)(q,{children:Object(r.jsxs)(Nn.a,{style:{paddingLeft:"1rem"},animated:!1,children:[Object(r.jsx)(no,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(qa.a,{}),"Ordenes Pendientes"]}),children:Object(r.jsx)(Ji,{gestores:n,tecnicos:s})},"1"),Object(r.jsx)(no,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)($t.a,{}),"Ordenes Liquidadas"]}),children:Object(r.jsx)($i,{tipo:null,gestor:!0})},"2"),Object(r.jsx)(no,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(Fa.a,{}),"Ordenes Sin Asignar"]}),children:Object(r.jsx)(to,{gestores:n,tecnicos:s})},"3")]})})]})},nivel:k.gestion}],ao=n(686),io=n(687),oo=n(223),co=n(224);function so(){return(so=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){try{var r=new FileReader,a=!!r.readAsBinaryString;r.onload=function(t){var n=t.target.result,r=co.read(n,{type:a?"binary":"array",bookVBA:!0}),i=r.SheetNames[0],o=r.Sheets[i],c=co.utils.sheet_to_json(o),s=[];return c.map((function(e){return s.push(Object.keys(e).reduce((function(t,n){return t[n.trim().toLowerCase()]=e[n],t}),{}))})),e(s)},a?r.readAsBinaryString(t):r.readAsArrayBuffer(t)}catch(i){return n(i)}})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lo(e,t){var n=new Date(86400*(e-25569)*1e3);return t?n:new Date(n.setHours(n.getHours()+5))}function uo(e,t){if(!Number(e))return null;var n=Qe()(e).format("DD"),r=Qe()(e).format("MM"),a=Qe()(e).format("YYYY"),i=new Date(a+"-"+r+"-"+n+"T".concat(t,".000Z"));return new Date(i.setHours(i.getHours()+5))}var bo=n(137),fo=n.n(bo);function jo(){return ho.apply(this,arguments)}function ho(){return(ho=Object(P.a)(B.a.mark((function e(){var t,n,r=arguments;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:[],n=t.map((function(e,t){var n=!0,r="";fo()(String(e[Pa[0].cabecera]).trim())&&(n=!1),isNaN(e[Pa[1].cabecera])&&isNaN(e[Pa[1].cabecera_2])&&(n=!1);var a={key:t,verificado:n,tipo:fn};return Pa.forEach((function(t){t.cabecera_2?void 0!==e[t.cabecera]&&null!==e[t.cabecera]?a[t.propiedad]=t.fecha?lo(e[t.cabecera]):String(e[t.cabecera]).replace(/,/g,""):void 0!==e[t.cabecera_2]&&null!==e[t.cabecera_2]&&(a[t.propiedad]=t.fecha?lo(e[t.cabecera_2]):String(e[t.cabecera_2]).replace(/,/g,"")):void 0!==e[t.cabecera]&&null!==e[t.cabecera]&&(a[t.propiedad]=t.fecha?lo(e[t.cabecera]):String(e[t.cabecera]).replace(/,/g,""))})),Ga.forEach((function(t){void 0!==e[t.cabecera]&&null!==e[t.cabecera]&&(r=r+t.espacio+e[t.cabecera])})),a.direccion=String(r).substr(1),a})),e.abrupt("return",Promise.all(n).catch((function(e){return console.log("Error en la promesa"),console.log(e),e})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function po(){return Oo.apply(this,arguments)}function Oo(){return(Oo=Object(P.a)(B.a.mark((function e(){var t,n,r,a=arguments;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:[],n=a.length>1&&void 0!==a[1]?a[1]:[],r=t.map((function(e,t){var r=!0,a=null,i=ri.includes(String(e.tipave)),o=ai.includes(String(e.tipave)),c=ii.includes(String(e.tipave));if(isNaN(e[Pa[1].cabecera])&&isNaN(e[Pa[1].cabecera_2])&&(r=!1),6===String(e.codtecliq).trim().length){var s=n.findIndex((function(t){return t.carnet===e.codtecliq}));s>0&&(a=n[s]._id)}var l={key:t,verificado:r,tipo_liquidacion:e.edoxot,tecnico_liquidado:a,estado_liquidado:i?"efectiva":o?"inefectiva":c?"no_corresponde":"-"};return Ha.forEach((function(t){t.cabecera_2?void 0!==e[t.cabecera]&&null!==e[t.cabecera]?l[t.propiedad]=t.fecha?lo(e[t.cabecera]):e[t.cabecera]:void 0!==e[t.cabecera_2]&&null!==e[t.cabecera_2]&&(l[t.propiedad]=t.fecha?lo(e[t.cabecera_2]):e[t.cabecera_2]):void 0!==e[t.cabecera]&&null!==e[t.cabecera]&&(l[t.propiedad]=t.fecha?lo(e[t.cabecera]):e[t.cabecera])})),l})),e.abrupt("return",Promise.all(r).catch((function(e){return console.log("Error en la promesa"),console.log(e),e})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function go(){return xo.apply(this,arguments)}function xo(){return(xo=Object(P.a)(B.a.mark((function e(){var t,n,r=arguments;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:[],n=t.filter((function(e){return vn.includes(e.codnod)||vn.includes(e.nodo)})).map((function(e,t){var n=!0;fo()(String(e[Ya[0].cabecera]).trim())&&fo()(String(e[Ya[0].cabecera_2]).trim())&&fo()(String(e[Ya[0].cabecera_3]).trim())&&(n=!1),isNaN(e[Ya[1].cabecera])&&isNaN(e[Ya[1].cabecera_2])&&isNaN(e[Ya[1].cabecera_3])&&(n=!1);var r={key:t,verificado:n,tipo:jn};return Ya.forEach((function(t){void 0!==e[t.cabecera]&&null!==e[t.cabecera]?r[t.propiedad]=t.fecha?lo(e[t.cabecera]):String(e[t.cabecera]).replace(/,/g,""):void 0!==e[t.cabecera_2]&&null!==e[t.cabecera_2]?t.fecha?r[t.propiedad]=uo(lo(e[t.cabecera_2]),e[t.hora]):r[t.propiedad]=String(e[t.cabecera_2]).replace(/,/g,""):void 0!==e[t.cabecera_3]&&null!==e[t.cabecera_3]&&(t.fecha?r[t.propiedad]=uo(lo(e[t.cabecera_3]),e[t.hora]):r[t.propiedad]=String(e[t.cabecera_3]).replace(/,/g,""))})),r})),e.abrupt("return",Promise.all(n).catch((function(e){return console.log("Error en la promesa"),console.log(e),e})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mo(){return vo.apply(this,arguments)}function vo(){return(vo=Object(P.a)(B.a.mark((function e(){var t,n,r,a=arguments;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:[],n=a.length>1&&void 0!==a[1]?a[1]:[],r=t.filter((function(e){return vn.includes(e.codnod)})).filter((function(e){return e.edoxot})).map((function(e,t){var r=!0,a=null,i=ri.includes(e.tipave),o=ai.includes(e.tipave),c=ii.includes(e.tipave);if(isNaN(e[Ya[1].cabecera])&&isNaN(e[Ya[1].cabecera_2])&&isNaN(e[Ya[1].cabecera_3])&&(r=!1),6===String(e.codtecliq).trim().length){var s=n.findIndex((function(t){return t.carnet===e.codtecliq}));s>0&&(a=n[s]._id)}var l={key:t,verificado:r,tipo_liquidacion:e.edoxot,tecnico_liquidado:a,estado_liquidado:i?"efectiva":o?"inefectiva":c?"no_corresponde":"-"};return Ha.forEach((function(t){t.cabecera_2||t.cabecera_3?void 0!==e[t.cabecera]&&null!==e[t.cabecera]?l[t.propiedad]=t.fecha?lo(e[t.cabecera]):e[t.cabecera]:void 0!==e[t.cabecera_2]&&null!==e[t.cabecera_2]?l[t.propiedad]=t.fecha?lo(e[t.cabecera_2]):e[t.cabecera_2]:void 0!==e[t.cabecera_3]&&null!==e[t.cabecera_3]&&(l[t.propiedad]=t.fecha?lo(e[t.cabecera_3]):e[t.cabecera_3]):void 0!==e[t.cabecera]&&null!==e[t.cabecera]&&(l[t.propiedad]=t.fecha?lo(e[t.cabecera]):e[t.cabecera])})),l})),e.abrupt("return",Promise.all(r).catch((function(e){return console.log("Error en la promesa"),console.log(e),e})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _o(e,t,n,r){return wo.apply(this,arguments)}function wo(){return(wo=Object(P.a)(B.a.mark((function e(t,n,r,a){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n,e.next=e.t0===fn?3:e.t0===jn?16:25;break;case 3:if(1!==r){e.next=9;break}return e.next=6,jo(t);case 6:return e.abrupt("return",e.sent);case 9:if(2!==r){e.next=15;break}return e.next=12,po(t,a);case 12:return e.abrupt("return",e.sent);case 15:return e.abrupt("return",[]);case 16:if(1!==r){e.next=22;break}return e.next=19,go(t);case 19:return e.abrupt("return",e.sent);case 22:return e.next=24,mo(t,a);case 24:return e.abrupt("return",e.sent);case 25:return e.abrupt("break",26);case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function yo(){return So.apply(this,arguments)}function So(){return(So=Object(P.a)(B.a.mark((function e(){var t,n,r,a,i,o,c=arguments;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.length>0&&void 0!==c[0]?c[0]:[],n=c.length>1?c[1]:void 0,t||!(t.length<0)){e.next=6;break}return e.abrupt("return",[]);case 6:for(r=0,a=n,i=t,o=[];i.length>0;)o.push(t.slice(r,a)),i=i.slice(0,-n),r+=n,a+=n;if(!(o.length>0)){e.next=15;break}return e.abrupt("return",o.filter((function(e){return e&&e.length>0})));case 15:return e.abrupt("return",[]);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Co=function(e){var t=e.tipoOrden,n=e.tecnicos,i=Object(a.useState)(1),o=Object(I.a)(i,2),s=o[0],l=o[1],d=Object(a.useState)("done"),u=Object(I.a)(d,2),b=u[0],f=u[1],j=Object(a.useState)(""),h=Object(I.a)(j,2),p=h[0],O=h[1],g=Object(a.useState)([]),x=Object(I.a)(g,2),m=x[0],v=x[1],_=Object(a.useState)(0),w=Object(I.a)(_,2),y=w[0],S=w[1],C=Object(a.useState)(0),k=Object(I.a)(C,2),A=k[0],T=k[1],E=Object(a.useState)(!1),N=Object(I.a)(E,2),q=N[0],L=N[1],z=Object(a.useState)([]),G=Object(I.a)(z,2),Y=G[0],H=G[1];function V(e,t){return K.apply(this,arguments)}function K(){return(K=Object(P.a)(B.a.mark((function e(t,n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F.a.info("Enviando paquetes de datos ".concat(n,"/").concat(m.length," (500u.)..."),{position:"top-right"}),e.next=3,di({metodo:St,ordenes:t}).then((function(e){var n=Y,r=e&&e.data?e.data:{};n.push(Object(c.a)(Object(c.a)({},r),{},{id:Date.now(),cantidad:t.length})),H(n.filter((function(e){return e})))})).catch((function(e){return console.log(e)}));case 3:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,t){return W.apply(this,arguments)}function W(){return(W=Object(P.a)(B.a.mark((function e(t,n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F.a.info("Enviando paquetes de datos ".concat(n,"/").concat(m.length," (500u.)..."),{position:"top-right"}),e.next=3,ui({metodo:kt,ordenes:t}).then((function(e){var n=Y,r=e&&e.data?e.data:{};n.push(Object(c.a)(Object(c.a)({},r),{},{id:Date.now(),cantidad:t.length})),H(n.filter((function(e){return e})))})).catch((function(e){return console.log(e)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(){return(Z=Object(P.a)(B.a.mark((function e(){var t,n,r,a,i,o,c,l,d,u,b,f,j,h,p,O;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==m.length){e.next=4;break}F.a.warn("No hay ordenes para subir.",{position:"top-right"}),e.next=106;break;case 4:if(1!==s){e.next=56;break}e.prev=5,L(!0),t=1,n=!0,r=!1,e.prev=10,i=Object(oo.a)(m);case 12:return e.next=14,i.next();case 14:return o=e.sent,n=o.done,e.next=18,o.value;case 18:if(c=e.sent,n){e.next=27;break}return l=c,e.next=23,V(l,t);case 23:t+=1;case 24:n=!0,e.next=12;break;case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(10),r=!0,a=e.t0;case 33:if(e.prev=33,e.prev=34,n||null==i.return){e.next=38;break}return e.next=38,i.return();case 38:if(e.prev=38,!r){e.next=41;break}throw a;case 41:return e.finish(38);case 42:return e.finish(33);case 43:e.next=50;break;case 46:e.prev=46,e.t1=e.catch(5),F.a.error("Error en el cliente.",{position:"top-right"}),console.log(e.t1);case 50:return e.prev=50,L(!1),e.finish(50);case 53:e.next=105;break;case 56:e.prev=56,L(!0),d=1,u=!0,b=!1,e.prev=61,j=Object(oo.a)(m);case 63:return e.next=65,j.next();case 65:return h=e.sent,u=h.done,e.next=69,h.value;case 69:if(p=e.sent,u){e.next=78;break}return O=p,e.next=74,J(O,d);case 74:d+=1;case 75:u=!0,e.next=63;break;case 78:e.next=84;break;case 80:e.prev=80,e.t2=e.catch(61),b=!0,f=e.t2;case 84:if(e.prev=84,e.prev=85,u||null==j.return){e.next=89;break}return e.next=89,j.return();case 89:if(e.prev=89,!b){e.next=92;break}throw f;case 92:return e.finish(89);case 93:return e.finish(84);case 94:e.next=101;break;case 97:e.prev=97,e.t3=e.catch(56),F.a.error("Error en el cliente.",{position:"top-right"}),console.log(e.t3);case 101:return e.prev=101,L(!1),e.finish(101);case 104:case 105:case 106:case"end":return e.stop()}}),e,null,[[5,46,50,53],[10,29,33,43],[34,,38,42],[56,97,101,104],[61,80,84,94],[85,,89,93]])})))).apply(this,arguments)}Object(a.useEffect)((function(){f("done"),O(""),v([]),S(0),T(0),H([])}),[s]);var X=[{title:"#",width:50,render:function(e,t,n){return n+1}},{title:"Cantidad",width:100,dataIndex:"cantidad",render:function(e){return e?Object(r.jsx)(Cn.a,{color:"blue",children:e}):"-"}},{title:"Nuevos",width:100,dataIndex:"nuevos",render:function(e){return e?Object(r.jsx)(Cn.a,{color:"green",children:e}):"-"}},{title:"Actualizados",width:100,dataIndex:"actualizados",render:function(e){return e?Object(r.jsx)(Cn.a,{color:"geekblue",children:e}):"-"}},{title:"Duplicados",width:100,dataIndex:"duplicados",render:function(e){return e?Object(r.jsx)(Cn.a,{color:"warning",children:e}):"-"}},{title:"Errores",width:100,dataIndex:"errores",render:function(e){return e?Object(r.jsx)(Cn.a,{color:"error",children:e}):Object(r.jsx)(Cn.a,{children:"-"})}}];return Object(r.jsxs)("div",{children:[Object(r.jsxs)(R.a,{children:[Object(r.jsxs)(M.a,{sm:10,md:10,lg:12,xl:12,spellCheck:!0,children:[Object(r.jsx)("p",{children:"Tipo de Archivo:"}),Object(r.jsxs)(Ze.a.Group,{onChange:function(e){return l(e.target.value)},value:s,children:[Object(r.jsx)(Ze.a,{value:1,children:"Pendientes"}),Object(r.jsx)(Ze.a,{value:2,children:"Liquidadas"})]}),Object(r.jsx)("div",{style:{width:"14rem",margin:"1rem 0"},children:Object(r.jsx)(Ti.a,{accept:".xls,.xlsx",beforeUpload:function(e){return f("uploading"),O(e.name),H([]),D.formatosAdmitidos.includes(e.type)?(function(e){return so.apply(this,arguments)}(e).then(function(){var e=Object(P.a)(B.a.mark((function e(r){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_o(r,t,s,n).then((function(e){return S(e.length),e.filter((function(e){return e.verificado}))})).then(function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f("done"),e.t0=v,e.next=4,yo(t,500);case 4:e.t1=e.sent,(0,e.t0)(e.t1),T(t.length),F.a.success("".concat(t.length," Ordenes encontradas."),{position:"top-right"});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log(e,"Error asignando valores")}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){f("error"),F.a.error("Error convirtiendo el archivo",{position:"top-right"}),console.log(e)})),!1):(f("error"),F.a.warn("Formato Incorrecto.",{position:"top-right"}),!1)},onRemove:function(){O(""),f("done"),v([])},fileList:[{uid:"-1",name:p,status:b}],children:Object(r.jsxs)(U.a,{children:[Object(r.jsx)(Ei.a,{})," ","Subir Archivo"]})})})]}),Object(r.jsxs)(M.a,{sm:14,md:14,lg:12,xl:12,children:[Object(r.jsx)(Qt.a,{title:"Ordenes:",value:A,suffix:"/ ".concat(y)}),Object(r.jsx)(U.a,{disabled:q,style:{marginTop:".5rem"},type:"primary",icon:q?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ja.a,{}),onClick:function(){return Z.apply(this,arguments)},children:"Guardar"})]})]}),Object(r.jsx)(In.a,{rowKey:"id",columns:X,dataSource:Y.filter((function(e){return e})),pagination:!1,style:{marginBottom:"1rem"},bordered:!0})]})},ko=n(683),Io=n(684),Ao=n(685);var To=function(e){var t=e.fecha,n=Qe()().diff(t,"days");return t&&Qe()(t).isValid()?Object(r.jsx)(Cn.a,{color:n>=3?"error":n<3&&n>=2?"warning":n<2&&n>=1?"lime":n<1?"success":"",children:n}):Object(r.jsx)(Cn.a,{color:"blue",children:"-"})},Eo=Le.a.Text;function Do(e){var t=e.tipo,n=e.filtros,a=void 0===n?{}:n,i=e.filtroDistrito,o=void 0===i?[]:i,c=e.filtroBucket,s=void 0===c?[]:c,l=e.filtroEstadoToa,d=void 0===l?[]:l,u=e.filtroEstadoGestor,b=void 0===u?[]:u,f=e.filtroContrata,j=void 0===f?[]:f,h=e.filtroGestorAsignado,p=void 0===h?[]:h,O=e.filtroTecnicoToa,g=void 0===O?[]:O,x=e.filtroTecnicoAsignado,m=void 0===x?[]:x,v=e.filtroTipoReq,_=void 0===v?[]:v,w=e.filtroTecnologia,y=void 0===w?[]:w,S=e.filtroNodo,C=void 0===S?[]:S,k=e.filtroTroba,I=void 0===k?[]:k,A=e.filtroPai,T=void 0===A?[]:A,E=e.filtroCtr,D=void 0===E?[]:E,N=e.filtroTimeSlot,R=void 0===N?[]:N,M=e.filtroObservacion,q=void 0===M?[]:M,F=e.filtroFechaCita,L=void 0===F?[]:F,z=e.abrirReiterada,B=e.abrirInfancia,P=e.abrirRegistro,G=e.listarOrdenes,Y=[{averias:!0,altas:!0,title:"#",width:50,fixed:"left",render:function(e,t,n){return Number(n)+1}},{averias:!0,altas:!0,title:"Requerimiento",dataIndex:"codigo_requerimiento",width:140,fixed:"left",render:function(e,t){return t.subtipo_actividad&&un.includes(t.subtipo_actividad)?Object(r.jsx)(Cn.a,{color:"#108ee9",style:{fontSize:"1rem"},children:Object(r.jsx)(Eo,{copyable:!0,strong:!0,style:{color:"#ffffff !important"},children:e})}):Object(r.jsx)(Eo,{copyable:!0,strong:!0,children:e})}},{averias:!1,altas:!0,title:"Orden Trabajo",dataIndex:"codigo_trabajo",width:120,render:function(e){return Object(r.jsx)(Eo,{copyable:!0,children:e})}},{averias:!1,altas:!0,title:"Peticion",dataIndex:"codigo_peticion",width:120,render:function(e){return Object(r.jsx)(Eo,{copyable:!0,children:e})}},{averias:!0,altas:!0,title:"Codigo Cliente",dataIndex:"codigo_cliente",width:120,render:function(e){return Object(r.jsx)(Eo,{copyable:!0,children:e})}},{averias:!0,altas:!0,title:"Tecnologia",dataIndex:"tipo_tecnologia",align:"center",width:120,filteredValue:a&&a.tipo_tecnologia?a.tipo_tecnologia:null,filters:y||[{text:"",value:""}],onFilter:function(e,t){return 0===t.tipo_tecnologia.indexOf(e)}},{averias:!1,altas:!0,title:"PAI",dataIndex:"indicador_pai",width:60,aling:"center",filteredValue:a&&a.indicador_pai?a.indicador_pai:null,filters:T||[{text:"",value:""}],onFilter:function(e,t){return 0===String(t.indicador_pai).indexOf(String(e))}},{averias:!0,altas:!0,title:"CTR",dataIndex:"codigo_ctr",width:60,filteredValue:a&&a.codigo_ctr?a.codigo_ctr:null,filters:D||[{text:"",value:""}],onFilter:function(e,t){return 0===String(t.codigo_ctr).indexOf(String(e))}},{averias:!1,altas:!0,title:"Tipo Req.",dataIndex:"tipo_requerimiento",align:"center",width:100,filteredValue:a&&a.tipo_requerimiento?a.tipo_requerimiento:null,filters:_||[{text:"",value:""}],onFilter:function(e,t){return 0===t.tipo_requerimiento.indexOf(e)}},{averias:!0,altas:!0,title:"Nodo",dataIndex:"codigo_nodo",width:70,filteredValue:a&&a.codigo_nodo?a.codigo_nodo:null,filters:C||[{text:"",value:""}],onFilter:function(e,t){return 0===t.codigo_nodo.indexOf(e)}},{averias:!0,altas:!0,title:"Troba",dataIndex:"codigo_troba",width:90,sorter:function(e,t){return e.codigo_troba<t.codigo_troba?-1:e.codigo_troba>t.codigo_troba?1:0},filteredValue:a&&a.codigo_troba?a.codigo_troba:null,filters:I||[{text:"",value:""}],onFilter:function(e,t){return 0===t.codigo_troba.indexOf(e)}},{averias:!0,altas:!1,title:"Reiterada",dataIndex:"numero_reiterada",width:100,align:"center",sorter:function(e,t){return e.numero_reiterada-t.numero_reiterada},render:function(e,t){return e&&"0"!==e&&"-"!==e?Object(r.jsx)(Cn.a,{color:"#E5302F",onClick:function(){return z(t.codigo_cliente)},style:{cursor:"pointer"},children:e}):"-"}},{averias:!0,altas:!1,title:"Infancia",dataIndex:"infancia",width:90,align:"center",filteredValue:a&&a.infancia?a.infancia:null,filters:[{text:"Si",value:!0},{text:"No",value:!1}],onFilter:function(e,t){return e?t.infancia:!t.infancia},render:function(e){return e&&e.length>0?Object(r.jsx)(Cn.a,{color:"purple",onClick:function(){return B(e)},style:{cursor:"pointer"},children:"Si"}):"-"}},{averias:!0,altas:!1,title:"Cliente",dataIndex:"nombre_cliente",width:200,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e,children:e})}},{averias:!0,altas:!0,title:"Distrito",dataIndex:"distrito",width:160,filteredValue:a&&a.distrito?a.distrito:null,filters:o||[{text:"",value:""}],onFilter:function(e,t){return 0===t.distrito.indexOf(e)}},{averias:!0,altas:!1,title:"Direcci\xf3n",dataIndex:"direccion",width:250,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e,children:e})}},{averias:!0,altas:!0,title:"Bucket",dataIndex:"bucket",width:200,ellipsis:{showTitle:!1},filteredValue:a&&a.bucket?a.bucket:null,filters:s||[{text:"",value:""}],onFilter:function(e,t){return 0===t.bucket.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e,children:e})}},{averias:!0,altas:!0,title:"Estado Toa",dataIndex:"estado_toa",width:150,align:"center",filteredValue:a&&a.estado_toa?a.estado_toa:null,filters:d||[{text:"",value:""}],onFilter:function(e,t){return 0===t.estado_toa.indexOf(e)},render:function(e){return Object(r.jsx)(ci,{estado:e})}},{averias:!0,altas:!0,title:"Estado Gestor",dataIndex:"estado_gestor",width:150,align:"center",filteredValue:a&&a.estado_gestor?a.estado_gestor:null,filters:b||[{text:"",value:""}],onFilter:function(e,t){return 0===t.estado_gestor.indexOf(e)},render:function(e){return Object(r.jsx)(ci,{estado:e})}},{averias:!0,altas:!0,title:"Contrata",dataIndex:"contrata",width:200,ellipsis:{showTitle:!1},filteredValue:a&&a.contrata?a.contrata:null,filters:j||[{text:"",value:""}],onFilter:function(e,t){return"-"===e?!t.contrata:void 0!==t.contrata&&0===t.contrata._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre:"-",children:e?e.nombre:"-"})}},{averias:!0,altas:!0,title:"Gestor Asignado",dataIndex:"gestor_liteyca",width:200,ellipsis:{showTitle:!1},filteredValue:a&&a.gestor_liteyca?a.gestor_liteyca:null,filters:p||[{text:"",value:""}],onFilter:function(e,t){return"-"===e?!t.gestor_liteyca:!!t.gestor_liteyca&&0===t.gestor_liteyca._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre+" "+e.apellidos:"-",children:e?e.nombre+" "+e.apellidos:"-"})}},{averias:!0,altas:!0,title:"Tecnico Toa",dataIndex:"tecnico",width:200,ellipsis:{showTitle:!1},filteredValue:a&&a.tecnico?a.tecnico:null,filters:g||[{text:"",value:""}],onFilter:function(e,t){return"-"===e?!t.tecnico:!!t.tecnico&&0===t.tecnico._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre+" "+e.apellidos:"-",children:e?e.nombre+" "+e.apellidos:"-"})}},{averias:!0,altas:!0,title:"Tecnico Asignado",dataIndex:"tecnico_liteyca",width:200,ellipsis:{showTitle:!1},filteredValue:a&&a.tecnico_liteyca?a.tecnico_liteyca:null,filters:m||[{text:"",value:""}],onFilter:function(e,t){return"-"===e?!t.tecnico_liteyca:!!t.tecnico_liteyca&&0===t.tecnico_liteyca._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre+" "+e.apellidos:"-",children:e?e.nombre+" "+e.apellidos:"-"})}},{averias:!0,altas:!0,title:"Observacion Gestor",dataIndex:"observacion_gestor",width:250,ellipsis:{showTitle:!1},filteredValue:a&&a.observacion_gestor?a.observacion_gestor:null,filters:q||[{text:"",value:""}],onFilter:function(e,t){return"-"===e?!t.observacion_gestor:!!t.observacion_gestor&&0===String(t.observacion_gestor).toLowerCase().replace(/ /g,"").indexOf(String(e).toLowerCase().replace(/ /g,""))},render:function(e){return Object(r.jsxs)(yn.a,{placement:"topLeft",title:e,children:[e," "]})}},{averias:!0,altas:!0,title:"Fecha Cita",dataIndex:"fecha_cita",width:150,align:"center",filteredValue:a&&a.fecha_cita?a.fecha_cita:null,filters:L||[{text:"",value:""}],onFilter:function(e,t){return"-"===e?!t.fecha_cita:!!t.fecha_cita&&0===Qe()(t.fecha_cita).format("DD/MM/YY").toString().indexOf(String(e))},render:function(e){return e?Qe()(e).format("DD/MM/YY"):"-"}},{averias:!1,altas:!0,title:"Fecha Asignado",dataIndex:"fecha_asignado",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}},{averias:!0,altas:!0,title:"Fecha Registro",dataIndex:"fecha_registro",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}},{averias:!0,altas:!0,title:"Time Slot",dataIndex:"tipo_agenda",width:100,align:"center",fixed:"right",filteredValue:a&&a.tipo_agenda?a.tipo_agenda:null,filters:R?R.filter((function(e){return e.text})):[{text:"",value:""}],onFilter:function(e,t){return!(!t.tipo_agenda||!e)&&0===t.tipo_agenda.indexOf(e)},render:function(e){return e?Object(r.jsx)(Cn.a,{color:"#f50",children:e}):void 0}},{averias:!0,altas:!1,title:"Horas",dataIndex:"fecha_registro",width:80,align:"center",fixed:"right",sorter:function(e,t){return Qe()().diff(e.fecha_registro,"hours")<Qe()().diff(t.fecha_registro,"hours")?-1:Qe()().diff(e.fecha_registro,"hours")>Qe()().diff(t.fecha_registro,"hours")?1:0},render:function(e,t){return Object(r.jsx)(hi,{fecha:e,tipo:fn,tipoAgenda:t.tipo_agenda})}},{averias:!1,altas:!0,title:"Dias",dataIndex:"fecha_asignado",width:80,align:"center",fixed:"right",sorter:function(e,t){return e.fecha_asignado?t.fecha_asignado?Qe()().diff(e.fecha_asignado,"days")<Qe()().diff(t.fecha_asignado,"days")?-1:Qe()().diff(e.fecha_asignado,"days")>Qe()().diff(t.fecha_asignado,"days")?1:0:1:-1},render:function(e){return Object(r.jsx)(To,{fecha:e})}},{averias:!0,altas:!0,title:"Acciones",dataIndex:"_id",width:100,align:"center",fixed:"right",render:function(e,t){return Object(r.jsxs)("div",{children:[Object(r.jsx)(oi.a,{style:{fontSize:"1.5rem",marginRight:".5rem"},onClick:function(){return P(e)}}),Object(r.jsx)(ji,{row:t,listarOrdenes:G})]})}}],H=Y.filter((function(e){return e.averias})),V=Y.filter((function(e){return e.altas}));switch(t){case fn:return H;case jn:return V}}var No=V.a.Search;var Ro=function(e){var t=e.filtros,n=e.setFiltros,i=e.tipo,o=e.data,c=void 0===o?[]:o,s=e.loading,l=e.ordenesSeleccionadas,d=e.setOrdenesSeleccionadas,u=e.abrirReiterada,b=e.abrirInfancia,f=e.abrirRegistro,j=e.listarOrdenes,h=Object(a.useState)([]),p=Object(I.a)(h,2),O=p[0],g=p[1],x=Object(a.useState)([]),m=Object(I.a)(x,2),v=m[0],_=m[1],w=Object(a.useState)([]),y=Object(I.a)(w,2),S=y[0],C=y[1],k=Object(a.useState)([]),A=Object(I.a)(k,2),T=A[0],E=A[1],D=Object(a.useState)([]),N=Object(I.a)(D,2),q=N[0],F=N[1],L=Object(a.useState)([]),z=Object(I.a)(L,2),B=z[0],P=z[1],G=Object(a.useState)([]),Y=Object(I.a)(G,2),H=Y[0],V=Y[1],U=Object(a.useState)([]),K=Object(I.a)(U,2),J=K[0],W=K[1],Z=Object(a.useState)([]),X=Object(I.a)(Z,2),Q=X[0],$=X[1],ee=Object(a.useState)([]),te=Object(I.a)(ee,2),ne=te[0],re=te[1],ae=Object(a.useState)([]),ie=Object(I.a)(ae,2),oe=ie[0],ce=ie[1],se=Object(a.useState)([]),le=Object(I.a)(se,2),de=le[0],ue=le[1],be=Object(a.useState)([]),fe=Object(I.a)(be,2),je=fe[0],he=fe[1],pe=Object(a.useState)([]),Oe=Object(I.a)(pe,2),ge=Oe[0],xe=Oe[1],me=Object(a.useState)([]),ve=Object(I.a)(me,2),_e=ve[0],we=ve[1],ye=Object(a.useState)([]),Se=Object(I.a)(ye,2),Ce=Se[0],ke=Se[1],Ie=Object(a.useState)([]),Ae=Object(I.a)(Ie,2),Te=Ae[0],Ee=Ae[1],De=Object(a.useState)([]),Ne=Object(I.a)(De,2),Re=Ne[0],Me=Ne[1],qe=Object(a.useState)(null),Fe=Object(I.a)(qe,2),Le=Fe[0],ze=Fe[1],Be=Object(a.useState)(!1),Pe=Object(I.a)(Be,2),Ge=Pe[0],Ye=Pe[1],He=Object(a.useState)(0),Ve=Object(I.a)(He,2),Ue=Ve[0],Ke=Ve[1];Object(a.useEffect)((function(){c&&c.length>0?(g(c),We(c)):g([])}),[c]),Object(a.useEffect)((function(){t||Ke(0)}),[t]);var Je=function(){return Ye(!Ge)},We=function(e){Ke(e.length),_(Ur(e,"distrito")),C(Ur(e,"bucket")),E(Ur(e,"estado_toa")),F(Ur(e,"estado_gestor")),re(Ur(e,"tipo_requerimiento")),ce(Ur(e,"tipo_tecnologia")),ue(Ur(e,"codigo_nodo")),he(Ur(e,"codigo_troba")),xe(Ur(e,"indicador_pai")),we(Ur(e,"codigo_ctr")),ke(Ur(e,"observacion_gestor")),Ee(Ur(e,"tipo_agenda")),Me(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(0===e.length)return[];var n=[];try{return e.forEach((function(e){void 0!==e[t]&&null!==e[t]&&-1===n.findIndex((function(n){return n.value===Qe()(e[t]).format("DD/MM/YY")}))&&n.push({text:Qe()(e[t]).format("DD/MM/YY"),value:Qe()(e[t]).format("DD/MM/YY")})})),n.push({text:"-",value:"-"}),n}catch(r){return console.log(r),[]}}(e,"fecha_cita")),P(Vr(e,"contrata")),V(Vr(e,"gestor_liteyca",!0)),W(Vr(e,"tecnico",!0)),$(Vr(e,"tecnico_liteyca",!0))};function Ze(e){e&&e.length>1?g(c.filter((function(t){return String(t.codigo_requerimiento).includes(e)}))):g(c)}return Object(r.jsxs)("div",{children:[Object(r.jsx)(In.a,{title:function(){return Object(r.jsx)(No,{placeholder:"Requerimiento...",onSearch:Ze,style:{width:180,marginRight:"0rem",marginBottom:".5rem"},allowClear:!0})},rowKey:"_id",onRow:function(e){return{onDoubleClick:function(){return t=e._id,ze(t),void Je();var t}}},rowSelection:{columnWidth:50,selectedRowKeys:l,onChange:function(e){return d(e)}},onChange:function(e,t,r,a){We(a.currentDataSource),n(t)},columns:Do({tipo:i,filtros:t,setFiltros:n,filtroDistrito:v,filtroBucket:S,filtroEstadoToa:T,filtroEstadoGestor:q,filtroContrata:B,filtroGestorAsignado:H,filtroTecnicoToa:J,filtroTecnicoAsignado:Q,filtroTipoReq:ne,filtroTecnologia:oe,filtroNodo:de,filtroTroba:je,filtroPai:ge,filtroCtr:_e,filtroTimeSlot:Te,filtroObservacion:Ce,filtroFechaCita:Re,abrirReiterada:u,abrirInfancia:b,abrirRegistro:f,listarOrdenes:j}),dataSource:O,loading:s,size:"small",scroll:{y:"65vh"},pagination:{defaultPageSize:50,pageSizeOptions:[50,100,200]},footer:function(){return Object(r.jsxs)(R.a,{gutter:16,children:[Object(r.jsx)(M.a,{span:4,children:Object(r.jsx)(Qt.a,{title:"Total",value:c.length})}),Object(r.jsx)(M.a,{span:12,children:Object(r.jsx)(Qt.a,{title:"Total Filtradas",value:Ue})})]})}}),Object(r.jsx)(mi,{visible:Ge,abrir:Je,orden:Le,tipo:i})]})},Mo=Ke.a.Option,qo=V.a.TextArea;var Fo=function(e){var t=e.visible,n=e.abrir,i=(e.buckets,e.contratas,e.gestores),o=void 0===i?[]:i,c=e.agendar,s=Object(a.useState)(null),l=Object(I.a)(s,2),d=l[0],u=l[1],b=Object(a.useState)(null),f=Object(I.a)(b,2),j=f[0],h=f[1],p=Object(a.useState)(null),O=Object(I.a)(p,2),g=O[0],x=O[1],m=Object(a.useState)(null),v=Object(I.a)(m,2),_=v[0],w=v[1],y=Object(a.useState)(null),S=Object(I.a)(y,2),C=S[0],k=S[1],A=Object(a.useState)(!1),T=Object(I.a)(A,2),E=T[0],D=T[1];Object(a.useEffect)((function(){u(null),h(null),x(null),w(null),k(null)}),[]);var N=function(){var e=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!_){e.next=6;break}return D(!0),e.next=4,c(d,j,g,_,C);case 4:D(!1),n();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(kn.a,{title:"Agendar Orden",width:400,visible:t,onCancel:n,onOk:N,confirmLoading:!0,destroyOnClose:!0,centered:!0,footer:[Object(r.jsx)(U.a,{onClick:n,children:"Cancelar"},"back"),Object(r.jsx)(U.a,{disabled:!_,type:"primary",loading:E,onClick:N,children:"Aceptar"},"submit")],children:[Object(r.jsx)(Ke.a,{showSearch:!0,placeholder:"Seleccionar Gestor",style:{width:300,marginBottom:".5rem"},onChange:function(e){return x(e)},defaultValue:g,filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},children:o&&o.length>0?o.map((function(e,t){return Object(r.jsx)(Mo,{value:e._id,children:e.nombre},t)})):Object(r.jsx)(Mo,{children:"Sin data"})}),Object(r.jsx)(We.a,{defaultValue:Qe()(_||Date.now()),placeholder:"Seleccionar fecha de cita",style:{width:300,marginBottom:".5rem"},onChange:function(e){w(e?e.utc().format("YYYY-MM-DD HH:mm"):null)}}),Object(r.jsx)(qo,{rows:4,style:{width:300},defaultValue:C,placeholder:"Observacion",onChange:function(e){return k(e.target.value)}})]})};var Lo=function(e){var t=e.contratas,n=e.gestores,i=e.tecnicos,o=e.tipo,s=Object(a.useState)([]),l=Object(I.a)(s,2),d=l[0],u=l[1],b=Object(a.useState)([]),f=Object(I.a)(b,2),j=f[0],h=f[1],p=Object(a.useState)([]),O=Object(I.a)(p,2),g=O[0],x=O[1],m=Object(a.useState)([]),v=Object(I.a)(m,2),_=v[0],w=v[1],y=Object(a.useState)(!1),S=Object(I.a)(y,2),C=S[0],k=S[1],A=Object(a.useState)(!1),T=Object(I.a)(A,2),E=T[0],D=T[1],N=Object(a.useState)(!1),R=Object(I.a)(N,2),M=R[0],q=R[1],F=Object(a.useState)(!1),L=Object(I.a)(F,2),z=L[0],G=L[1],Y=Object(a.useState)(!1),H=Object(I.a)(Y,2),V=H[0],K=H[1],J=Object(a.useState)(!1),W=Object(I.a)(J,2),Z=W[0],X=W[1],Q=Object(a.useState)(!1),$=Object(I.a)(Q,2),ee=$[0],te=$[1],ne=Object(a.useState)(!1),re=Object(I.a)(ne,2),ae=re[0],ie=re[1],oe=Object(a.useState)(!1),ce=Object(I.a)(oe,2),se=ce[0],le=ce[1],de=Object(a.useState)(!1),ue=Object(I.a)(de,2),be=ue[0],fe=ue[1],je=Object(a.useState)(!1),he=Object(I.a)(je,2),pe=he[0],ge=he[1],xe=Object(a.useState)(!1),me=Object(I.a)(xe,2),ve=me[0],_e=me[1],we=Object(a.useState)(!1),ye=Object(I.a)(we,2),Se=ye[0],Ce=ye[1],ke=Object(a.useState)(!1),Ie=Object(I.a)(ke,2),Ae=Ie[0],Te=Ie[1],Ee=Object(a.useState)(!1),De=Object(I.a)(Ee,2),Ne=De[0],Re=De[1],Me=Object(a.useState)(null),qe=Object(I.a)(Me,2),Fe=qe[0],Le=qe[1],ze=Object(a.useState)(null),Be=Object(I.a)(ze,2),Pe=Be[0],Ge=Be[1];function Ye(){return He.apply(this,arguments)}function He(){return(He=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(!0),w([]),e.next=4,li(!0,{metodo:At,tipo:o}).then((function(e){var t=e.data;t&&t.length>0&&u(t)})).catch((function(e){return console.log(e)})).finally((function(){return k(!1)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ve(e){return Ue.apply(this,arguments)}function Ue(){return(Ue=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ie(!0),e.next=3,li(!0,{metodo:Lt,id:t}).then((function(e){var t=e.data;t&&t._id&&x([t])})).catch((function(e){return console.log(e)})).finally((function(){return ie(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ke(e){return Je.apply(this,arguments)}function Je(){return(Je=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return te(!0),e.next=3,li(!0,{metodo:zt,id:t}).then((function(e){var t=e.data;t&&t.length>0&&h(t)})).catch((function(e){return console.log(e)})).finally((function(){return te(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function We(){return(We=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!0),e.next=3,li(!0,{metodo:It,tipo:o}).then((function(e){"success"===e.status&&Ye()})).catch((function(e){return console.log(e)})).finally((function(){return D(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ze(){return(Ze=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return q(!0),e.next=3,li(!0,{metodo:Ct}).then((function(e){"success"===e.status&&Ye()})).catch((function(e){return console.log(e)})).finally((function(){return q(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xe(){return(Xe=Object(P.a)(B.a.mark((function e(t,n,r,a,i){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(_&&_.length>0)){e.next=4;break}return G(!0),e.next=4,bi({metodo:Pt,ordenes:_,bucket:t,contrata:n,gestor:r,fecha_cita:a,observacion:i}).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ye();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)})).finally((function(){return G(!1)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qe(){return(Qe=Object(P.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(_&&_.length>0)){e.next=6;break}return n=t,K(!0),tt(),e.next=6,bi(Object(c.a)({metodo:Yt,ordenes:_},n)).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ye();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)})).finally((function(){return K(!1)}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $e(){return($e=Object(P.a)(B.a.mark((function e(t,n){var r,a,i=arguments;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>2&&void 0!==i[2]?i[2]:[],!(_&&_.length>0)){e.next=12;break}return(a=new FormData).append("metodo",Ht),a.append("ordenes",JSON.stringify(_)),t&&a.append("estado",t),n&&a.append("observacion",n),r.forEach((function(e){a.append("files",e)})),X(!0),at(),e.next=12,fi(a).then(Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ye();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)})).finally((function(){return X(!1)}));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){Ye()}),[]);var et=function(){return fe(!be)},tt=function(){return ge(!pe)},nt=function(){return _e(!ve)},rt=function(){return Ce(!Se)},at=function(){return Te(!Ae)},it=function(){return Re(!Ne)},ot=function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return rt(),e.next=3,Ve(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ct=function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return it(),e.next=3,Ke(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{children:[Object(r.jsx)(U.a,{type:"primary",icon:C?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ta.a,{}),disabled:C,style:{marginBottom:"1rem",marginRight:".5rem"},onClick:Ye,children:"Actualizar"}),Object(r.jsx)(U.a,{icon:E?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ko.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},onClick:function(){return We.apply(this,arguments)},children:"Sincronizar"}),Object(r.jsx)(U.a,{icon:M?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(Io.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},onClick:function(){return Ze.apply(this,arguments)},children:"Comprobar Infancias"}),Object(r.jsx)(U.a,{icon:z?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(Oe.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},disabled:0===_.length,onClick:et,children:"Agendar"}),Object(r.jsx)(U.a,{icon:V?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(za.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},disabled:0===_.length,onClick:tt,children:"Asignar"}),Object(r.jsx)(U.a,{icon:Z?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(Ba.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},disabled:0===_.length,onClick:at,children:"Estado"}),Object(r.jsx)(La.a,{overlay:Object(r.jsx)(Ui,{metodo:Nt,tipo:o,setLoading:le,ordenesSeleccionadas:_}),placement:"bottomLeft",trigger:["click"],arrow:!0,children:Object(r.jsx)(U.a,{icon:se?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ya.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},children:"Exportar"})}),Object(r.jsx)(U.a,{icon:Object(r.jsx)(Ao.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},onClick:function(){Ge(null)},children:"Filtros"})]}),Object(r.jsx)(Ro,{filtros:Pe,setFiltros:Ge,tipo:o,data:d,loading:C,ordenesSeleccionadas:_,setOrdenesSeleccionadas:w,abrirReiterada:function(e){Le(e),nt()},abrirInfancia:ot,abrirRegistro:ct,listarOrdenes:Ye}),Object(r.jsx)(Fo,{visible:be,abrir:et,buckets:Va,contratas:t,gestores:n,agendar:function(e,t,n,r,a){return Xe.apply(this,arguments)}}),Object(r.jsx)(Gi,{visible:pe,abrir:tt,contratas:t,gestores:n,tecnicos:i,asignar:function(e){return Qe.apply(this,arguments)}}),Object(r.jsx)(Mi,{visible:Ae,abrir:at,actualizarEstado:function(e,t){return $e.apply(this,arguments)}}),Object(r.jsx)(Ai,{visible:ve,abrir:nt,codigo_cliente:Fe}),Object(r.jsx)(ki,{visible:Se,abrir:rt,loading:ae,orden:g}),Object(r.jsx)(Si,{visible:Ne,abrir:it,loading:ee,registros:j})]})},zo=Le.a.Text;function Bo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],l=arguments.length>8?arguments[8]:void 0,d=arguments.length>9?arguments[9]:void 0,u=[{averias:!0,altas:!0,title:"#",width:50,fixed:"left",render:function(e,t,n){return n+1}},{averias:!0,altas:!0,title:"Requerimiento",dataIndex:"codigo_requerimiento",width:120,fixed:"left",render:function(e){return Object(r.jsx)(zo,{copyable:!0,children:e})}},{averias:!1,altas:!0,title:"Orden Trabajo",dataIndex:"codigo_trabajo",width:120,render:function(e){return Object(r.jsx)(zo,{copyable:!0,children:e})}},{averias:!1,altas:!0,title:"Peticion",dataIndex:"codigo_peticion",width:120,render:function(e){return Object(r.jsx)(zo,{copyable:!0,children:e})}},{averias:!0,altas:!0,title:"Codigo Cliente",dataIndex:"codigo_cliente",width:120,render:function(e){return Object(r.jsx)(zo,{copyable:!0,children:e})}},{averias:!0,altas:!0,title:"Tecnologia",dataIndex:"tipo_tecnologia",align:"center",width:120,filters:o||[],onFilter:function(e,t){return 0===t.tipo_tecnologia.indexOf(e)}},{averias:!0,altas:!0,title:"CTR",dataIndex:"codigo_ctr",width:60,filters:s||[],onFilter:function(e,t){return 0===String(t.codigo_ctr).indexOf(String(e))}},{averias:!0,altas:!0,title:"Descripci\xf3n CTR",dataIndex:"descripcion_ctr",width:150},{averias:!1,altas:!0,title:"Tipo Req.",dataIndex:"tipo_requerimiento",align:"center",width:100,filters:i||[],onFilter:function(e,t){return 0===t.tipo_requerimiento.indexOf(e)}},{averias:!0,altas:!0,title:"Nodo",dataIndex:"codigo_nodo",width:70,filters:c||[],onFilter:function(e,t){return 0===t.codigo_nodo.indexOf(e)}},{averias:!0,altas:!0,title:"Troba",dataIndex:"codigo_troba",width:70,sorter:function(e,t){return e.codigo_troba<t.codigo_troba?-1:e.codigo_troba>t.codigo_troba?1:0}},{averias:!0,altas:!0,title:"Distrito",dataIndex:"distrito",width:160,filters:t||[],onFilter:function(e,t){return 0===t.distrito.indexOf(e)}},{averias:!0,altas:!0,title:"Estado Toa",dataIndex:"estado_toa",width:150,align:"center",filters:n||[],onFilter:function(e,t){return 0===t.estado_toa.indexOf(e)},render:function(e){return Object(r.jsx)(ci,{estado:e})}},{averias:!0,altas:!0,title:"Estado Gestor",dataIndex:"estado_gestor",width:150,align:"center",filters:a||[],onFilter:function(e,t){return 0===t.estado_gestor.indexOf(e)},render:function(e){return Object(r.jsx)(ci,{estado:e})}},{averias:!0,altas:!1,title:"Estado Liquidado",dataIndex:"estado_liquidado",width:150,align:"center",render:function(e){return Object(r.jsx)(ci,{estado:e})}},{averias:!0,altas:!0,title:"Tecnico Liquidado",dataIndex:"nombre_liquidado",width:200,ellipsis:{showTitle:!1},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e,children:e})}},{averias:!0,altas:!0,title:"Carnet",dataIndex:"carnet_liquidado",width:100},{averias:!0,altas:!1,title:"Tipo Averia",dataIndex:"tipo_averia",width:150},{averias:!0,altas:!0,title:"Descripci\xf3n Liquidado",dataIndex:"descripcion_codigo_liquidado",width:250},{averias:!0,altas:!0,title:"Observaci\xf3n Gestor",dataIndex:"observacion_gestor",width:250},{averias:!0,altas:!0,title:"Observaci\xf3n Liquidado",dataIndex:"observacion_liquidado",width:250},{averias:!1,altas:!0,title:"Fecha Asignado",dataIndex:"fecha_asignado",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}},{averias:!0,altas:!0,title:"Fecha Registro",dataIndex:"fecha_registro",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}},{averias:!0,altas:!0,title:"Fecha Liquidado",dataIndex:"fecha_liquidado",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}},{averias:!0,altas:!1,title:"Plazo 24h",dataIndex:"fecha_registro",width:100,align:"center",fixed:"right",sorter:function(e,t){if(e.fecha_liquidado){if(Qe()(e.fecha_liquidado).diff(e.fecha_registro,"hours")<Qe()(e.fecha_liquidado).diff(t.fecha_registro,"hours"))return-1}else{if(Qe()().diff(e.fecha_registro,"hours")<Qe()().diff(t.fecha_registro,"hours"))return-1;if(Qe()().diff(e.fecha_registro,"hours")>Qe()().diff(t.fecha_registro,"hours"))return 1}return Qe()(e.fecha_liquidado).diff(e.fecha_registro,"hours")>Qe()(e.fecha_liquidado).diff(t.fecha_registro,"hours")?1:0},render:function(e,t){if(t.fecha_liquidado){if(e){var n=Qe()(t.fecha_liquidado).diff(e,"hours");return Object(r.jsx)(Cn.a,{color:t.agenda?"geekblue":n<24?"success":24===n?"warning":"error",children:n})}return Object(r.jsx)(Cn.a,{children:"-"})}var a=Qe()().diff(e,"hours");return Object(r.jsx)(Cn.a,{children:a})}},{averias:!1,altas:!0,title:"Plazo 72h",dataIndex:"fecha_registro",width:100,align:"center",fixed:"right",sorter:function(e,t){if(e.fecha_liquidado){if(Qe()(e.fecha_liquidado).diff(e.fecha_registro,"hours")<Qe()(e.fecha_liquidado).diff(t.fecha_registro,"hours"))return-1}else{if(Qe()().diff(e.fecha_registro,"hours")<Qe()().diff(t.fecha_registro,"hours"))return-1;if(Qe()().diff(e.fecha_registro,"hours")>Qe()().diff(t.fecha_registro,"hours"))return 1}return Qe()(e.fecha_liquidado).diff(e.fecha_registro,"hours")>Qe()(e.fecha_liquidado).diff(t.fecha_registro,"hours")?1:0},render:function(e,t){if(t.fecha_liquidado){if(e){var n=Qe()(t.fecha_liquidado).diff(e,"hours");return Object(r.jsx)(Cn.a,{color:t.agenda?"blue":n<72?"success":72===n?"warning":"error",children:n})}return Object(r.jsx)(Cn.a,{children:"-"})}var a=Qe()().diff(e,"hours");return Object(r.jsx)(Cn.a,{children:a})}},{averias:!0,altas:!0,title:"Acciones",dataIndex:"_id",width:100,align:"center",fixed:"right",render:function(e,t){return Object(r.jsxs)("div",{children:[Object(r.jsx)(oi.a,{style:{fontSize:"1.5rem",marginRight:".5rem"},onClick:function(){return l(e)}}),Object(r.jsx)(ji,{row:t,listarOrdenes:d})]})}}],b=u.filter((function(e){return e.averias})),f=u.filter((function(e){return e.altas}));switch(e){case fn:return b;case jn:return f}}var Po=function(e){var t=e.tipo,n=Object(a.useState)([]),i=Object(I.a)(n,2),o=i[0],c=i[1],s=Object(a.useState)([]),l=Object(I.a)(s,2),d=l[0],u=l[1],b=Object(a.useState)([]),f=Object(I.a)(b,2),j=f[0],h=f[1],p=Object(a.useState)(!1),O=Object(I.a)(p,2),g=O[0],x=O[1],m=Object(a.useState)(!1),v=Object(I.a)(m,2),_=v[0],w=v[1],y=Object(a.useState)([]),S=Object(I.a)(y,2),C=S[0],k=S[1],A=Object(a.useState)([]),T=Object(I.a)(A,2),E=T[0],D=T[1],N=Object(a.useState)([]),R=Object(I.a)(N,2),M=R[0],q=R[1],F=Object(a.useState)([]),L=Object(I.a)(F,2),z=L[0],G=L[1],Y=Object(a.useState)([]),H=Object(I.a)(Y,2),V=H[0],K=H[1],J=Object(a.useState)([]),W=Object(I.a)(J,2),Z=W[0],X=W[1],Q=Object(a.useState)([]),$=Object(I.a)(Q,2),ee=$[0],te=$[1],ne=Object(a.useState)(!1),re=Object(I.a)(ne,2),ae=re[0],ie=re[1];function oe(){return ce.apply(this,arguments)}function ce(){return(ce=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),h([]),e.next=4,li(!0,{metodo:Dt,tipo:t}).then((function(e){var t=e.data;t&&t.length>0&&(c(t),k(Ur(t,"distrito")),D(Ur(t,"estado_toa")),q(Ur(t,"estado_gestor")),G(Ur(t,"tipo_requerimiento")),K(Ur(t,"tipo_tecnologia")),X(Ur(t,"codigo_nodo")),te(Ur(t,"codigo_ctr")))})).catch((function(e){return console.log(e)})).finally((function(){return x(!1)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){oe()}),[]);var se=function(){return ie(!ae)};function le(e){return de.apply(this,arguments)}function de(){return(de=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(!0),e.next=3,li(!0,{metodo:zt,id:t}).then((function(e){var t=e.data;t&&t.length>0&&u(t)})).catch((function(e){return console.log(e)})).finally((function(){return w(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ue=function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return se(),e.next=3,le(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{children:Object(r.jsx)(U.a,{type:"primary",disabled:g,icon:g?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ta.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},onClick:oe,children:"Actualizar"})}),Object(r.jsx)(In.a,{rowKey:"_id",rowSelection:{columnWidth:50,selectedRowKeys:j,onChange:function(e){return h(e)}},columns:Bo(t,C,E,M,z,V,Z,ee,ue,oe),dataSource:o,loading:g,size:"small",scroll:{y:"65vh"},pagination:{defaultPageSize:50,pageSizeOptions:[50,100,200]}}),Object(r.jsx)(Si,{visible:ae,abrir:se,loading:_,registros:d})]})},Go=Nn.a.TabPane;var Yo=Le.a.Text;function Ho(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[],d=arguments.length>9?arguments[9]:void 0,u=arguments.length>10?arguments[10]:void 0;return[{title:"#",width:50,fixed:"left",render:function(e,t,n){return n+1}},{title:"Requerimiento",dataIndex:"codigo_requerimiento",width:120,fixed:"left",render:function(e){return Object(r.jsx)(Yo,{copyable:!0,children:e})}},{title:"Orden Trabajo",dataIndex:"codigo_trabajo",width:120,render:function(e){return Object(r.jsx)(Yo,{copyable:!0,children:e})}},{title:"Peticion",dataIndex:"codigo_peticion",width:120,render:function(e){return Object(r.jsx)(Yo,{copyable:!0,children:e})}},{title:"Codigo Cliente",dataIndex:"codigo_cliente",width:120,render:function(e){return Object(r.jsx)(Yo,{copyable:!0,children:e})}},{title:"Tecnologia",dataIndex:"tipo_tecnologia",align:"center",width:120,filters:c||[],onFilter:function(e,t){return 0===t.tipo_tecnologia.indexOf(e)}},{title:"CTR",dataIndex:"codigo_ctr",width:60,filters:l||[],onFilter:function(e,t){return 0===String(t.codigo_ctr).indexOf(String(e))}},{title:"Nodo",dataIndex:"codigo_nodo",width:70,filters:s||[],onFilter:function(e,t){return 0===t.codigo_nodo.indexOf(e)}},{title:"Troba",dataIndex:"codigo_troba",width:70,sorter:function(e,t){return e.codigo_troba<t.codigo_troba?-1:e.codigo_troba>t.codigo_troba?1:0}},{title:"Distrito",dataIndex:"distrito",width:160,filters:e||[],onFilter:function(e,t){return 0===t.distrito.indexOf(e)}},{title:"Estado Toa",dataIndex:"estado_toa",width:150,align:"center",filters:t||[],onFilter:function(e,t){return 0===t.estado_toa.indexOf(e)},render:function(e){return Object(r.jsx)(ci,{estado:e})}},{title:"Estado Gestor",dataIndex:"estado_gestor",width:150,align:"center",filters:n||[],onFilter:function(e,t){return 0===t.estado_gestor.indexOf(e)},render:function(e){return Object(r.jsx)(ci,{estado:e})}},{title:"Contrata",dataIndex:"contrata",width:200,ellipsis:{showTitle:!1},filters:a||[],onFilter:function(e,t){return"-"===e?!t.contrata:void 0!==t.contrata&&0===t.contrata._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre:"-",children:e?e.nombre:"-"})}},{title:"Gestor",dataIndex:"gestor",width:200,ellipsis:{showTitle:!1},filters:i||[],onFilter:function(e,t){return"-"===e?!t.gestor:void 0!==t.gestor&&0===t.gestor._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre+" "+e.apellidos:"-",children:e?e.nombre+" "+e.apellidos:"-"})}},{title:"Tecnico Asignado",dataIndex:"tecnico",width:200,ellipsis:{showTitle:!1},filters:o||[],onFilter:function(e,t){return"-"===e?!t.tecnico_liquidado:!!t.tecnico_liquidado&&0===t.tecnico_liquidado._id.indexOf(e)},render:function(e){return Object(r.jsx)(yn.a,{placement:"topLeft",title:e?e.nombre+" "+e.apellidos:"-",children:e?e.nombre+" "+e.apellidos:"-"})}},{title:"Observaci\xf3n Gestor",dataIndex:"observacion_gestor",width:250},{title:"Observaci\xf3n Liquidado",dataIndex:"observacion_liquidado",width:250},{title:"Fecha Registro",dataIndex:"fecha_registro",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}},{title:"Fecha Liquidado",dataIndex:"fecha_liquidado",width:150,render:function(e){return e?Qe()(e).format("DD/MM/YY HH:mm"):"-"}},{title:"Plazo 72h",dataIndex:"fecha_registro",width:100,align:"center",fixed:"right",sorter:function(e,t){return Qe()(e.fecha_liquidado).diff(e.fecha_registro,"hours")<Qe()(e.fecha_liquidado).diff(t.fecha_registro,"hours")?-1:Qe()(e.fecha_liquidado).diff(e.fecha_registro,"hours")>Qe()(e.fecha_liquidado).diff(t.fecha_registro,"hours")?1:0},render:function(e,t){if(e){var n=Qe()(t.fecha_liquidado).diff(e,"hours");return Object(r.jsx)(Cn.a,{color:t.fecha_cita?"geekblue":n<72&&!t.fecha_cita?"success":72!==n||t.fecha_cita?"error":"warning",children:n})}return Object(r.jsx)(Cn.a,{children:"-"})}},{title:"Acciones",dataIndex:"_id",width:100,align:"center",fixed:"right",render:function(e,t){return Object(r.jsxs)("div",{children:[Object(r.jsx)(oi.a,{style:{fontSize:"1.5rem",marginRight:".5rem"},onClick:function(){return d(e)}}),Object(r.jsx)(ji,{row:t,listarOrdenes:u})]})}}]}var Vo=function(e){var t=e.tipo,n=Object(a.useState)([]),i=Object(I.a)(n,2),o=i[0],c=i[1],s=Object(a.useState)([]),l=Object(I.a)(s,2),d=l[0],u=l[1],b=Object(a.useState)([]),f=Object(I.a)(b,2),j=f[0],h=f[1],p=Object(a.useState)(!1),O=Object(I.a)(p,2),g=O[0],x=O[1],m=Object(a.useState)(!1),v=Object(I.a)(m,2),_=v[0],w=v[1],y=Object(a.useState)([]),S=Object(I.a)(y,2),C=S[0],k=S[1],A=Object(a.useState)([]),T=Object(I.a)(A,2),E=T[0],D=T[1],N=Object(a.useState)([]),R=Object(I.a)(N,2),M=R[0],q=R[1],F=Object(a.useState)([]),L=Object(I.a)(F,2),z=L[0],G=L[1],Y=Object(a.useState)([]),H=Object(I.a)(Y,2),V=H[0],K=H[1],J=Object(a.useState)([]),W=Object(I.a)(J,2),Z=W[0],X=W[1],Q=Object(a.useState)([]),$=Object(I.a)(Q,2),ee=$[0],te=$[1],ne=Object(a.useState)([]),re=Object(I.a)(ne,2),ae=re[0],ie=re[1],oe=Object(a.useState)([]),ce=Object(I.a)(oe,2),se=ce[0],le=ce[1],de=Object(a.useState)(!1),ue=Object(I.a)(de,2),be=ue[0],fe=ue[1];function je(){return he.apply(this,arguments)}function he(){return(he=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),h([]),e.next=4,li(!0,{metodo:Et,tipo:t}).then((function(e){var t=e.data;t&&t.length>0&&(c(t),k(Ur(t,"distrito")),D(Ur(t,"estado_toa")),q(Ur(t,"estado_gestor")),G(Ur(t,"tipo_tecnologia")),K(Ur(t,"codigo_nodo")),X(Ur(t,"codigo_ctr")),te(Vr(t,"contrata")),ie(Vr(t,"gestor")),le(Vr(t,"tecnico")))})).catch((function(e){return console.log(e)})).finally((function(){return x(!1)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){je()}),[]);var pe=function(){return fe(!be)};function Oe(e){return ge.apply(this,arguments)}function ge(){return(ge=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(!0),e.next=3,li(!0,{metodo:zt,id:t}).then((function(e){var t=e.data;t&&t.length>0&&u(t)})).catch((function(e){return console.log(e)})).finally((function(){return w(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var xe=function(){var e=Object(P.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pe(),e.next=3,Oe(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{children:Object(r.jsx)(U.a,{type:"primary",icon:g?Object(r.jsx)(Yr.a,{spin:!0}):Object(r.jsx)(ta.a,{}),style:{marginBottom:"1rem",marginRight:".5rem"},onClick:je,children:"Actualizar"})}),Object(r.jsx)(In.a,{rowKey:"_id",rowSelection:{columnWidth:50,selectedRowKeys:j,onChange:function(e){return h(e)}},columns:Ho(C,E,M,ee,ae,se,z,V,Z,xe,je),dataSource:o,loading:g,size:"small",scroll:{y:"65vh"},pagination:{defaultPageSize:50,pageSizeOptions:[50,100,200]}}),Object(r.jsx)(Si,{visible:be,abrir:pe,loading:_,registros:d})]})},Uo=Nn.a.TabPane;var Ko=[{path:m,exact:!0,component:function(){var e=Object(a.useState)([]),t=Object(I.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)([]),c=Object(I.a)(o,2),s=c[0],l=c[1],d=Object(a.useState)([]),u=Object(I.a)(d,2),b=u[0],f=u[1];function j(){return(j=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ar(!1,yt).then((function(e){var t=e.data;return i(t||[])})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return(h=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt(!1,{metodo:lt}).then((function(e){var t=e.data;return l(t||[])})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return(p=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt(!1,{metodo:st}).then((function(e){var t=e.data;return f(t||[])})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){!function(){j.apply(this,arguments)}(),function(){h.apply(this,arguments)}(),function(){p.apply(this,arguments)}()}),[]),Object(r.jsxs)("div",{children:[Object(r.jsx)(et,{titulo:"Administrar Averias Hfc",subtitulo:"Operativa"}),Object(r.jsx)(q,{children:Object(r.jsxs)(Nn.a,{style:{paddingLeft:"1rem"},animated:!1,children:[Object(r.jsx)(Go,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(ao.a,{}),"Actualizar Ordenes"]}),children:Object(r.jsx)("div",{children:Object(r.jsx)(Co,{tipoOrden:fn,tecnicos:b})})},"1"),Object(r.jsx)(Go,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(qa.a,{}),"Ordenes Pendientes"]}),children:Object(r.jsx)(Lo,{contratas:n,gestores:s,tecnicos:b,tipo:fn})},"2"),Object(r.jsx)(Go,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)($t.a,{}),"Ordenes Liquidadas"]}),children:Object(r.jsx)($i,{tipo:fn})},"3"),Object(r.jsx)(Go,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(io.a,{}),"Otras Bandejas"]}),children:Object(r.jsx)(Po,{tipo:fn})},"4"),Object(r.jsx)(Go,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(Oe.a,{}),"Aprobar Ordenes"]})},"5")]})})]})},nivel:k.administrarOrdenes},{path:v,exact:!0,component:function(){var e=Object(a.useState)([]),t=Object(I.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)([]),c=Object(I.a)(o,2),s=c[0],l=c[1],d=Object(a.useState)([]),u=Object(I.a)(d,2),b=u[0],f=u[1];function j(){return(j=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ar(!1,yt).then((function(e){var t=e.data;return i(t||[])})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return(h=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt(!1,{metodo:lt}).then((function(e){var t=e.data;return l(t||[])})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return(p=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt(!1,{metodo:st}).then((function(e){var t=e.data;return f(t||[])})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){!function(){j.apply(this,arguments)}(),function(){h.apply(this,arguments)}(),function(){p.apply(this,arguments)}()}),[]),Object(r.jsxs)("div",{children:[Object(r.jsx)(et,{titulo:"Administrar Altas Hfc",subtitulo:"Operativa"}),Object(r.jsx)(q,{children:Object(r.jsxs)(Nn.a,{style:{paddingLeft:"1rem"},animated:!1,children:[Object(r.jsx)(Uo,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(ao.a,{}),"Actualizar Ordenes"]}),children:Object(r.jsx)(Co,{tipoOrden:jn,tecnicos:b})},"1"),Object(r.jsx)(Uo,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(qa.a,{}),"Ordenes Pendientes"]}),children:Object(r.jsx)(Lo,{contratas:n,gestores:s,tecnicos:b,tipo:jn})},"2"),Object(r.jsx)(Uo,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)($t.a,{}),"Ordenes Liquidadas"]}),children:Object(r.jsx)($i,{tipo:jn})},"3"),Object(r.jsx)(Uo,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(fr.a,{}),"Ordenes Anuladas"]}),children:Object(r.jsx)(Vo,{tipo:jn})},"4"),Object(r.jsx)(Uo,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(io.a,{}),"Otras Bandejas"]}),children:Object(r.jsx)(Po,{tipo:jn})},"5"),Object(r.jsx)(Uo,{tab:Object(r.jsxs)("span",{children:[Object(r.jsx)(Oe.a,{}),"Aprobar Ordenes"]})},"6")]})})]})},nivel:k.administrarOrdenes},{path:_,exact:!0,component:function(){return Object(r.jsx)("div",{children:"administrar basicas"})},nivel:k.administrarOrdenes},{path:w,exact:!0,component:function(){return Object(r.jsx)("div",{children:"administrar speedy"})},nivel:k.administrarOrdenes}],Jo=[].concat(Object(ue.a)(Ra),Object(ue.a)(ro),Object(ue.a)(Ko)),Wo=[].concat(Object(ue.a)(Zt),Object(ue.a)(dr),Object(ue.a)(Gr),Object(ue.a)(Jo)),Zo=n(328),Xo=n(637);function Qo(){return Object(r.jsx)(q,{children:Object(r.jsx)(Xo.a,{status:"403",title:"403",subTitle:"Lo sentimos, no tienes autorizacion para entrar a esta p\xe1gina.",extra:Object(r.jsx)(U.a,{type:"primary",onClick:function(){return window.location.pathname=h},children:"Inicio"})})})}var $o=function(e){var t=e.component,n=e.nivel,i=void 0===n?[]:n,o=Object(Zo.a)(e,["component","nivel"]),s=Object(a.useState)(null),d=Object(I.a)(s,2),u=d[0],b=d[1];return Object(a.useEffect)((function(){b(new ie(Y.a.get(D.TOKEN_STORAGE_KEY)).decodedToken)}),[i]),i.includes(0)||u&&i.includes(u.cargo)?Object(r.jsx)(l.a,Object(c.a)(Object(c.a)({},o),{},{render:function(e){return Object(r.jsx)(t,Object(c.a)({},e))}})):Object(r.jsx)(l.a,Object(c.a)(Object(c.a)({},o),{},{render:function(){return Object(r.jsx)(Qo,{})}}))};function ec(){var e=Object(a.useState)(!1),t=Object(I.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)([]),c=Object(I.a)(o,2),s=c[0],l=c[1],d=Object(a.useState)(!1),u=Object(I.a)(d,2),b=u[0],f=u[1],j=Object(a.useState)(""),h=Object(I.a)(j,2),p=h[0],O=h[1];function g(){return(g=Object(P.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s&&s.length>0&&(i(!0),s.forEach(function(){var e=Object(P.a)(B.a.mark((function e(t,n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n<8)){e.next=11;break}return e.t0=Z.a,e.t1="".concat(D.urlApi,"/indicadores"),e.t2="imagen".concat(n+1),e.next=6,Di(t);case 6:return e.t3=e.sent,e.t4={titulo:e.t2,imagen:e.t3},e.t5={data:e.t4},e.next=11,e.t0.post.call(e.t0,e.t1,e.t5).then((function(e){var t=e.data;t&&t.status?F.a[t.status](t.message,{position:"top-right"}):F.a.error("Sin respuesta del servidor.",{position:"top-right"})})).catch((function(e){return console.log(e)})).finally((function(){return i(!1)}));case 11:case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=function(){var e=Object(P.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Di(t.originFileObj);case 3:n=e.sent,f(!0),O(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[Object(r.jsx)(et,{titulo:"Subir imagenes",subtitulo:"Indicadores NPS"}),Object(r.jsxs)(q,{children:[Object(r.jsxs)(Ti.a,{accept:".jpg,.png,.jpeg",listType:"picture-card",beforeUpload:function(e){var t=s;return e.status="done",t.push(e),l(t),!1},onRemove:function(e){var t=s.filter((function(t){return t.uid!==e.uid}));l(t)},onPreview:x,maxCount:8,children:[Object(r.jsx)(Ei.a,{})," ","Subir Imagenes"]}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)(U.a,{onClick:function(){return g.apply(this,arguments)},disabled:n,icon:n?Object(r.jsx)(Yr.a,{}):Object(r.jsx)(ja.a,{}),type:"primary",size:"small",children:"Guardar"}),Object(r.jsx)(kn.a,{visible:b,footer:null,onCancel:function(){return f(!b)},children:Object(r.jsx)("img",{alt:"example",style:{width:"100%"},src:p})})]})]})}function tc(){return Object(r.jsx)(d.b,{locale:u.a,children:Object(r.jsx)(s.a,{children:Object(r.jsxs)(l.c,{children:[Object(r.jsx)(l.a,{exact:!0,path:"/",component:L}),Object(r.jsx)(l.a,{exact:!0,path:"/indicadores",component:ec}),Object(r.jsx)(l.a,{exact:!0,path:f,component:oe}),Object(r.jsx)(Ve,{children:Wo.map((function(e,t){return Object(r.jsx)($o,{path:e.path,exact:e.exact,nivel:e.nivel,component:function(t){return Object(r.jsx)(e.component,Object(c.a)({},t))}},t)}))})]})})})}var nc=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function rc(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),e.update(),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(Object(r.jsx)(tc,{}),document.getElementById("root")),function(e){if(console.log(!0),console.log("serviceWorker"in navigator),console.log(nc),"serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");nc?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):rc(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):rc(t,e)}))}}()}},[[616,1,2]]]);
//# sourceMappingURL=main.799b23a0.chunk.js.map